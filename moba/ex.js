function LIST_TO_JSTR(list) {
  try {
    let result = '';
    let current = list;
    while (current.$ === 'Cons') {
      result += String.fromCodePoint(Number(current.head));
      current = current.tail;
    }
    if (current.$ === 'Nil') {
      return result;
    }
  } catch (e) {}
  return list;
}

function JSTR_TO_LIST(str) {
  let list = {$: 'Nil'};
  for (let i = str.length - 1; i >= 0; i--) {
    list = {$: 'Cons', head: BigInt(str.charCodeAt(i)), tail: list};
  }
  return list;
}

let MEMORY = new Map();
function SWAP(key, val) {
  var old = MEMORY.get(key) || 0n;
  MEMORY.set(key, val);
  return old;
}


function $BinTree$(_$0/*:Type*/) {var $x0 = /*{$:'Node', val: _$0, lft: BinTree<_$0>, rgt: BinTree<_$0>} | {$:'Leaf'}*/null;return $x0; }
const $BinTree = _$0 => $BinTree$(_$0)

function $Maybe$(_$0/*:Type*/) {var $x0 = /*{$:'None'} | {$:'Some', value: _$0}*/null;return $x0; }
const $Maybe = _$0 => $Maybe$(_$0)

function $BinMap$(_$0/*:Type*/) {var $x2 = _$0;var $x1 = $Maybe$($x2);var $x0 = $BinTree$($x1);return $x0; }
const $BinMap = _$0 => $BinMap$(_$0)

function $BinMap$empty$(_$0/*:Type*/) {var $x0 = ({$: "Leaf"});return $x0; }
const $BinMap$empty = _$0 => $BinMap$empty$(_$0)

const $Bits$ = (() => {var $x0 = /*{$:'O', tail: Bits} | {$:'I', tail: Bits} | {$:'E'}*/null;return $x0; })()
const $Bits = $Bits$

function $BinMap$get$(_$0/*:Type*/,_$1/*:BinMap<null>*/,_$2/*:Bits*/) {while(1){var $x1 = _$1;switch ($x1.$) { case "Leaf": { var $x0 = ({$: "None"}); break; } case "Node": { var $x2 = _$2;switch ($x2.$) { case "E": { var $x0 = $x1.val; break; } case "I": { var $x3 = _$0;var $x4 = $x1.rgt;var $x5 = $x2.tail;_$0 = $x3;_$1 = $x4;_$2 = $x5;/*TCO*/continue; break; } case "O": { var $x6 = _$0;var $x7 = $x1.lft;var $x8 = $x2.tail;_$0 = $x6;_$1 = $x7;_$2 = $x8;/*TCO*/continue; break; } } break; } }return $x0; }}
const $BinMap$get = _$0 => _$1 => _$2 => $BinMap$get$(_$0,_$1,_$2)

function $BinMap$new$(_$0/*:Type*/) {var $x1 = _$0;var $x0 = $BinMap$empty$($x1);return $x0; }
const $BinMap$new = _$0 => $BinMap$new$(_$0)

function $BinMap$set$(_$0/*:Type*/,_$1/*:BinMap<null>*/,_$2/*:Bits*/,_$3/*:null*/) {var $x1 = _$1;switch ($x1.$) { case "Leaf": { var $x2 = _$2;switch ($x2.$) { case "E": { var $x0 = ({$: "Node"});var $x3 = ({$: "Some"});var $x4 = _$3;$x3.value = $x4;$x0.val = $x3;var $x5 = ({$: "Leaf"});$x0.lft = $x5;var $x6 = ({$: "Leaf"});$x0.rgt = $x6; break; } case "I": { var $x0 = ({$: "Node"});var $x7 = ({$: "None"});$x0.val = $x7;var $x8 = ({$: "Leaf"});$x0.lft = $x8;var $x10 = _$0;var $x11 = ({$: "Leaf"});var $x12 = $x2.tail;var $x13 = _$3;var $x9 = $BinMap$set$($x10, $x11, $x12, $x13);$x0.rgt = $x9; break; } case "O": { var $x0 = ({$: "Node"});var $x14 = ({$: "None"});$x0.val = $x14;var $x16 = _$0;var $x17 = ({$: "Leaf"});var $x18 = $x2.tail;var $x19 = _$3;var $x15 = $BinMap$set$($x16, $x17, $x18, $x19);$x0.lft = $x15;var $x20 = ({$: "Leaf"});$x0.rgt = $x20; break; } } break; } case "Node": { var $x21 = _$2;switch ($x21.$) { case "E": { var $x0 = ({$: "Node"});var $x22 = ({$: "Some"});var $x23 = _$3;$x22.value = $x23;$x0.val = $x22;var $x24 = $x1.lft;$x0.lft = $x24;var $x25 = $x1.rgt;$x0.rgt = $x25; break; } case "I": { var $x0 = ({$: "Node"});var $x26 = $x1.val;$x0.val = $x26;var $x27 = $x1.lft;$x0.lft = $x27;var $x29 = _$0;var $x30 = $x1.rgt;var $x31 = $x21.tail;var $x32 = _$3;var $x28 = $BinMap$set$($x29, $x30, $x31, $x32);$x0.rgt = $x28; break; } case "O": { var $x0 = ({$: "Node"});var $x33 = $x1.val;$x0.val = $x33;var $x35 = _$0;var $x36 = $x1.lft;var $x37 = $x21.tail;var $x38 = _$3;var $x34 = $BinMap$set$($x35, $x36, $x37, $x38);$x0.lft = $x34;var $x39 = $x1.rgt;$x0.rgt = $x39; break; } } break; } }return $x0; }
const $BinMap$set = _$0 => _$1 => _$2 => _$3 => $BinMap$set$(_$0,_$1,_$2,_$3)

const $Bool$ = (() => {var $x0 = /*{$:'True'} | {$:'False'}*/null;return $x0; })()
const $Bool = $Bool$

function $Bool$and$(_$0/*:Bool*/,_$1/*:Bool*/) {var $x1 = _$0;switch ($x1.$) { case "False": { var $x0 = ({$: "False"}); break; } case "True": { var $x0 = _$1; break; } }return $x0; }
const $Bool$and = _$0 => _$1 => $Bool$and$(_$0,_$1)

function $Bool$eq$(_$0/*:Bool*/) {var $x1 = _$0;switch ($x1.$) { case "False": { var $x0 = ($__0$0 => {var $x3 = $__0$0;switch ($x3.$) { case "False": { var $x2 = ({$: "True"}); break; } default: { var $x2 = ({$: "False"}); break; } }return $x2;}); break; } case "True": { var $x0 = ($__0$0 => {var $x5 = $__0$0;switch ($x5.$) { case "True": { var $x4 = ({$: "True"}); break; } default: { var $x4 = ({$: "False"}); break; } }return $x4;}); break; } default: { var $x6 = /*Type*/null;var $x7 = $x1;var $x0 = ($x6)($x7); break; } }return $x0; }
const $Bool$eq = _$0 => $Bool$eq$(_$0)

function $Bool$if$(_$0/*:Type*/,_$1/*:Bool*/,_$2/*:null*/,_$3/*:null*/) {var $x1 = _$1;switch ($x1.$) { case "False": { var $x0 = _$3; break; } case "True": { var $x0 = _$2; break; } }return $x0; }
const $Bool$if = _$0 => _$1 => _$2 => _$3 => $Bool$if$(_$0,_$1,_$2,_$3)

function $Bool$not$(_$0/*:Bool*/) {var $x1 = _$0;switch ($x1.$) { case "False": { var $x0 = ({$: "True"}); break; } case "True": { var $x0 = ({$: "False"}); break; } }return $x0; }
const $Bool$not = _$0 => $Bool$not$(_$0)

function $Bool$or$(_$0/*:Bool*/,_$1/*:Bool*/) {var $x1 = _$0;switch ($x1.$) { case "False": { var $x0 = _$1; break; } case "True": { var $x0 = ({$: "True"}); break; } }return $x0; }
const $Bool$or = _$0 => _$1 => $Bool$or$(_$0,_$1)

const $Char$ = (() => {var $x0 = /*BigInt*/null;return $x0; })()
const $Char = $Char$

function $U64$to_bool$(_$0/*:BigInt*/) {var $x1 = _$0;if ($x1 === 0n) { var $x0 = ({$: "False"}); } else { var $x0 = ({$: "True"}); }return $x0; }
const $U64$to_bool = _$0 => $U64$to_bool$(_$0)

function $U64$eql$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = BigInt.asUintN(64, $x1 === $x2);return $x0; }
const $U64$eql = _$0 => _$1 => $U64$eql$(_$0,_$1)

const $Cmp$ = (() => {var $x0 = /*{$:'LT'} | {$:'EQ'} | {$:'GT'}*/null;return $x0; })()
const $Cmp = $Cmp$

function $U64$compare$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x3 = _$0;var $x4 = _$1;var $x2 = $U64$eql$($x3, $x4);var $x1 = $U64$to_bool$($x2);switch ($x1.$) { case "True": { var $x0 = ({$: "EQ"}); break; } case "False": { var $x7 = _$0;var $x8 = _$1;var $x6 = BigInt.asUintN(64, $x7 < $x8);var $x5 = $U64$to_bool$($x6);switch ($x5.$) { case "True": { var $x0 = ({$: "LT"}); break; } case "False": { var $x0 = ({$: "GT"}); break; } } break; } }return $x0; }
const $U64$compare = _$0 => _$1 => $U64$compare$(_$0,_$1)

function $Char$compare$(_$0/*:Char*/,_$1/*:Char*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = $U64$compare$($x1, $x2);return $x0; }
const $Char$compare = _$0 => _$1 => $Char$compare$(_$0,_$1)

function $Ord$(_$0/*:Type*/) {var $x0 = /*{$:'Ord', compare: ($x$0:_$0) => ($y$1:_$0) => Cmp}*/null;return $x0; }
const $Ord = _$0 => $Ord$(_$0)

const $Char$Ord$ = (() => {var $x0 = ({$: "Ord"});var $x1 = $Char$compare;$x0.compare = $x1;return $x0; })()
const $Char$Ord = $Char$Ord$

function $Char$eq$(_$0/*:Char*/,_$1/*:Char*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = $U64$eql$($x2, $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $Char$eq = _$0 => _$1 => $Char$eq$(_$0,_$1)

function $Equal$(_$0/*:Type*/,_$1/*:null*/,_$2/*:null*/) {var $x0 = /*{$:'Refl'}*/null;return $x0; }
const $Equal = _$0 => _$1 => _$2 => $Equal$(_$0,_$1,_$2)

function $F64$negate$(_$0/*:Number*/) {var $x1 = 0.0;var $x2 = _$0;var $x0 = $x1 - $x2;return $x0; }
const $F64$negate = _$0 => $F64$negate$(_$0)

function $F64$lt$(_$0/*:Number*/,_$1/*:Number*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 < $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $F64$lt = _$0 => _$1 => $F64$lt$(_$0,_$1)

function $F64$abs$(_$0/*:Number*/) {var $x2 = _$0;var $x3 = 0.0;var $x1 = $F64$lt$($x2, $x3);switch ($x1.$) { case "True": { var $x4 = _$0;var $x0 = $F64$negate$($x4); break; } case "False": { var $x0 = _$0; break; } }return $x0; }
const $F64$abs = _$0 => $F64$abs$(_$0)

function $F64$add$(_$0/*:Number*/,_$1/*:Number*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = $x1 + $x2;return $x0; }
const $F64$add = _$0 => _$1 => $F64$add$(_$0,_$1)

function $F64$div$(_$0/*:Number*/,_$1/*:Number*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = $x1 / $x2;return $x0; }
const $F64$div = _$0 => _$1 => $F64$div$(_$0,_$1)

function $F64$eql$(_$0/*:Number*/,_$1/*:Number*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = BigInt.asUintN(64, $x1 === $x2);return $x0; }
const $F64$eql = _$0 => _$1 => $F64$eql$(_$0,_$1)

function $F64$eq$(_$0/*:Number*/,_$1/*:Number*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = $F64$eql$($x2, $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $F64$eq = _$0 => _$1 => $F64$eq$(_$0,_$1)

function $F64$gt$(_$0/*:Number*/,_$1/*:Number*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 > $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $F64$gt = _$0 => _$1 => $F64$gt$(_$0,_$1)

function $F64$gte$(_$0/*:Number*/,_$1/*:Number*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 >= $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $F64$gte = _$0 => _$1 => $F64$gte$(_$0,_$1)

function $F64$is_zero$(_$0/*:Number*/) {var $x2 = _$0;var $x3 = 0.0;var $x1 = BigInt.asUintN(64, $x2 === $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $F64$is_zero = _$0 => $F64$is_zero$(_$0)

function $F64$lte$(_$0/*:Number*/,_$1/*:Number*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 <= $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $F64$lte = _$0 => _$1 => $F64$lte$(_$0,_$1)

function $F64$min$(_$0/*:Number*/,_$1/*:Number*/) {var $x3 = _$0;var $x4 = _$1;var $x2 = BigInt.asUintN(64, $x3 <= $x4);var $x1 = $U64$to_bool$($x2);switch ($x1.$) { case "True": { var $x0 = _$0; break; } case "False": { var $x0 = _$1; break; } }return $x0; }
const $F64$min = _$0 => _$1 => $F64$min$(_$0,_$1)

function $F64$mul$(_$0/*:Number*/,_$1/*:Number*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = $x1 * $x2;return $x0; }
const $F64$mul = _$0 => _$1 => $F64$mul$(_$0,_$1)

function $F64$sign$(_$0/*:Number*/) {var $x2 = _$0;var $x3 = 0.0;var $x1 = $F64$gt$($x2, $x3);switch ($x1.$) { case "True": { var $x0 = 1.0; break; } case "False": { var $x5 = _$0;var $x6 = 0.0;var $x4 = $F64$lt$($x5, $x6);switch ($x4.$) { case "True": { var $x0 = -1.0; break; } case "False": { var $x0 = 0.0; break; } } break; } }return $x0; }
const $F64$sign = _$0 => $F64$sign$(_$0)

function $F64$sqrt_go$(_$0/*:Number*/,_$1/*:Number*/,_$2/*:BigInt*/) {while(1){var $x1 = _$2;if ($x1 === 0n) { var $x0 = _$1; } else { var $x3 = _$1;var $x5 = _$0;var $x6 = _$1;var $x4 = $F64$div$($x5, $x6);var $x2 = $F64$add$($x3, $x4);var $x7 = 2.0;var $next$0 = $F64$div$($x2, $x7);var $x9 = _$1;var $x10 = $next$0;var $x8 = $F64$eq$($x9, $x10);switch ($x8.$) { case "True": { var $x0 = $next$0; break; } case "False": { var $x11 = _$0;var $x12 = $next$0;var $x14 = $x1;var $x15 = 1n;var $x13 = BigInt.asUintN(64, $x14 - $x15);_$0 = $x11;_$1 = $x12;_$2 = $x13;/*TCO*/continue; break; } } }return $x0; }}
const $F64$sqrt_go = _$0 => _$1 => _$2 => $F64$sqrt_go$(_$0,_$1,_$2)

function $F64$sqrt$(_$0/*:Number*/) {var $x2 = _$0;var $x1 = $F64$is_zero$($x2);switch ($x1.$) { case "True": { var $x0 = _$0; break; } case "False": { var $x3 = _$0;var $x5 = _$0;var $x6 = 2.0;var $x4 = $F64$div$($x5, $x6);var $x7 = 10n;var $x0 = $F64$sqrt_go$($x3, $x4, $x7); break; } }return $x0; }
const $F64$sqrt = _$0 => $F64$sqrt$(_$0)

function $F64$sub$(_$0/*:Number*/,_$1/*:Number*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = $x1 - $x2;return $x0; }
const $F64$sub = _$0 => _$1 => $F64$sub$(_$0,_$1)

const $KEYEVENT$ = (() => {var $x0 = 0n;return $x0; })()
const $KEYEVENT = $KEYEVENT$

const $KEYMOUSE$ = (() => {var $x0 = 2n;return $x0; })()
const $KEYMOUSE = $KEYMOUSE$

function $List$(_$0/*:Type*/) {var $x0 = /*{$:'Nil'} | {$:'Cons', head: _$0, tail: List<_$0>}*/null;return $x0; }
const $List = _$0 => $List$(_$0)

function $List$append$(_$0/*:Type*/,_$1/*:List<null>*/,_$2/*:List<null>*/) {var $x1 = _$1;switch ($x1.$) { case "Cons": { var $x0 = ({$: "Cons"});var $x2 = $x1.head;$x0.head = $x2;var $x4 = _$0;var $x5 = $x1.tail;var $x6 = _$2;var $x3 = $List$append$($x4, $x5, $x6);$x0.tail = $x3; break; } case "Nil": { var $x0 = _$2; break; } }return $x0; }
const $List$append = _$0 => _$1 => _$2 => $List$append$(_$0,_$1,_$2)

function $List$foldr$(_$0/*:Type*/,_$1/*:List<null>*/,_$2/*:Type*/,_$3/*:null*/,_$4/*:($_$4:null) => ($_$5:null) => null*/) {var $x1 = _$1;switch ($x1.$) { case "Cons": { var $x3 = _$4;var $x4 = $x1.head;var $x2 = ($x3)($x4);var $x6 = _$0;var $x7 = $x1.tail;var $x8 = _$2;var $x9 = _$3;var $x10 = _$4;var $x5 = $List$foldr$($x6, $x7, $x8, $x9, $x10);var $x0 = ($x2)($x5); break; } case "Nil": { var $x0 = _$3; break; } }return $x0; }
const $List$foldr = _$0 => _$1 => _$2 => _$3 => _$4 => $List$foldr$(_$0,_$1,_$2,_$3,_$4)

function $List$fold$(_$0/*:Type*/,_$1/*:List<null>*/,_$2/*:Type*/,_$3/*:null*/,_$4/*:($_$4:null) => ($_$5:null) => null*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x4 = _$3;var $x5 = _$4;var $x0 = $List$foldr$($x1, $x2, $x3, $x4, $x5);return $x0; }
const $List$fold = _$0 => _$1 => _$2 => _$3 => _$4 => $List$fold$(_$0,_$1,_$2,_$3,_$4)

function $List$foldl$(_$0/*:Type*/,_$1/*:List<null>*/,_$2/*:Type*/,_$3/*:null*/,_$4/*:($_$4:null) => ($_$5:null) => null*/) {while(1){var $x1 = _$1;switch ($x1.$) { case "Cons": { var $x2 = _$0;var $x3 = $x1.tail;var $x4 = _$2;var $x7 = _$4;var $x8 = _$3;var $x6 = ($x7)($x8);var $x9 = $x1.head;var $x5 = ($x6)($x9);var $x10 = _$4;_$0 = $x2;_$1 = $x3;_$2 = $x4;_$3 = $x5;_$4 = $x10;/*TCO*/continue; break; } case "Nil": { var $x0 = _$3; break; } }return $x0; }}
const $List$foldl = _$0 => _$1 => _$2 => _$3 => _$4 => $List$foldl$(_$0,_$1,_$2,_$3,_$4)

function $List$head$(_$0/*:Type*/,_$1/*:List<null>*/) {var $x1 = _$1;switch ($x1.$) { case "Cons": { var $x0 = ({$: "Some"});var $x2 = $x1.head;$x0.value = $x2; break; } case "Nil": { var $x0 = ({$: "None"}); break; } }return $x0; }
const $List$head = _$0 => _$1 => $List$head$(_$0,_$1)

function $List$insert_at_sorted$(_$0/*:Type*/,_$1/*:List<null>*/,_$2/*:null*/,_$3/*:($_$3:null) => ($_$4:null) => Bool*/) {var $x1 = _$1;switch ($x1.$) { case "Cons": { var $x4 = _$3;var $x5 = _$2;var $x3 = ($x4)($x5);var $x6 = $x1.head;var $x2 = ($x3)($x6);switch ($x2.$) { case "False": { var $x0 = ({$: "Cons"});var $x7 = $x1.head;$x0.head = $x7;var $x9 = _$0;var $x10 = $x1.tail;var $x11 = _$2;var $x12 = _$3;var $x8 = $List$insert_at_sorted$($x9, $x10, $x11, $x12);$x0.tail = $x8; break; } case "True": { var $x0 = ({$: "Cons"});var $x13 = _$2;$x0.head = $x13;var $x14 = ({$: "Cons"});var $x15 = $x1.head;$x14.head = $x15;var $x16 = $x1.tail;$x14.tail = $x16;$x0.tail = $x14; break; } } break; } case "Nil": { var $x0 = ({$: "Cons"});var $x17 = _$2;$x0.head = $x17;var $x18 = ({$: "Nil"});$x0.tail = $x18; break; } }return $x0; }
const $List$insert_at_sorted = _$0 => _$1 => _$2 => _$3 => $List$insert_at_sorted$(_$0,_$1,_$2,_$3)

function $List$insertion_sort$(_$0/*:Type*/,_$1/*:List<null>*/,_$2/*:($_$2:null) => ($_$3:null) => Bool*/) {var $x1 = _$1;switch ($x1.$) { case "Cons": { var $x2 = _$0;var $x3 = $x1.tail;var $x4 = _$2;var $sorted_tail$0 = $List$insertion_sort$($x2, $x3, $x4);var $x5 = _$0;var $x6 = $sorted_tail$0;var $x7 = $x1.head;var $x8 = _$2;var $x0 = $List$insert_at_sorted$($x5, $x6, $x7, $x8); break; } case "Nil": { var $x0 = ({$: "Nil"}); break; } }return $x0; }
const $List$insertion_sort = _$0 => _$1 => _$2 => $List$insertion_sort$(_$0,_$1,_$2)

function $List$map$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:List<null>*/,_$3/*:($_$3:null) => null*/) {var $x1 = _$2;switch ($x1.$) { case "Cons": { var $x0 = ({$: "Cons"});var $x3 = _$3;var $x4 = $x1.head;var $x2 = ($x3)($x4);$x0.head = $x2;var $x6 = _$0;var $x7 = _$1;var $x8 = $x1.tail;var $x9 = _$3;var $x5 = $List$map$($x6, $x7, $x8, $x9);$x0.tail = $x5; break; } case "Nil": { var $x0 = ({$: "Nil"}); break; } }return $x0; }
const $List$map = _$0 => _$1 => _$2 => _$3 => $List$map$(_$0,_$1,_$2,_$3)

function $List$sort$(_$0/*:Type*/,_$1/*:List<null>*/,_$2/*:($_$2:null) => ($_$3:null) => Bool*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x0 = $List$insertion_sort$($x1, $x2, $x3);return $x0; }
const $List$sort = _$0 => _$1 => _$2 => $List$sort$(_$0,_$1,_$2)

function $Pair$(_$0/*:Type*/,_$1/*:Type*/) {var $x0 = /*{$:'Pair', fst: _$0, snd: _$1}*/null;return $x0; }
const $Pair = _$0 => _$1 => $Pair$(_$0,_$1)

function $List$zip$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:List<null>*/,_$3/*:List<null>*/) {var $x1 = _$2;switch ($x1.$) { case "Cons": { var $x2 = _$3;switch ($x2.$) { case "Cons": { var $x0 = ({$: "Cons"});var $x3 = ({$: "Pair"});var $x4 = $x1.head;$x3.fst = $x4;var $x5 = $x2.head;$x3.snd = $x5;$x0.head = $x3;var $x7 = _$0;var $x8 = _$1;var $x9 = $x1.tail;var $x10 = $x2.tail;var $x6 = $List$zip$($x7, $x8, $x9, $x10);$x0.tail = $x6; break; } case "Nil": { var $x0 = ({$: "Nil"}); break; } } break; } case "Nil": { var $x0 = ({$: "Nil"}); break; } }return $x0; }
const $List$zip = _$0 => _$1 => _$2 => _$3 => $List$zip$(_$0,_$1,_$2,_$3)

const $MOUSECLICK$ = (() => {var $x0 = 1n;return $x0; })()
const $MOUSECLICK = $MOUSECLICK$

const $MOUSEMOVE$ = (() => {var $x0 = 3n;return $x0; })()
const $MOUSEMOVE = $MOUSEMOVE$

function $Map$delete$(_$0/*:Type*/,_$1/*:Map<BigInt, Maybe<null>>*/,_$2/*:BigInt*/) {var $x1 = _$1;var $x2 = _$2;var $x3 = ({$: "None"});var $x5 = $x1.has($x2) ? $x1.get($x2) : $x1.get(-1n);var $x4 = $x1; $x1.set($x2, $x3);var $x0 = $x4;return $x0; }
const $Map$delete = _$0 => _$1 => _$2 => $Map$delete$(_$0,_$1,_$2)

function $Map$empty$(_$0/*:Type*/) {var $x0 = new Map();var $x1 = ({$: "None"});$x0.set(-1n, $x1);return $x0; }
const $Map$empty = _$0 => $Map$empty$(_$0)

function $U64$eq$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = $U64$eql$($x2, $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $U64$eq = _$0 => _$1 => $U64$eq$(_$0,_$1)

function $Map$fold$go$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:Map<BigInt, Maybe<null>>*/,_$3/*:BigInt*/,_$4/*:null*/,_$5/*:($_$5:null) => ($_$6:BigInt) => ($_$7:null) => null*/) {while(1){var $x2 = _$3;var $x3 = 0n;var $x1 = $U64$eq$($x2, $x3);switch ($x1.$) { case "False": { var $x4 = _$2;var $x5 = _$3;var $x7 = $x4.has($x5) ? $x4.get($x5) : $x4.get(-1n);var $x6 = $x4;var $x8 = $x7;switch ($x8.$) { case "None": { var $x9 = _$0;var $x10 = _$1;var $x11 = $x6;var $x13 = _$3;var $x14 = 1n;var $x12 = BigInt.asUintN(64, $x13 - $x14);var $x15 = _$4;var $x16 = _$5;_$0 = $x9;_$1 = $x10;_$2 = $x11;_$3 = $x12;_$4 = $x15;_$5 = $x16;/*TCO*/continue; break; } case "Some": { var $x17 = _$0;var $x18 = _$1;var $x19 = $x6;var $x21 = _$3;var $x22 = 1n;var $x20 = BigInt.asUintN(64, $x21 - $x22);var $x26 = _$5;var $x27 = _$4;var $x25 = ($x26)($x27);var $x28 = _$3;var $x24 = ($x25)($x28);var $x29 = $x8.value;var $x23 = ($x24)($x29);var $x30 = _$5;_$0 = $x17;_$1 = $x18;_$2 = $x19;_$3 = $x20;_$4 = $x23;_$5 = $x30;/*TCO*/continue; break; } } break; } case "True": { var $x31 = _$2;var $x32 = 0n;var $x34 = $x31.has($x32) ? $x31.get($x32) : $x31.get(-1n);var $x33 = $x31;var $x35 = $x34;switch ($x35.$) { case "None": { var $x0 = _$4; break; } case "Some": { var $x38 = _$5;var $x39 = _$4;var $x37 = ($x38)($x39);var $x40 = 0n;var $x36 = ($x37)($x40);var $x41 = $x35.value;var $x0 = ($x36)($x41); break; } } break; } }return $x0; }}
const $Map$fold$go = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $Map$fold$go$(_$0,_$1,_$2,_$3,_$4,_$5)

function $Map$fold$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:Map<BigInt, Maybe<null>>*/,_$3/*:BigInt*/,_$4/*:null*/,_$5/*:($_$5:null) => ($_$6:BigInt) => ($_$7:null) => null*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x4 = _$3;var $x5 = _$4;var $x6 = _$5;var $x0 = $Map$fold$go$($x1, $x2, $x3, $x4, $x5, $x6);return $x0; }
const $Map$fold = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $Map$fold$(_$0,_$1,_$2,_$3,_$4,_$5)

const $Map$fold$test_map$ = (() => {var $x0 = new Map();var $x2 = ({$: "None"});$x0.set(1n, $x2); var $x3 = ({$: "Some"});var $x4 = 10n;$x3.value = $x4;$x0.set(2n, $x3); var $x5 = ({$: "Some"});var $x6 = 20n;$x5.value = $x6;$x0.set(5n, $x5);var $x1 = ({$: "None"});$x0.set(-1n, $x1);return $x0; })()
const $Map$fold$test_map = $Map$fold$test_map$

function $Map$get$(_$0/*:Type*/,_$1/*:Map<BigInt, Maybe<null>>*/,_$2/*:BigInt*/) {var $x1 = _$1;var $x2 = _$2;var $x4 = $x1.has($x2) ? $x1.get($x2) : $x1.get(-1n);var $x3 = $x1;var $x0 = $x4;return $x0; }
const $Map$get = _$0 => _$1 => _$2 => $Map$get$(_$0,_$1,_$2)

const $Map$get$test_map$ = (() => {var $x0 = new Map();var $x2 = ({$: "Some"});var $x3 = 42n;$x2.value = $x3;$x0.set(0n, $x2); var $x4 = ({$: "None"});$x0.set(1n, $x4); var $x5 = ({$: "Some"});var $x6 = 10n;$x5.value = $x6;$x0.set(2n, $x5); var $x7 = ({$: "Some"});var $x8 = 20n;$x7.value = $x8;$x0.set(5n, $x7);var $x1 = ({$: "None"});$x0.set(-1n, $x1);return $x0; })()
const $Map$get$test_map = $Map$get$test_map$

function $Map$insert$(_$0/*:Type*/,_$1/*:Map<BigInt, Maybe<null>>*/,_$2/*:BigInt*/,_$3/*:null*/) {var $x1 = _$1;var $x2 = _$2;var $x3 = ({$: "Some"});var $x4 = _$3;$x3.value = $x4;var $x6 = $x1.has($x2) ? $x1.get($x2) : $x1.get(-1n);var $x5 = $x1; $x1.set($x2, $x3);var $x0 = $x5;return $x0; }
const $Map$insert = _$0 => _$1 => _$2 => _$3 => $Map$insert$(_$0,_$1,_$2,_$3)

const $Map$insert$test_map$ = (() => {var $x0 = new Map();var $x2 = ({$: "Some"});var $x3 = 42n;$x2.value = $x3;$x0.set(0n, $x2); var $x4 = ({$: "None"});$x0.set(1n, $x4); var $x5 = ({$: "Some"});var $x6 = 10n;$x5.value = $x6;$x0.set(2n, $x5);var $x1 = ({$: "None"});$x0.set(-1n, $x1);return $x0; })()
const $Map$insert$test_map = $Map$insert$test_map$

function $Map$update$(_$0/*:Type*/,_$1/*:Map<BigInt, Maybe<null>>*/,_$2/*:BigInt*/,_$3/*:null*/) {var $x2 = _$0;var $x3 = _$1;var $x4 = _$2;var $x1 = $Map$get$($x2, $x3, $x4);switch ($x1.$) { case "None": { var $x0 = _$1; break; } case "Some": { var $x5 = _$1;var $x6 = _$2;var $x7 = ({$: "Some"});var $x8 = _$3;$x7.value = $x8;var $x10 = $x5.has($x6) ? $x5.get($x6) : $x5.get(-1n);var $x9 = $x5; $x5.set($x6, $x7);var $x0 = $x9; break; } }return $x0; }
const $Map$update = _$0 => _$1 => _$2 => _$3 => $Map$update$(_$0,_$1,_$2,_$3)

function $Map$values$go$(_$0/*:Type*/,_$1/*:Map<BigInt, Maybe<null>>*/,_$2/*:BigInt*/,_$3/*:List<null>*/) {while(1){var $x2 = _$2;var $x3 = 0n;var $x1 = $U64$eq$($x2, $x3);switch ($x1.$) { case "False": { var $x4 = _$1;var $x5 = _$2;var $x7 = $x4.has($x5) ? $x4.get($x5) : $x4.get(-1n);var $x6 = $x4;var $x8 = $x7;switch ($x8.$) { case "None": { var $x9 = _$0;var $x10 = $x6;var $x12 = _$2;var $x13 = 1n;var $x11 = BigInt.asUintN(64, $x12 - $x13);var $x14 = _$3;_$0 = $x9;_$1 = $x10;_$2 = $x11;_$3 = $x14;/*TCO*/continue; break; } case "Some": { var $x15 = _$0;var $x16 = $x6;var $x18 = _$2;var $x19 = 1n;var $x17 = BigInt.asUintN(64, $x18 - $x19);var $x20 = ({$: "Cons"});var $x21 = $x8.value;$x20.head = $x21;var $x22 = _$3;$x20.tail = $x22;_$0 = $x15;_$1 = $x16;_$2 = $x17;_$3 = $x20;/*TCO*/continue; break; } } break; } case "True": { var $x23 = _$1;var $x24 = 0n;var $x26 = $x23.has($x24) ? $x23.get($x24) : $x23.get(-1n);var $x25 = $x23;var $x27 = $x26;switch ($x27.$) { case "None": { var $x0 = _$3; break; } case "Some": { var $x0 = ({$: "Cons"});var $x28 = $x27.value;$x0.head = $x28;var $x29 = _$3;$x0.tail = $x29; break; } } break; } }return $x0; }}
const $Map$values$go = _$0 => _$1 => _$2 => _$3 => $Map$values$go$(_$0,_$1,_$2,_$3)

function $Map$values$(_$0/*:Type*/,_$1/*:Map<BigInt, Maybe<null>>*/,_$2/*:BigInt*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x4 = ({$: "Nil"});var $x0 = $Map$values$go$($x1, $x2, $x3, $x4);return $x0; }
const $Map$values = _$0 => _$1 => _$2 => $Map$values$(_$0,_$1,_$2)

const $Map$values$test_map$ = (() => {var $x0 = new Map();var $x2 = ({$: "None"});$x0.set(1n, $x2); var $x3 = ({$: "Some"});var $x4 = 10n;$x3.value = $x4;$x0.set(2n, $x3); var $x5 = ({$: "Some"});var $x6 = 20n;$x5.value = $x6;$x0.set(5n, $x5);var $x1 = ({$: "None"});$x0.set(-1n, $x1);return $x0; })()
const $Map$values$test_map = $Map$values$test_map$

function $Maybe$none$(_$0/*:Type*/) {var $x0 = ({$: "None"});return $x0; }
const $Maybe$none = _$0 => $Maybe$none$(_$0)

const $Nat$ = (() => {var $x0 = /*{$:'Zero'} | {$:'Succ', pred: Nat}*/null;return $x0; })()
const $Nat = $Nat$

function $Nat$add$(_$0/*:Nat*/,_$1/*:Nat*/) {var $x1 = _$0;switch ($x1.$) { case "Succ": { var $x0 = ({$: "Succ"});var $x3 = $x1.pred;var $x4 = _$1;var $x2 = $Nat$add$($x3, $x4);$x0.pred = $x2; break; } case "Zero": { var $x0 = _$1; break; } }return $x0; }
const $Nat$add = _$0 => _$1 => $Nat$add$(_$0,_$1)

function $Nat$eq$(_$0/*:Nat*/) {var $x1 = _$0;switch ($x1.$) { case "Succ": { var $x0 = ($__1$0 => {var $x3 = $__1$0;switch ($x3.$) { case "Succ": { var $x5 = $x1.pred;var $x4 = $Nat$eq$($x5);var $x6 = $x3.pred;var $x2 = ($x4)($x6); break; } default: { var $x2 = ({$: "False"}); break; } }return $x2;}); break; } case "Zero": { var $x0 = ($__0$0 => {var $x8 = $__0$0;switch ($x8.$) { case "Zero": { var $x7 = ({$: "True"}); break; } default: { var $x7 = ({$: "False"}); break; } }return $x7;}); break; } default: { var $x9 = /*Type*/null;var $x10 = $x1;var $x0 = ($x9)($x10); break; } }return $x0; }
const $Nat$eq = _$0 => $Nat$eq$(_$0)

function $Nat$lte$(_$0/*:Nat*/,_$1/*:Nat*/) {while(1){var $x1 = _$0;switch ($x1.$) { case "Succ": { var $x2 = _$1;switch ($x2.$) { case "Succ": { var $x3 = $x1.pred;var $x4 = $x2.pred;_$0 = $x3;_$1 = $x4;/*TCO*/continue; break; } case "Zero": { var $x0 = ({$: "False"}); break; } } break; } case "Zero": { var $x0 = ({$: "True"}); break; } }return $x0; }}
const $Nat$lte = _$0 => _$1 => $Nat$lte$(_$0,_$1)

function $Nat$gte$(_$0/*:Nat*/,_$1/*:Nat*/) {var $x1 = _$1;var $x2 = _$0;var $x0 = $Nat$lte$($x1, $x2);return $x0; }
const $Nat$gte = _$0 => _$1 => $Nat$gte$(_$0,_$1)

function $Nat$max$(_$0/*:Nat*/,_$1/*:Nat*/) {var $x1 = $Nat;var $x3 = _$0;var $x4 = _$1;var $x2 = $Nat$gte$($x3, $x4);var $x5 = _$0;var $x6 = _$1;var $x0 = $Bool$if$($x1, $x2, $x5, $x6);return $x0; }
const $Nat$max = _$0 => _$1 => $Nat$max$(_$0,_$1)

function $Ord$compare$(_$0/*:Type*/,_$1/*:Ord<null>*/,_$2/*:null*/,_$3/*:null*/) {var $x1 = _$1;var $x3 = $x1.compare;var $x4 = _$2;var $x2 = ($x3)($x4);var $x5 = _$3;var $x0 = ($x2)($x5);return $x0; }
const $Ord$compare = _$0 => _$1 => _$2 => _$3 => $Ord$compare$(_$0,_$1,_$2,_$3)

const $OrdTree$Balance$ = (() => {var $x0 = /*{$:'MinusOne'} | {$:'Zero'} | {$:'PlusOne'}*/null;return $x0; })()
const $OrdTree$Balance = $OrdTree$Balance$

function $OrdTree$(_$0/*:Type*/,_$1/*:Type*/) {var $x0 = /*{$:'Leaf'} | {$:'Node', key_value: Pair<_$0><_$1>, balance: OrdTree/Balance, left: OrdTree<_$0><_$1>, right: OrdTree<_$0><_$1>}*/null;return $x0; }
const $OrdTree = _$0 => _$1 => $OrdTree$(_$0,_$1)

function $OrdTree$Balance$rotate_left$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:OrdTree<null><null>*/) {var $x1 = _$2;switch ($x1.$) { case "Leaf": { var $x0 = ({$: "Pair"});var $x2 = ({$: "Leaf"});$x0.fst = $x2;var $x3 = ({$: "False"});$x0.snd = $x3; break; } case "Node": { var $x4 = $x1.balance;switch ($x4.$) { case "PlusOne": { var $x5 = $x1.right;switch ($x5.$) { case "Node": { var $x6 = $x5.balance;switch ($x6.$) { case "MinusOne": { var $x7 = $x5.left;switch ($x7.$) { case "Node": { var $x8 = $x7.balance;switch ($x8.$) { case "MinusOne": { var $x0 = ({$: "Pair"});var $x9 = ({$: "Node"});var $x10 = $x7.key_value;$x9.key_value = $x10;var $x11 = ({$: "Zero"});$x9.balance = $x11;var $x12 = ({$: "Node"});var $x13 = $x1.key_value;$x12.key_value = $x13;var $x14 = ({$: "Zero"});$x12.balance = $x14;var $x15 = $x1.left;$x12.left = $x15;var $x16 = $x7.left;$x12.right = $x16;$x9.left = $x12;var $x17 = ({$: "Node"});var $x18 = $x5.key_value;$x17.key_value = $x18;var $x19 = ({$: "PlusOne"});$x17.balance = $x19;var $x20 = $x7.right;$x17.left = $x20;var $x21 = $x5.right;$x17.right = $x21;$x9.right = $x17;$x0.fst = $x9;var $x22 = ({$: "False"});$x0.snd = $x22; break; } case "PlusOne": { var $x0 = ({$: "Pair"});var $x23 = ({$: "Node"});var $x24 = $x7.key_value;$x23.key_value = $x24;var $x25 = ({$: "Zero"});$x23.balance = $x25;var $x26 = ({$: "Node"});var $x27 = $x1.key_value;$x26.key_value = $x27;var $x28 = ({$: "MinusOne"});$x26.balance = $x28;var $x29 = $x1.left;$x26.left = $x29;var $x30 = $x7.left;$x26.right = $x30;$x23.left = $x26;var $x31 = ({$: "Node"});var $x32 = $x5.key_value;$x31.key_value = $x32;var $x33 = ({$: "Zero"});$x31.balance = $x33;var $x34 = $x7.right;$x31.left = $x34;var $x35 = $x5.right;$x31.right = $x35;$x23.right = $x31;$x0.fst = $x23;var $x36 = ({$: "False"});$x0.snd = $x36; break; } case "Zero": { var $x0 = ({$: "Pair"});var $x37 = ({$: "Node"});var $x38 = $x7.key_value;$x37.key_value = $x38;var $x39 = ({$: "Zero"});$x37.balance = $x39;var $x40 = ({$: "Node"});var $x41 = $x1.key_value;$x40.key_value = $x41;var $x42 = ({$: "Zero"});$x40.balance = $x42;var $x43 = $x1.left;$x40.left = $x43;var $x44 = $x7.left;$x40.right = $x44;$x37.left = $x40;var $x45 = ({$: "Node"});var $x46 = $x5.key_value;$x45.key_value = $x46;var $x47 = ({$: "Zero"});$x45.balance = $x47;var $x48 = $x7.right;$x45.left = $x48;var $x49 = $x5.right;$x45.right = $x49;$x37.right = $x45;$x0.fst = $x37;var $x50 = ({$: "False"});$x0.snd = $x50; break; } } break; } default: { var $x0 = ({$: "Pair"});var $x51 = ({$: "Node"});var $x52 = $x1.key_value;$x51.key_value = $x52;var $x53 = ({$: "PlusOne"});$x51.balance = $x53;var $x54 = $x1.left;$x51.left = $x54;var $x55 = ({$: "Node"});var $x56 = $x5.key_value;$x55.key_value = $x56;var $x57 = ({$: "MinusOne"});$x55.balance = $x57;var $x58 = $x7;$x55.left = $x58;var $x59 = $x5.right;$x55.right = $x59;$x51.right = $x55;$x0.fst = $x51;var $x60 = ({$: "False"});$x0.snd = $x60; break; } } break; } case "PlusOne": { var $x0 = ({$: "Pair"});var $x61 = ({$: "Node"});var $x62 = $x5.key_value;$x61.key_value = $x62;var $x63 = ({$: "Zero"});$x61.balance = $x63;var $x64 = ({$: "Node"});var $x65 = $x1.key_value;$x64.key_value = $x65;var $x66 = ({$: "Zero"});$x64.balance = $x66;var $x67 = $x1.left;$x64.left = $x67;var $x68 = $x5.left;$x64.right = $x68;$x61.left = $x64;var $x69 = $x5.right;$x61.right = $x69;$x0.fst = $x61;var $x70 = ({$: "False"});$x0.snd = $x70; break; } case "Zero": { var $x0 = ({$: "Pair"});var $x71 = ({$: "Node"});var $x72 = $x5.key_value;$x71.key_value = $x72;var $x73 = ({$: "MinusOne"});$x71.balance = $x73;var $x74 = ({$: "Node"});var $x75 = $x1.key_value;$x74.key_value = $x75;var $x76 = ({$: "PlusOne"});$x74.balance = $x76;var $x77 = $x1.left;$x74.left = $x77;var $x78 = $x5.left;$x74.right = $x78;$x71.left = $x74;var $x79 = $x5.right;$x71.right = $x79;$x0.fst = $x71;var $x80 = ({$: "True"});$x0.snd = $x80; break; } default: { var $x83 = /*Type*/null;var $x84 = $x6;var $x82 = ($x83)($x84);var $x85 = $x5.left;var $x81 = ($x82)($x85);var $x86 = $x5.right;var $x0 = ($x81)($x86); break; } } break; } default: { var $x0 = ({$: "Pair"});var $x87 = ({$: "Node"});var $x88 = $x1.key_value;$x87.key_value = $x88;var $x89 = ({$: "PlusOne"});$x87.balance = $x89;var $x90 = $x1.left;$x87.left = $x90;var $x91 = $x5;$x87.right = $x91;$x0.fst = $x87;var $x92 = ({$: "False"});$x0.snd = $x92; break; } } break; } default: { var $x0 = ({$: "Pair"});var $x93 = ({$: "Node"});var $x94 = $x1.key_value;$x93.key_value = $x94;var $x95 = $x4;$x93.balance = $x95;var $x96 = $x1.left;$x93.left = $x96;var $x97 = $x1.right;$x93.right = $x97;$x0.fst = $x93;var $x98 = ({$: "False"});$x0.snd = $x98; break; } } break; } default: { var $x99 = /*Type*/null;var $x100 = $x1;var $x0 = ($x99)($x100); break; } }return $x0; }
const $OrdTree$Balance$rotate_left = _$0 => _$1 => _$2 => $OrdTree$Balance$rotate_left$(_$0,_$1,_$2)

function $OrdTree$Balance$rotate_right$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:OrdTree<null><null>*/) {var $x1 = _$2;switch ($x1.$) { case "Leaf": { var $x0 = ({$: "Pair"});var $x2 = ({$: "Leaf"});$x0.fst = $x2;var $x3 = ({$: "False"});$x0.snd = $x3; break; } case "Node": { var $x4 = $x1.balance;switch ($x4.$) { case "MinusOne": { var $x5 = $x1.left;switch ($x5.$) { case "Node": { var $x6 = $x5.balance;switch ($x6.$) { case "MinusOne": { var $x0 = ({$: "Pair"});var $x7 = ({$: "Node"});var $x8 = $x5.key_value;$x7.key_value = $x8;var $x9 = ({$: "Zero"});$x7.balance = $x9;var $x10 = $x5.left;$x7.left = $x10;var $x11 = ({$: "Node"});var $x12 = $x1.key_value;$x11.key_value = $x12;var $x13 = ({$: "Zero"});$x11.balance = $x13;var $x14 = $x5.right;$x11.left = $x14;var $x15 = $x1.right;$x11.right = $x15;$x7.right = $x11;$x0.fst = $x7;var $x16 = ({$: "False"});$x0.snd = $x16; break; } case "PlusOne": { var $x17 = $x5.right;switch ($x17.$) { case "Node": { var $x18 = $x17.balance;switch ($x18.$) { case "MinusOne": { var $x0 = ({$: "Pair"});var $x19 = ({$: "Node"});var $x20 = $x17.key_value;$x19.key_value = $x20;var $x21 = ({$: "Zero"});$x19.balance = $x21;var $x22 = ({$: "Node"});var $x23 = $x5.key_value;$x22.key_value = $x23;var $x24 = ({$: "Zero"});$x22.balance = $x24;var $x25 = $x5.left;$x22.left = $x25;var $x26 = $x17.left;$x22.right = $x26;$x19.left = $x22;var $x27 = ({$: "Node"});var $x28 = $x1.key_value;$x27.key_value = $x28;var $x29 = ({$: "PlusOne"});$x27.balance = $x29;var $x30 = $x17.right;$x27.left = $x30;var $x31 = $x1.right;$x27.right = $x31;$x19.right = $x27;$x0.fst = $x19;var $x32 = ({$: "False"});$x0.snd = $x32; break; } case "PlusOne": { var $x0 = ({$: "Pair"});var $x33 = ({$: "Node"});var $x34 = $x17.key_value;$x33.key_value = $x34;var $x35 = ({$: "Zero"});$x33.balance = $x35;var $x36 = ({$: "Node"});var $x37 = $x5.key_value;$x36.key_value = $x37;var $x38 = ({$: "MinusOne"});$x36.balance = $x38;var $x39 = $x5.left;$x36.left = $x39;var $x40 = $x17.left;$x36.right = $x40;$x33.left = $x36;var $x41 = ({$: "Node"});var $x42 = $x1.key_value;$x41.key_value = $x42;var $x43 = ({$: "Zero"});$x41.balance = $x43;var $x44 = $x17.right;$x41.left = $x44;var $x45 = $x1.right;$x41.right = $x45;$x33.right = $x41;$x0.fst = $x33;var $x46 = ({$: "False"});$x0.snd = $x46; break; } case "Zero": { var $x0 = ({$: "Pair"});var $x47 = ({$: "Node"});var $x48 = $x17.key_value;$x47.key_value = $x48;var $x49 = ({$: "Zero"});$x47.balance = $x49;var $x50 = ({$: "Node"});var $x51 = $x5.key_value;$x50.key_value = $x51;var $x52 = ({$: "Zero"});$x50.balance = $x52;var $x53 = $x5.left;$x50.left = $x53;var $x54 = $x17.left;$x50.right = $x54;$x47.left = $x50;var $x55 = ({$: "Node"});var $x56 = $x1.key_value;$x55.key_value = $x56;var $x57 = ({$: "Zero"});$x55.balance = $x57;var $x58 = $x17.right;$x55.left = $x58;var $x59 = $x1.right;$x55.right = $x59;$x47.right = $x55;$x0.fst = $x47;var $x60 = ({$: "False"});$x0.snd = $x60; break; } } break; } default: { var $x0 = ({$: "Pair"});var $x61 = ({$: "Node"});var $x62 = $x1.key_value;$x61.key_value = $x62;var $x63 = ({$: "MinusOne"});$x61.balance = $x63;var $x64 = ({$: "Node"});var $x65 = $x5.key_value;$x64.key_value = $x65;var $x66 = ({$: "PlusOne"});$x64.balance = $x66;var $x67 = $x5.left;$x64.left = $x67;var $x68 = $x17;$x64.right = $x68;$x61.left = $x64;var $x69 = $x1.right;$x61.right = $x69;$x0.fst = $x61;var $x70 = ({$: "False"});$x0.snd = $x70; break; } } break; } case "Zero": { var $x0 = ({$: "Pair"});var $x71 = ({$: "Node"});var $x72 = $x5.key_value;$x71.key_value = $x72;var $x73 = ({$: "PlusOne"});$x71.balance = $x73;var $x74 = $x5.left;$x71.left = $x74;var $x75 = ({$: "Node"});var $x76 = $x1.key_value;$x75.key_value = $x76;var $x77 = ({$: "MinusOne"});$x75.balance = $x77;var $x78 = $x5.right;$x75.left = $x78;var $x79 = $x1.right;$x75.right = $x79;$x71.right = $x75;$x0.fst = $x71;var $x80 = ({$: "True"});$x0.snd = $x80; break; } default: { var $x84 = /*Type*/null;var $x85 = $x6;var $x83 = ($x84)($x85);var $x86 = $x5.left;var $x82 = ($x83)($x86);var $x87 = $x5.right;var $x81 = ($x82)($x87);var $x88 = $x1.right;var $x0 = ($x81)($x88); break; } } break; } default: { var $x0 = ({$: "Pair"});var $x89 = ({$: "Node"});var $x90 = $x1.key_value;$x89.key_value = $x90;var $x91 = ({$: "MinusOne"});$x89.balance = $x91;var $x92 = $x5;$x89.left = $x92;var $x93 = $x1.right;$x89.right = $x93;$x0.fst = $x89;var $x94 = ({$: "False"});$x0.snd = $x94; break; } } break; } default: { var $x0 = ({$: "Pair"});var $x95 = ({$: "Node"});var $x96 = $x1.key_value;$x95.key_value = $x96;var $x97 = $x4;$x95.balance = $x97;var $x98 = $x1.left;$x95.left = $x98;var $x99 = $x1.right;$x95.right = $x99;$x0.fst = $x95;var $x100 = ({$: "False"});$x0.snd = $x100; break; } } break; } default: { var $x101 = /*Type*/null;var $x102 = $x1;var $x0 = ($x101)($x102); break; } }return $x0; }
const $OrdTree$Balance$rotate_right = _$0 => _$1 => _$2 => $OrdTree$Balance$rotate_right$(_$0,_$1,_$2)

function $OrdTree$empty$(_$0/*:Type*/,_$1/*:Type*/) {var $x0 = ({$: "Leaf"});return $x0; }
const $OrdTree$empty = _$0 => _$1 => $OrdTree$empty$(_$0,_$1)

function $OrdTree$fold$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:OrdTree<null><null>*/,_$3/*:Type*/,_$4/*:null*/,_$5/*:($_$5:Pair<null><null>) => ($_$6:null) => null*/) {while(1){var $x1 = _$2;switch ($x1.$) { case "Leaf": { var $x0 = _$4; break; } case "Node": { var $x2 = _$0;var $x3 = _$1;var $x4 = $x1.left;var $x5 = _$3;var $x6 = _$4;var $x7 = _$5;var $left_result$0 = $OrdTree$fold$($x2, $x3, $x4, $x5, $x6, $x7);var $x9 = _$5;var $x10 = $x1.key_value;var $x8 = ($x9)($x10);var $x11 = $left_result$0;var $curr_result$1 = ($x8)($x11);var $x12 = _$0;var $x13 = _$1;var $x14 = $x1.right;var $x15 = _$3;var $x16 = $curr_result$1;var $x17 = _$5;_$0 = $x12;_$1 = $x13;_$2 = $x14;_$3 = $x15;_$4 = $x16;_$5 = $x17;/*TCO*/continue; break; } }return $x0; }}
const $OrdTree$fold = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $OrdTree$fold$(_$0,_$1,_$2,_$3,_$4,_$5)

function $OrdTree$get$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:Ord<null>*/,_$3/*:OrdTree<null><null>*/) {var $x1 = _$3;switch ($x1.$) { case "Leaf": { var $x0 = ($key$0 => {var $x2 = ({$: "None"});return $x2;}); break; } case "Node": { var $x3 = $x1.key_value;var $x0 = ($key$0 => {var $x6 = _$0;var $x7 = _$2;var $x8 = $key$0;var $x9 = $x3.fst;var $x5 = $Ord$compare$($x6, $x7, $x8, $x9);switch ($x5.$) { case "EQ": { var $x4 = ({$: "Some"});var $x10 = $x3.snd;$x4.value = $x10; break; } case "GT": { var $x12 = _$0;var $x13 = _$1;var $x14 = _$2;var $x15 = $x1.right;var $x11 = $OrdTree$get$($x12, $x13, $x14, $x15);var $x16 = $key$0;var $x4 = ($x11)($x16); break; } case "LT": { var $x18 = _$0;var $x19 = _$1;var $x20 = _$2;var $x21 = $x1.left;var $x17 = $OrdTree$get$($x18, $x19, $x20, $x21);var $x22 = $key$0;var $x4 = ($x17)($x22); break; } }return $x4;}); break; } }return $x0; }
const $OrdTree$get = _$0 => _$1 => _$2 => _$3 => $OrdTree$get$(_$0,_$1,_$2,_$3)

function $OrdTree$height$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:OrdTree<null><null>*/) {var $x1 = _$2;switch ($x1.$) { case "Leaf": { var $x0 = ({$: "Zero"}); break; } case "Node": { var $x0 = ({$: "Succ"});var $x4 = _$0;var $x5 = _$1;var $x6 = $x1.left;var $x3 = $OrdTree$height$($x4, $x5, $x6);var $x8 = _$0;var $x9 = _$1;var $x10 = $x1.right;var $x7 = $OrdTree$height$($x8, $x9, $x10);var $x2 = $Nat$max$($x3, $x7);$x0.pred = $x2; break; } }return $x0; }
const $OrdTree$height = _$0 => _$1 => _$2 => $OrdTree$height$(_$0,_$1,_$2)

function $Pair$get_fst$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:Pair<null><null>*/) {var $x1 = _$2;var $x0 = $x1.fst;return $x0; }
const $Pair$get_fst = _$0 => _$1 => _$2 => $Pair$get_fst$(_$0,_$1,_$2)

function $OrdTree$insert$go$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:Ord<null>*/,_$3/*:OrdTree<null><null>*/) {var $x1 = _$3;switch ($x1.$) { case "Leaf": { var $x0 = ($kv$0 => {var $x2 = ({$: "Pair"});var $x3 = ({$: "Node"});var $x4 = $kv$0;$x3.key_value = $x4;var $x5 = ({$: "Zero"});$x3.balance = $x5;var $x6 = ({$: "Leaf"});$x3.left = $x6;var $x7 = ({$: "Leaf"});$x3.right = $x7;$x2.fst = $x3;var $x8 = ({$: "True"});$x2.snd = $x8;return $x2;}); break; } case "Node": { var $x9 = $x1.key_value;var $x0 = ($__8$0 => {var $x11 = $__8$0;var $x13 = _$0;var $x14 = _$2;var $x15 = $x11.fst;var $x16 = $x9.fst;var $x12 = $Ord$compare$($x13, $x14, $x15, $x16);switch ($x12.$) { case "EQ": { var $x10 = ({$: "Pair"});var $x17 = ({$: "Node"});var $x18 = ({$: "Pair"});var $x19 = $x11.fst;$x18.fst = $x19;var $x20 = $x11.snd;$x18.snd = $x20;$x17.key_value = $x18;var $x21 = $x1.balance;$x17.balance = $x21;var $x22 = $x1.left;$x17.left = $x22;var $x23 = $x1.right;$x17.right = $x23;$x10.fst = $x17;var $x24 = ({$: "False"});$x10.snd = $x24; break; } case "GT": { var $x26 = _$0;var $x27 = _$1;var $x28 = _$2;var $x29 = $x1.right;var $x25 = $OrdTree$insert$go$($x26, $x27, $x28, $x29);var $x30 = ({$: "Pair"});var $x31 = $x11.fst;$x30.fst = $x31;var $x32 = $x11.snd;$x30.snd = $x32;var $got$1 = ($x25)($x30);var $x33 = $got$1;var $x34 = $x33.snd;switch ($x34.$) { case "True": { var $x35 = $x1.balance;switch ($x35.$) { case "PlusOne": { var $x36 = _$0;var $x37 = _$1;var $x38 = ({$: "Node"});var $x39 = ({$: "Pair"});var $x40 = $x9.fst;$x39.fst = $x40;var $x41 = $x9.snd;$x39.snd = $x41;$x38.key_value = $x39;var $x42 = ({$: "PlusOne"});$x38.balance = $x42;var $x43 = $x1.left;$x38.left = $x43;var $x44 = $x33.fst;$x38.right = $x44;var $x10 = $OrdTree$Balance$rotate_left$($x36, $x37, $x38); break; } case "Zero": { var $x10 = ({$: "Pair"});var $x45 = ({$: "Node"});var $x46 = ({$: "Pair"});var $x47 = $x9.fst;$x46.fst = $x47;var $x48 = $x9.snd;$x46.snd = $x48;$x45.key_value = $x46;var $x49 = ({$: "PlusOne"});$x45.balance = $x49;var $x50 = $x1.left;$x45.left = $x50;var $x51 = $x33.fst;$x45.right = $x51;$x10.fst = $x45;var $x52 = ({$: "True"});$x10.snd = $x52; break; } case "MinusOne": { var $x10 = ({$: "Pair"});var $x53 = ({$: "Node"});var $x54 = ({$: "Pair"});var $x55 = $x9.fst;$x54.fst = $x55;var $x56 = $x9.snd;$x54.snd = $x56;$x53.key_value = $x54;var $x57 = ({$: "Zero"});$x53.balance = $x57;var $x58 = $x1.left;$x53.left = $x58;var $x59 = $x33.fst;$x53.right = $x59;$x10.fst = $x53;var $x60 = ({$: "False"});$x10.snd = $x60; break; } } break; } case "False": { var $x10 = ({$: "Pair"});var $x61 = ({$: "Node"});var $x62 = ({$: "Pair"});var $x63 = $x9.fst;$x62.fst = $x63;var $x64 = $x9.snd;$x62.snd = $x64;$x61.key_value = $x62;var $x65 = $x1.balance;$x61.balance = $x65;var $x66 = $x1.left;$x61.left = $x66;var $x67 = $x33.fst;$x61.right = $x67;$x10.fst = $x61;var $x68 = ({$: "False"});$x10.snd = $x68; break; } } break; } case "LT": { var $x70 = _$0;var $x71 = _$1;var $x72 = _$2;var $x73 = $x1.left;var $x69 = $OrdTree$insert$go$($x70, $x71, $x72, $x73);var $x74 = ({$: "Pair"});var $x75 = $x11.fst;$x74.fst = $x75;var $x76 = $x11.snd;$x74.snd = $x76;var $got$1 = ($x69)($x74);var $x77 = $got$1;var $x78 = $x77.snd;switch ($x78.$) { case "True": { var $x79 = $x1.balance;switch ($x79.$) { case "PlusOne": { var $x10 = ({$: "Pair"});var $x80 = ({$: "Node"});var $x81 = ({$: "Pair"});var $x82 = $x9.fst;$x81.fst = $x82;var $x83 = $x9.snd;$x81.snd = $x83;$x80.key_value = $x81;var $x84 = ({$: "Zero"});$x80.balance = $x84;var $x85 = $x77.fst;$x80.left = $x85;var $x86 = $x1.right;$x80.right = $x86;$x10.fst = $x80;var $x87 = ({$: "False"});$x10.snd = $x87; break; } case "Zero": { var $x10 = ({$: "Pair"});var $x88 = ({$: "Node"});var $x89 = ({$: "Pair"});var $x90 = $x9.fst;$x89.fst = $x90;var $x91 = $x9.snd;$x89.snd = $x91;$x88.key_value = $x89;var $x92 = ({$: "MinusOne"});$x88.balance = $x92;var $x93 = $x77.fst;$x88.left = $x93;var $x94 = $x1.right;$x88.right = $x94;$x10.fst = $x88;var $x95 = ({$: "True"});$x10.snd = $x95; break; } case "MinusOne": { var $x96 = _$0;var $x97 = _$1;var $x98 = ({$: "Node"});var $x99 = ({$: "Pair"});var $x100 = $x9.fst;$x99.fst = $x100;var $x101 = $x9.snd;$x99.snd = $x101;$x98.key_value = $x99;var $x102 = ({$: "MinusOne"});$x98.balance = $x102;var $x103 = $x77.fst;$x98.left = $x103;var $x104 = $x1.right;$x98.right = $x104;var $x10 = $OrdTree$Balance$rotate_right$($x96, $x97, $x98); break; } } break; } case "False": { var $x10 = ({$: "Pair"});var $x105 = ({$: "Node"});var $x106 = ({$: "Pair"});var $x107 = $x9.fst;$x106.fst = $x107;var $x108 = $x9.snd;$x106.snd = $x108;$x105.key_value = $x106;var $x109 = $x1.balance;$x105.balance = $x109;var $x110 = $x77.fst;$x105.left = $x110;var $x111 = $x1.right;$x105.right = $x111;$x10.fst = $x105;var $x112 = ({$: "False"});$x10.snd = $x112; break; } } break; } }return $x10;}); break; } }return $x0; }
const $OrdTree$insert$go = _$0 => _$1 => _$2 => _$3 => $OrdTree$insert$go$(_$0,_$1,_$2,_$3)

function $OrdTree$insert$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:Ord<null>*/,_$3/*:OrdTree<null><null>*/,_$4/*:Pair<null><null>*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = $OrdTree$($x2, $x3);var $x4 = $Bool;var $x7 = _$0;var $x8 = _$1;var $x9 = _$2;var $x10 = _$3;var $x6 = $OrdTree$insert$go$($x7, $x8, $x9, $x10);var $x11 = _$4;var $x5 = ($x6)($x11);var $x0 = $Pair$get_fst$($x1, $x4, $x5);return $x0; }
const $OrdTree$insert = _$0 => _$1 => _$2 => _$3 => _$4 => $OrdTree$insert$(_$0,_$1,_$2,_$3,_$4)

function $OrdTree$keys$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:OrdTree<null><null>*/) {var $x1 = _$2;switch ($x1.$) { case "Leaf": { var $x0 = ({$: "Nil"}); break; } case "Node": { var $x2 = $x1.key_value;var $x3 = _$0;var $x4 = _$1;var $x5 = $x1.left;var $left_keys$0 = $OrdTree$keys$($x3, $x4, $x5);var $x6 = _$0;var $x7 = _$1;var $x8 = $x1.right;var $right_keys$1 = $OrdTree$keys$($x6, $x7, $x8);var $x9 = _$0;var $x10 = $left_keys$0;var $x11 = ({$: "Cons"});var $x12 = $x2.fst;$x11.head = $x12;var $x13 = $right_keys$1;$x11.tail = $x13;var $x0 = $List$append$($x9, $x10, $x11); break; } }return $x0; }
const $OrdTree$keys = _$0 => _$1 => _$2 => $OrdTree$keys$(_$0,_$1,_$2)

function $OrdTree$singleton$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:Pair<null><null>*/) {var $x0 = ({$: "Node"});var $x1 = _$2;$x0.key_value = $x1;var $x2 = ({$: "Zero"});$x0.balance = $x2;var $x3 = ({$: "Leaf"});$x0.left = $x3;var $x4 = ({$: "Leaf"});$x0.right = $x4;return $x0; }
const $OrdTree$singleton = _$0 => _$1 => _$2 => $OrdTree$singleton$(_$0,_$1,_$2)

function $OrdTree$size$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:OrdTree<null><null>*/) {var $x1 = _$2;switch ($x1.$) { case "Leaf": { var $x0 = ({$: "Zero"}); break; } case "Node": { var $x2 = _$0;var $x3 = _$1;var $x4 = $x1.left;var $left_size$0 = $OrdTree$size$($x2, $x3, $x4);var $x5 = _$0;var $x6 = _$1;var $x7 = $x1.right;var $right_size$1 = $OrdTree$size$($x5, $x6, $x7);var $x0 = ({$: "Succ"});var $x9 = $left_size$0;var $x10 = $right_size$1;var $x8 = $Nat$add$($x9, $x10);$x0.pred = $x8; break; } }return $x0; }
const $OrdTree$size = _$0 => _$1 => _$2 => $OrdTree$size$(_$0,_$1,_$2)

const $SETNICK$ = (() => {var $x0 = 101n;return $x0; })()
const $SETNICK = $SETNICK$

const $String$ = (() => {var $x1 = $Char;var $x0 = $List$($x1);return $x0; })()
const $String = $String$

function $String$compare$(_$0/*:String*/,_$1/*:String*/) {while(1){var $x1 = _$0;switch ($x1.$) { case "Cons": { var $x2 = _$1;switch ($x2.$) { case "Cons": { var $x4 = $Char;var $x5 = $Char$Ord;var $x6 = $x1.head;var $x7 = $x2.head;var $x3 = $Ord$compare$($x4, $x5, $x6, $x7);switch ($x3.$) { case "LT": { var $x0 = ({$: "LT"}); break; } case "EQ": { var $x8 = $x1.tail;var $x9 = $x2.tail;_$0 = $x8;_$1 = $x9;/*TCO*/continue; break; } case "GT": { var $x0 = ({$: "GT"}); break; } } break; } case "Nil": { var $x0 = ({$: "GT"}); break; } } break; } case "Nil": { var $x10 = _$1;switch ($x10.$) { case "Cons": { var $x0 = ({$: "LT"}); break; } case "Nil": { var $x0 = ({$: "EQ"}); break; } } break; } }return $x0; }}
const $String$compare = _$0 => _$1 => $String$compare$(_$0,_$1)

const $String$Ord$ = (() => {var $x0 = ({$: "Ord"});var $x1 = $String$compare;$x0.compare = $x1;return $x0; })()
const $String$Ord = $String$Ord$

function $String$eq$(_$0/*:String*/,_$1/*:String*/) {while(1){var $x1 = _$0;switch ($x1.$) { case "Cons": { var $x2 = _$1;switch ($x2.$) { case "Cons": { var $x4 = $x1.head;var $x5 = $x2.head;var $x3 = $Char$eq$($x4, $x5);switch ($x3.$) { case "True": { var $x6 = $x1.tail;var $x7 = $x2.tail;_$0 = $x6;_$1 = $x7;/*TCO*/continue; break; } case "False": { var $x0 = ({$: "False"}); break; } } break; } case "Nil": { var $x0 = ({$: "False"}); break; } } break; } case "Nil": { var $x8 = _$1;switch ($x8.$) { case "Cons": { var $x0 = ({$: "False"}); break; } case "Nil": { var $x0 = ({$: "True"}); break; } } break; } }return $x0; }}
const $String$eq = _$0 => _$1 => $String$eq$(_$0,_$1)

const $TPS$ = (() => {var $x0 = 50n;return $x0; })()
const $TPS = $TPS$

const $U64$Ord$ = (() => {var $x0 = ({$: "Ord"});var $x1 = $U64$compare;$x0.compare = $x1;return $x0; })()
const $U64$Ord = $U64$Ord$

function $U64$add$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = BigInt.asUintN(64, $x1 + $x2);return $x0; }
const $U64$add = _$0 => _$1 => $U64$add$(_$0,_$1)

function $U64$div$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = BigInt.asUintN(64, $x1 / $x2);return $x0; }
const $U64$div = _$0 => _$1 => $U64$div$(_$0,_$1)

function $U64$from_bool$(_$0/*:Bool*/) {var $x1 = _$0;switch ($x1.$) { case "False": { var $x0 = 0n; break; } case "True": { var $x0 = 1n; break; } }return $x0; }
const $U64$from_bool = _$0 => $U64$from_bool$(_$0)

function $U64$gt$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 > $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $U64$gt = _$0 => _$1 => $U64$gt$(_$0,_$1)

function $U64$gte$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 >= $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $U64$gte = _$0 => _$1 => $U64$gte$(_$0,_$1)

function $U64$lt$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 < $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $U64$lt = _$0 => _$1 => $U64$lt$(_$0,_$1)

function $U64$lte$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 <= $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $U64$lte = _$0 => _$1 => $U64$lte$(_$0,_$1)

function $U64$max$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x3 = _$0;var $x4 = _$1;var $x2 = BigInt.asUintN(64, $x3 >= $x4);var $x1 = $U64$to_bool$($x2);switch ($x1.$) { case "True": { var $x0 = _$0; break; } case "False": { var $x0 = _$1; break; } }return $x0; }
const $U64$max = _$0 => _$1 => $U64$max$(_$0,_$1)

function $U64$min$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x3 = _$0;var $x4 = _$1;var $x2 = BigInt.asUintN(64, $x3 <= $x4);var $x1 = $U64$to_bool$($x2);switch ($x1.$) { case "True": { var $x0 = _$0; break; } case "False": { var $x0 = _$1; break; } }return $x0; }
const $U64$min = _$0 => _$1 => $U64$min$(_$0,_$1)

function $U64$mod$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = BigInt.asUintN(64, $x1 % $x2);return $x0; }
const $U64$mod = _$0 => _$1 => $U64$mod$(_$0,_$1)

function $U64$mul$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = BigInt.asUintN(64, $x1 * $x2);return $x0; }
const $U64$mul = _$0 => _$1 => $U64$mul$(_$0,_$1)

function $U64$neq$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = BigInt.asUintN(64, $x2 !== $x3);var $x0 = $U64$to_bool$($x1);return $x0; }
const $U64$neq = _$0 => _$1 => $U64$neq$(_$0,_$1)

function $U64$sub$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = BigInt.asUintN(64, $x1 - $x2);return $x0; }
const $U64$sub = _$0 => _$1 => $U64$sub$(_$0,_$1)

function $U64$to_bits$(_$0/*:BigInt*/) {var $x1 = _$0;if ($x1 === 0n) { var $x0 = ({$: "E"}); } else { var $x3 = $x1;var $x4 = 1n;var $x2 = BigInt.asUintN(64, $x3 - $x4);if ($x2 === 0n) { var $x0 = ({$: "I"});var $x5 = ({$: "E"});$x0.tail = $x5; } else { var $x7 = 2n;var $x9 = $x2;var $x10 = 1n;var $x8 = BigInt.asUintN(64, $x9 - $x10);var $x6 = BigInt.asUintN(64, $x7 + $x8);var $x11 = 2n;var $quotient$0 = $U64$div$($x6, $x11);var $x13 = 2n;var $x15 = $x2;var $x16 = 1n;var $x14 = BigInt.asUintN(64, $x15 - $x16);var $x12 = BigInt.asUintN(64, $x13 + $x14);var $x17 = 2n;var $remainder$1 = $U64$mod$($x12, $x17);var $x19 = $remainder$1;var $x18 = $U64$to_bool$($x19);switch ($x18.$) { case "True": { var $x0 = ({$: "I"});var $x21 = $quotient$0;var $x20 = $U64$to_bits$($x21);$x0.tail = $x20; break; } case "False": { var $x0 = ({$: "O"});var $x23 = $quotient$0;var $x22 = $U64$to_bits$($x23);$x0.tail = $x22; break; } } } }return $x0; }
const $U64$to_bits = _$0 => $U64$to_bits$(_$0)

const $UG$Collision$Collidable$ = (() => {var $x0 = /*{$:'Hard'} | {$:'TakesEffects'} | {$:'Untouchable'}*/null;return $x0; })()
const $UG$Collision$Collidable = $UG$Collision$Collidable$

const $V2$ = (() => {var $x0 = /*{$:'V2', x: Number, y: Number}*/null;return $x0; })()
const $V2 = $V2$

function $V2$round$(_$0/*:V2*/) {var $x1 = _$0;var $x0 = ({$: "V2"});var $x3 = $x1.x;var $x4 = 0.0;var $x2 = (Math.round($x3 * Math.pow(10, 2)) / Math.pow(10, 2));$x0.x = $x2;var $x6 = $x1.y;var $x7 = 0.0;var $x5 = (Math.round($x6 * Math.pow(10, 2)) / Math.pow(10, 2));$x0.y = $x5;return $x0; }
const $V2$round = _$0 => $V2$round$(_$0)

function $V2$div_scalar$(_$0/*:V2*/,_$1/*:Number*/) {var $x1 = _$0;var $x3 = _$1;var $x2 = $F64$is_zero$($x3);switch ($x2.$) { case "True": { var $x0 = ({$: "V2"});var $x4 = 0.0;$x0.x = $x4;var $x5 = 0.0;$x0.y = $x5; break; } case "False": { var $x0 = ({$: "V2"});var $x7 = $x1.x;var $x8 = _$1;var $x6 = $F64$div$($x7, $x8);$x0.x = $x6;var $x10 = $x1.y;var $x11 = _$1;var $x9 = $F64$div$($x10, $x11);$x0.y = $x9; break; } }return $x0; }
const $V2$div_scalar = _$0 => _$1 => $V2$div_scalar$(_$0,_$1)

function $V2$length$(_$0/*:V2*/) {var $x1 = _$0;var $x4 = $x1.x;var $x5 = $x1.x;var $x3 = $F64$mul$($x4, $x5);var $x7 = $x1.y;var $x8 = $x1.y;var $x6 = $F64$mul$($x7, $x8);var $x2 = $F64$add$($x3, $x6);var $x0 = $F64$sqrt$($x2);return $x0; }
const $V2$length = _$0 => $V2$length$(_$0)

function $V2$is_zero$(_$0/*:V2*/) {var $x1 = _$0;var $x3 = $x1.x;var $x2 = $F64$is_zero$($x3);var $x5 = $x1.y;var $x4 = $F64$is_zero$($x5);var $x0 = $Bool$and$($x2, $x4);return $x0; }
const $V2$is_zero = _$0 => $V2$is_zero$(_$0)

function $V2$normalize$(_$0/*:V2*/) {var $x2 = _$0;var $x1 = $V2$is_zero$($x2);switch ($x1.$) { case "True": { var $x0 = _$0; break; } case "False": { var $x3 = _$0;var $x5 = _$0;var $x4 = $V2$length$($x5);var $x0 = $V2$div_scalar$($x3, $x4); break; } }return $x0; }
const $V2$normalize = _$0 => $V2$normalize$(_$0)

function $V2$sub$(_$0/*:V2*/,_$1/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = ({$: "V2"});var $x4 = $x1.x;var $x5 = $x2.x;var $x3 = $F64$sub$($x4, $x5);$x0.x = $x3;var $x7 = $x1.y;var $x8 = $x2.y;var $x6 = $F64$sub$($x7, $x8);$x0.y = $x6;return $x0; }
const $V2$sub = _$0 => _$1 => $V2$sub$(_$0,_$1)

function $UG$Shape$segments$(_$0/*:List<V2>*/) {var $x1 = _$0;switch ($x1.$) { case "Cons": { var $x2 = null;var $x3 = $x1.tail;var $x4 = ({$: "Cons"});var $x5 = $x1.head;$x4.head = $x5;var $x6 = ({$: "Nil"});$x4.tail = $x6;var $next_points$0 = $List$append$($x2, $x3, $x4);var $x7 = null;var $x8 = null;var $x9 = ({$: "Cons"});var $x10 = $x1.head;$x9.head = $x10;var $x11 = $x1.tail;$x9.tail = $x11;var $x12 = $next_points$0;var $x0 = $List$zip$($x7, $x8, $x9, $x12); break; } case "Nil": { var $x0 = ({$: "Nil"}); break; } }return $x0; }
const $UG$Shape$segments = _$0 => $UG$Shape$segments$(_$0)

function $V2$dot$(_$0/*:V2*/,_$1/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x4 = $x1.x;var $x5 = $x2.x;var $x3 = $F64$mul$($x4, $x5);var $x7 = $x1.y;var $x8 = $x2.y;var $x6 = $F64$mul$($x7, $x8);var $x0 = $F64$add$($x3, $x6);return $x0; }
const $V2$dot = _$0 => _$1 => $V2$dot$(_$0,_$1)

function $V2$point_to_segment_distance$(_$0/*:V2*/,_$1/*:V2*/,_$2/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $ab$0 = ({$: "V2"});var $x5 = $x3.x;var $x6 = $x2.x;var $x4 = $F64$sub$($x5, $x6);$ab$0.x = $x4;var $x8 = $x3.y;var $x9 = $x2.y;var $x7 = $F64$sub$($x8, $x9);$ab$0.y = $x7;var $ap$1 = ({$: "V2"});var $x11 = $x1.x;var $x12 = $x2.x;var $x10 = $F64$sub$($x11, $x12);$ap$1.x = $x10;var $x14 = $x1.y;var $x15 = $x2.y;var $x13 = $F64$sub$($x14, $x15);$ap$1.y = $x13;var $x19 = $ap$1;var $x20 = $ab$0;var $x18 = $V2$dot$($x19, $x20);var $x22 = $ab$0;var $x23 = $ab$0;var $x21 = $V2$dot$($x22, $x23);var $x16 = $F64$div$($x18, $x21);var $x17 = 0.0;var $projection$2 = (Math.round($x16 * Math.pow(10, 2)) / Math.pow(10, 2));var $x25 = $projection$2;var $x26 = 0.0;var $x24 = $F64$lt$($x25, $x26);switch ($x24.$) { case "True": { var $x0 = ({$: "V2"});var $x27 = $x2.x;$x0.x = $x27;var $x28 = $x2.y;$x0.y = $x28; break; } case "False": { var $x30 = $projection$2;var $x31 = 1.0;var $x29 = $F64$gt$($x30, $x31);switch ($x29.$) { case "True": { var $x0 = ({$: "V2"});var $x32 = $x3.x;$x0.x = $x32;var $x33 = $x3.y;$x0.y = $x33; break; } case "False": { var $x0 = ({$: "V2"});var $x37 = $x2.x;var $x40 = $x3.x;var $x41 = $x2.x;var $x39 = $F64$sub$($x40, $x41);var $x42 = $projection$2;var $x38 = $F64$mul$($x39, $x42);var $x35 = $F64$add$($x37, $x38);var $x36 = 0.0;var $x34 = (Math.round($x35 * Math.pow(10, 2)) / Math.pow(10, 2));$x0.x = $x34;var $x46 = $x2.y;var $x49 = $x3.y;var $x50 = $x2.y;var $x48 = $F64$sub$($x49, $x50);var $x51 = $projection$2;var $x47 = $F64$mul$($x48, $x51);var $x44 = $F64$add$($x46, $x47);var $x45 = 0.0;var $x43 = (Math.round($x44 * Math.pow(10, 2)) / Math.pow(10, 2));$x0.y = $x43; break; } } break; } }return $x0; }
const $V2$point_to_segment_distance = _$0 => _$1 => _$2 => $V2$point_to_segment_distance$(_$0,_$1,_$2)

function $UG$Shape$closest_point_on_polygon$go$(_$0/*:V2*/,_$1/*:Pair<V2><V2>*/) {var $x1 = _$1;var $x3 = _$0;var $x4 = $x1.fst;var $x5 = $x1.snd;var $x2 = $V2$point_to_segment_distance$($x3, $x4, $x5);var $x0 = $V2$round$($x2);return $x0; }
const $UG$Shape$closest_point_on_polygon$go = _$0 => _$1 => $UG$Shape$closest_point_on_polygon$go$(_$0,_$1)

function $UG$Shape$closest_point_on_polygon$(_$0/*:V2*/,_$1/*:List<V2>*/) {var $x1 = _$1;var $segments$0 = $UG$Shape$segments$($x1);var $x3 = $V2;var $x4 = $V2;var $x2 = $Pair$($x3, $x4);var $x5 = $V2;var $x6 = $segments$0;var $x8 = $UG$Shape$closest_point_on_polygon$go;var $x9 = _$0;var $x7 = ($x8)($x9);var $points$1 = $List$map$($x2, $x5, $x6, $x7);var $x10 = $V2;var $x11 = $points$1;var $x12 = ($p1$2 => $p2$3 => {var $x18 = _$0;var $x19 = $p1$2;var $x17 = $V2$sub$($x18, $x19);var $x15 = $V2$length$($x17);var $x16 = 0.0;var $x14 = (Math.round($x15 * Math.pow(10, 2)) / Math.pow(10, 2));var $x24 = _$0;var $x25 = $p2$3;var $x23 = $V2$sub$($x24, $x25);var $x21 = $V2$length$($x23);var $x22 = 0.0;var $x20 = (Math.round($x21 * Math.pow(10, 2)) / Math.pow(10, 2));var $x13 = $F64$lt$($x14, $x20);return $x13;});var $sorted$2 = $List$sort$($x10, $x11, $x12);var $x27 = $V2;var $x28 = $sorted$2;var $x26 = $List$head$($x27, $x28);switch ($x26.$) { case "None": { var $x0 = ({$: "V2"});var $x29 = 10000.0;$x0.x = $x29;var $x30 = 10000.0;$x0.y = $x30; break; } case "Some": { var $x31 = $x26.value;var $x0 = $V2$round$($x31); break; } }return $x0; }
const $UG$Shape$closest_point_on_polygon = _$0 => _$1 => $UG$Shape$closest_point_on_polygon$(_$0,_$1)

function $UG$Shape$abs_vertices$go$(_$0/*:V2*/,_$1/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = $x1.x;var $x4 = $x2.x;var $x$0 = $F64$add$($x3, $x4);var $x5 = $x1.y;var $x6 = $x2.y;var $y$1 = $F64$add$($x5, $x6);var $x0 = ({$: "V2"});var $x7 = $x$0;$x0.x = $x7;var $x8 = $y$1;$x0.y = $x8;return $x0; }
const $UG$Shape$abs_vertices$go = _$0 => _$1 => $UG$Shape$abs_vertices$go$(_$0,_$1)

const $UG$Shape$ = (() => {var $x0 = /*{$:'Circle', center: V2, radius: Number} | {$:'Polygon', center: V2, vertices: List<V2>}*/null;return $x0; })()
const $UG$Shape = $UG$Shape$

function $UG$Shape$abs_vertices$(_$0/*:UG/Shape*/) {var $x1 = _$0;switch ($x1.$) { case "Circle": { var $x0 = ({$: "Nil"}); break; } case "Polygon": { var $x2 = $V2;var $x3 = $V2;var $x4 = $x1.vertices;var $x6 = $UG$Shape$abs_vertices$go;var $x7 = $x1.center;var $x5 = ($x6)($x7);var $x0 = $List$map$($x2, $x3, $x4, $x5); break; } }return $x0; }
const $UG$Shape$abs_vertices = _$0 => $UG$Shape$abs_vertices$(_$0)

function $V2$new$(_$0/*:Number*/,_$1/*:Number*/) {var $x0 = ({$: "V2"});var $x1 = _$0;$x0.x = $x1;var $x2 = _$1;$x0.y = $x2;return $x0; }
const $V2$new = _$0 => _$1 => $V2$new$(_$0,_$1)

function $closest_point_polygon_polygon$(_$0/*:List<V2>*/,_$1/*:List<V2>*/) {var $x1 = 10000.0;var $x2 = 10000.0;var $x0 = $V2$new$($x1, $x2);return $x0; }
const $closest_point_polygon_polygon = _$0 => _$1 => $closest_point_polygon_polygon$(_$0,_$1)

function $UG$Collision$calculate_collision_normal$(_$0/*:UG/Shape*/,_$1/*:UG/Shape*/) {var $x1 = _$0;switch ($x1.$) { case "Circle": { var $x2 = _$1;switch ($x2.$) { case "Circle": { var $x5 = $x1.center;var $x6 = $x2.center;var $x4 = $V2$sub$($x5, $x6);var $x3 = $V2$normalize$($x4);var $x0 = $V2$round$($x3); break; } case "Polygon": { var $x9 = $x1.center;var $x11 = $x1.center;var $x13 = ({$: "Polygon"});var $x14 = $x2.center;$x13.center = $x14;var $x15 = $x2.vertices;$x13.vertices = $x15;var $x12 = $UG$Shape$abs_vertices$($x13);var $x10 = $UG$Shape$closest_point_on_polygon$($x11, $x12);var $x8 = $V2$sub$($x9, $x10);var $x7 = $V2$normalize$($x8);var $x0 = $V2$round$($x7); break; } } break; } case "Polygon": { var $x16 = _$1;switch ($x16.$) { case "Circle": { var $x20 = $x16.center;var $x22 = ({$: "Polygon"});var $x23 = $x1.center;$x22.center = $x23;var $x24 = $x1.vertices;$x22.vertices = $x24;var $x21 = $UG$Shape$abs_vertices$($x22);var $x19 = $UG$Shape$closest_point_on_polygon$($x20, $x21);var $x25 = $x1.center;var $x18 = $V2$sub$($x19, $x25);var $x17 = $V2$normalize$($x18);var $x0 = $V2$round$($x17); break; } case "Polygon": { var $x29 = ({$: "Polygon"});var $x30 = $x1.center;$x29.center = $x30;var $x31 = $x1.vertices;$x29.vertices = $x31;var $x28 = $UG$Shape$abs_vertices$($x29);var $x33 = ({$: "Polygon"});var $x34 = $x16.center;$x33.center = $x34;var $x35 = $x16.vertices;$x33.vertices = $x35;var $x32 = $UG$Shape$abs_vertices$($x33);var $x27 = $closest_point_polygon_polygon$($x28, $x32);var $x26 = $V2$normalize$($x27);var $x0 = $V2$round$($x26); break; } } break; } }return $x0; }
const $UG$Collision$calculate_collision_normal = _$0 => _$1 => $UG$Collision$calculate_collision_normal$(_$0,_$1)

function $UG$Shape$get_center$(_$0/*:UG/Shape*/) {var $x1 = _$0;switch ($x1.$) { case "Circle": { var $x0 = $x1.center; break; } case "Polygon": { var $x0 = $x1.center; break; } }return $x0; }
const $UG$Shape$get_center = _$0 => $UG$Shape$get_center$(_$0)

function $V2$add$(_$0/*:V2*/,_$1/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = ({$: "V2"});var $x4 = $x1.x;var $x5 = $x2.x;var $x3 = $F64$add$($x4, $x5);$x0.x = $x3;var $x7 = $x1.y;var $x8 = $x2.y;var $x6 = $F64$add$($x7, $x8);$x0.y = $x6;return $x0; }
const $V2$add = _$0 => _$1 => $V2$add$(_$0,_$1)

function $UG$Shape$move$(_$0/*:UG/Shape*/,_$1/*:V2*/) {var $x1 = _$0;switch ($x1.$) { case "Circle": { var $x0 = ({$: "Circle"});var $x4 = $x1.center;var $x5 = _$1;var $x3 = $V2$add$($x4, $x5);var $x2 = $V2$round$($x3);$x0.center = $x2;var $x6 = $x1.radius;$x0.radius = $x6; break; } case "Polygon": { var $x0 = ({$: "Polygon"});var $x9 = $x1.center;var $x10 = _$1;var $x8 = $V2$add$($x9, $x10);var $x7 = $V2$round$($x8);$x0.center = $x7;var $x11 = $x1.vertices;$x0.vertices = $x11; break; } }return $x0; }
const $UG$Shape$move = _$0 => _$1 => $UG$Shape$move$(_$0,_$1)

function $V2$sqr_dist$(_$0/*:V2*/,_$1/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = $x2.x;var $x4 = $x1.x;var $dx$0 = $F64$sub$($x3, $x4);var $x5 = $x2.y;var $x6 = $x1.y;var $dy$1 = $F64$sub$($x5, $x6);var $x7 = $dx$0;var $x8 = $dx$0;var $dx2$2 = $F64$mul$($x7, $x8);var $x9 = $dy$1;var $x10 = $dy$1;var $dy2$3 = $F64$mul$($x9, $x10);var $x11 = $dx2$2;var $x12 = $dy2$3;var $x0 = $F64$add$($x11, $x12);return $x0; }
const $V2$sqr_dist = _$0 => _$1 => $V2$sqr_dist$(_$0,_$1)

function $V2$dist$(_$0/*:V2*/,_$1/*:V2*/) {var $x2 = _$0;var $x3 = _$1;var $x1 = $V2$sqr_dist$($x2, $x3);var $x0 = $F64$sqrt$($x1);return $x0; }
const $V2$dist = _$0 => _$1 => $V2$dist$(_$0,_$1)

function $V2$x$(_$0/*:V2*/) {var $x1 = _$0;var $x0 = $x1.x;return $x0; }
const $V2$x = _$0 => $V2$x$(_$0)

function $V2$y$(_$0/*:V2*/) {var $x1 = _$0;var $x0 = $x1.y;return $x0; }
const $V2$y = _$0 => $V2$y$(_$0)

function $is_right_side$(_$0/*:V2*/,_$1/*:V2*/,_$2/*:V2*/) {var $x4 = _$1;var $x3 = $V2$y$($x4);var $x6 = _$0;var $x5 = $V2$y$($x6);var $x2 = $F64$gt$($x3, $x5);var $x9 = _$2;var $x8 = $V2$y$($x9);var $x11 = _$0;var $x10 = $V2$y$($x11);var $x7 = $F64$gt$($x8, $x10);var $x1 = $Bool$and$($x2, $x7);switch ($x1.$) { case "True": { var $x0 = ({$: "False"}); break; } case "False": { var $x13 = _$2;var $x12 = $V2$x$($x13);var $x15 = _$1;var $x14 = $V2$x$($x15);var $dx$0 = $F64$sub$($x12, $x14);var $x17 = _$2;var $x16 = $V2$y$($x17);var $x19 = _$1;var $x18 = $V2$y$($x19);var $dy$1 = $F64$sub$($x16, $x18);var $x24 = _$0;var $x23 = $V2$y$($x24);var $x26 = _$1;var $x25 = $V2$y$($x26);var $x22 = $F64$sub$($x23, $x25);var $x27 = $dy$1;var $x20 = $F64$div$($x22, $x27);var $x21 = 0.0;var $t$2 = (Math.round($x20 * Math.pow(10, 2)) / Math.pow(10, 2));var $x31 = _$1;var $x30 = $V2$x$($x31);var $x33 = $t$2;var $x34 = $dx$0;var $x32 = $F64$mul$($x33, $x34);var $x28 = $F64$add$($x30, $x32);var $x29 = 0.0;var $intersect_x$3 = (Math.round($x28 * Math.pow(10, 2)) / Math.pow(10, 2));var $x36 = _$0;var $x35 = $V2$x$($x36);var $x37 = $intersect_x$3;var $x0 = $F64$lt$($x35, $x37); break; } }return $x0; }
const $is_right_side = _$0 => _$1 => _$2 => $is_right_side$(_$0,_$1,_$2)

function $process_edge$(_$0/*:V2*/,_$1/*:Bool*/,_$2/*:Pair<V2><V2>*/) {var $x1 = _$2;var $x3 = _$0;var $x4 = $x1.fst;var $x5 = $x1.snd;var $x2 = $is_right_side$($x3, $x4, $x5);switch ($x2.$) { case "True": { var $x6 = _$1;var $x0 = $Bool$not$($x6); break; } case "False": { var $x0 = _$1; break; } }return $x0; }
const $process_edge = _$0 => _$1 => _$2 => $process_edge$(_$0,_$1,_$2)

function $point_in_polygon$go$(_$0/*:V2*/,_$1/*:Bool*/,_$2/*:List<V2>*/) {while(1){var $x1 = _$2;switch ($x1.$) { case "Cons": { var $x2 = $x1.tail;switch ($x2.$) { case "Cons": { var $x3 = _$0;var $x5 = _$0;var $x6 = _$1;var $x7 = ({$: "Pair"});var $x8 = $x1.head;$x7.fst = $x8;var $x9 = $x2.head;$x7.snd = $x9;var $x4 = $process_edge$($x5, $x6, $x7);var $x10 = ({$: "Cons"});var $x11 = $x2.head;$x10.head = $x11;var $x12 = $x2.tail;$x10.tail = $x12;_$0 = $x3;_$1 = $x4;_$2 = $x10;/*TCO*/continue; break; } case "Nil": { var $x0 = _$1; break; } } break; } case "Nil": { var $x0 = _$1; break; } }return $x0; }}
const $point_in_polygon$go = _$0 => _$1 => _$2 => $point_in_polygon$go$(_$0,_$1,_$2)

function $UG$Shape$point_in_polygon$(_$0/*:V2*/,_$1/*:List<V2>*/) {var $x1 = _$1;switch ($x1.$) { case "Cons": { var $x2 = _$0;var $x3 = ({$: "False"});var $x5 = $V2;var $x6 = ({$: "Cons"});var $x7 = $x1.head;$x6.head = $x7;var $x8 = $x1.tail;$x6.tail = $x8;var $x9 = ({$: "Cons"});var $x10 = $x1.head;$x9.head = $x10;var $x11 = ({$: "Nil"});$x9.tail = $x11;var $x4 = $List$append$($x5, $x6, $x9);var $x0 = $point_in_polygon$go$($x2, $x3, $x4); break; } case "Nil": { var $x0 = ({$: "False"}); break; } }return $x0; }
const $UG$Shape$point_in_polygon = _$0 => _$1 => $UG$Shape$point_in_polygon$(_$0,_$1)

function $UG$Shape$any_vertex_inside$(_$0/*:List<V2>*/,_$1/*:List<V2>*/) {var $x1 = _$0;switch ($x1.$) { case "Cons": { var $x3 = $x1.head;var $x4 = _$1;var $x2 = $UG$Shape$point_in_polygon$($x3, $x4);var $x6 = $x1.tail;var $x7 = _$1;var $x5 = $UG$Shape$any_vertex_inside$($x6, $x7);var $x0 = $Bool$or$($x2, $x5); break; } case "Nil": { var $x0 = ({$: "False"}); break; } }return $x0; }
const $UG$Shape$any_vertex_inside = _$0 => _$1 => $UG$Shape$any_vertex_inside$(_$0,_$1)

function $UG$Shape$line_line_intersection$(_$0/*:V2*/,_$1/*:V2*/,_$2/*:V2*/,_$3/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x4 = _$3;var $x5 = $x2.x;var $x6 = $x1.x;var $dx1$0 = $F64$sub$($x5, $x6);var $x7 = $x2.y;var $x8 = $x1.y;var $dy1$1 = $F64$sub$($x7, $x8);var $x9 = $x4.x;var $x10 = $x3.x;var $dx2$2 = $F64$sub$($x9, $x10);var $x11 = $x4.y;var $x12 = $x3.y;var $dy2$3 = $F64$sub$($x11, $x12);var $x16 = $dx1$0;var $x17 = $dy2$3;var $x15 = $F64$mul$($x16, $x17);var $x19 = $dx2$2;var $x20 = $dy1$1;var $x18 = $F64$mul$($x19, $x20);var $x13 = $F64$sub$($x15, $x18);var $x14 = 0.0;var $det$4 = (Math.round($x13 * Math.pow(10, 2)) / Math.pow(10, 2));var $x22 = $det$4;var $x23 = 0.0;var $x21 = $F64$eq$($x22, $x23);switch ($x21.$) { case "True": { var $x0 = ({$: "False"}); break; } case "False": { var $x24 = $x3.x;var $x25 = $x1.x;var $dx3$5 = $F64$sub$($x24, $x25);var $x26 = $x3.y;var $x27 = $x1.y;var $dy3$6 = $F64$sub$($x26, $x27);var $x32 = $dy2$3;var $x33 = $dx3$5;var $x31 = $F64$mul$($x32, $x33);var $x36 = $x3.x;var $x37 = $x4.x;var $x35 = $F64$sub$($x36, $x37);var $x38 = $dy3$6;var $x34 = $F64$mul$($x35, $x38);var $x30 = $F64$add$($x31, $x34);var $x39 = $det$4;var $x28 = $F64$div$($x30, $x39);var $x29 = 0.0;var $lambda$7 = (Math.round($x28 * Math.pow(10, 2)) / Math.pow(10, 2));var $x44 = $dy1$1;var $x45 = $dx3$5;var $x43 = $F64$mul$($x44, $x45);var $x48 = $x1.x;var $x49 = $x2.x;var $x47 = $F64$sub$($x48, $x49);var $x50 = $dy3$6;var $x46 = $F64$mul$($x47, $x50);var $x42 = $F64$add$($x43, $x46);var $x51 = $det$4;var $x40 = $F64$div$($x42, $x51);var $x41 = 0.0;var $gamma$8 = (Math.round($x40 * Math.pow(10, 2)) / Math.pow(10, 2));var $x53 = $lambda$7;var $x54 = 0.0;var $x52 = $F64$gte$($x53, $x54);var $x56 = $lambda$7;var $x57 = 1.0;var $x55 = $F64$lte$($x56, $x57);var $valid_lambda$9 = $Bool$and$($x52, $x55);var $x59 = $gamma$8;var $x60 = 0.0;var $x58 = $F64$gte$($x59, $x60);var $x62 = $gamma$8;var $x63 = 1.0;var $x61 = $F64$lte$($x62, $x63);var $valid_gamma$10 = $Bool$and$($x58, $x61);var $x64 = $valid_lambda$9;var $x65 = $valid_gamma$10;var $x0 = $Bool$and$($x64, $x65); break; } }return $x0; }
const $UG$Shape$line_line_intersection = _$0 => _$1 => _$2 => _$3 => $UG$Shape$line_line_intersection$(_$0,_$1,_$2,_$3)

function $UG$Shape$check_against_all$(_$0/*:V2*/,_$1/*:V2*/,_$2/*:List<V2>*/,_$3/*:List<V2>*/) {var $x1 = _$2;switch ($x1.$) { case "Cons": { var $x2 = $x1.tail;switch ($x2.$) { case "Cons": { var $x4 = _$0;var $x5 = _$1;var $x6 = $x1.head;var $x7 = $x2.head;var $x3 = $UG$Shape$line_line_intersection$($x4, $x5, $x6, $x7);var $x9 = _$0;var $x10 = _$1;var $x11 = ({$: "Cons"});var $x12 = $x2.head;$x11.head = $x12;var $x13 = $x2.tail;$x11.tail = $x13;var $x14 = _$3;var $x8 = $UG$Shape$check_against_all$($x9, $x10, $x11, $x14);var $x0 = $Bool$or$($x3, $x8); break; } case "Nil": { var $x0 = ({$: "False"}); break; } } break; } case "Nil": { var $x0 = ({$: "False"}); break; } }return $x0; }
const $UG$Shape$check_against_all = _$0 => _$1 => _$2 => _$3 => $UG$Shape$check_against_all$(_$0,_$1,_$2,_$3)

function $UG$Shape$any_edges_intersect$(_$0/*:List<V2>*/,_$1/*:List<V2>*/) {var $x1 = _$0;switch ($x1.$) { case "Cons": { var $x2 = $x1.tail;switch ($x2.$) { case "Cons": { var $x4 = $x1.head;var $x5 = $x2.head;var $x6 = _$1;var $x7 = _$1;var $x3 = $UG$Shape$check_against_all$($x4, $x5, $x6, $x7);var $x9 = ({$: "Cons"});var $x10 = $x2.head;$x9.head = $x10;var $x11 = $x2.tail;$x9.tail = $x11;var $x12 = _$1;var $x8 = $UG$Shape$any_edges_intersect$($x9, $x12);var $x0 = $Bool$or$($x3, $x8); break; } case "Nil": { var $x0 = ({$: "False"}); break; } } break; } case "Nil": { var $x0 = ({$: "False"}); break; } }return $x0; }
const $UG$Shape$any_edges_intersect = _$0 => _$1 => $UG$Shape$any_edges_intersect$(_$0,_$1)

function $UG$Shape$collide$(_$0/*:UG/Shape*/,_$1/*:UG/Shape*/) {var $x1 = _$0;switch ($x1.$) { case "Circle": { var $x2 = _$1;switch ($x2.$) { case "Circle": { var $x5 = $x1.center;var $x6 = $x2.center;var $x3 = $V2$dist$($x5, $x6);var $x4 = 0.0;var $center_dist$0 = (Math.round($x3 * Math.pow(10, 2)) / Math.pow(10, 2));var $x9 = $x1.radius;var $x10 = $x2.radius;var $x7 = $F64$add$($x9, $x10);var $x8 = 0.0;var $rsum$1 = (Math.round($x7 * Math.pow(10, 2)) / Math.pow(10, 2));var $x11 = $center_dist$0;var $x12 = $rsum$1;var $x0 = $F64$lte$($x11, $x12); break; } case "Polygon": { var $x13 = $x1.center;var $x15 = ({$: "Polygon"});var $x16 = $x2.center;$x15.center = $x16;var $x17 = $x2.vertices;$x15.vertices = $x17;var $x14 = $UG$Shape$abs_vertices$($x15);var $closest$0 = $UG$Shape$closest_point_on_polygon$($x13, $x14);var $x20 = $x1.center;var $x21 = $closest$0;var $x18 = $V2$dist$($x20, $x21);var $x19 = 0.0;var $dst$1 = (Math.round($x18 * Math.pow(10, 2)) / Math.pow(10, 2));var $x22 = $dst$1;var $x23 = $x1.radius;var $x0 = $F64$lte$($x22, $x23); break; } } break; } case "Polygon": { var $x24 = _$1;switch ($x24.$) { case "Circle": { var $x25 = $x24.center;var $x27 = ({$: "Polygon"});var $x28 = $x1.center;$x27.center = $x28;var $x29 = $x1.vertices;$x27.vertices = $x29;var $x26 = $UG$Shape$abs_vertices$($x27);var $closest$0 = $UG$Shape$closest_point_on_polygon$($x25, $x26);var $x32 = $x24.center;var $x33 = $closest$0;var $x30 = $V2$dist$($x32, $x33);var $x31 = 0.0;var $dst$1 = (Math.round($x30 * Math.pow(10, 2)) / Math.pow(10, 2));var $x34 = $dst$1;var $x35 = $x24.radius;var $x0 = $F64$lte$($x34, $x35); break; } case "Polygon": { var $x36 = ({$: "Polygon"});var $x37 = $x24.center;$x36.center = $x37;var $x38 = $x24.vertices;$x36.vertices = $x38;var $abs_p1$0 = $UG$Shape$abs_vertices$($x36);var $x39 = ({$: "Polygon"});var $x40 = $x1.center;$x39.center = $x40;var $x41 = $x1.vertices;$x39.vertices = $x41;var $abs_p2$1 = $UG$Shape$abs_vertices$($x39);var $x42 = $abs_p1$0;var $x43 = $abs_p2$1;var $p1_in_p2$2 = $UG$Shape$any_vertex_inside$($x42, $x43);var $x44 = $abs_p2$1;var $x45 = $abs_p1$0;var $p2_in_p1$3 = $UG$Shape$any_vertex_inside$($x44, $x45);var $x46 = $abs_p1$0;var $x47 = $abs_p2$1;var $edges_intersect$4 = $UG$Shape$any_edges_intersect$($x46, $x47);var $x49 = $p1_in_p2$2;var $x50 = $p2_in_p1$3;var $x48 = $Bool$or$($x49, $x50);var $x51 = $edges_intersect$4;var $x0 = $Bool$or$($x48, $x51); break; } } break; } }return $x0; }
const $UG$Shape$collide = _$0 => _$1 => $UG$Shape$collide$(_$0,_$1)

const $UG$SIPD$Side$ = (() => {var $x0 = /*{$:'Red'} | {$:'Blue'} | {$:'Neutral'}*/null;return $x0; })()
const $UG$SIPD$Side = $UG$SIPD$Side$

const $UG$SIPD$Effect$ = (() => {var $x0 = /*($_$0:UG/SIPD/State) => UG/SIPD/State*/null;return $x0; })()
const $UG$SIPD$Effect = $UG$SIPD$Effect$

const $UG$SIPD$Skill$ = (() => {var $x0 = /*{$:'Skill', name: String, effects: List<UG/SIPD/Effect>, cooldown: BigInt}*/null;return $x0; })()
const $UG$SIPD$Skill = $UG$SIPD$Skill$

const $UG$SIPD$Hero$ = (() => {var $x0 = /*{$:'Hero', owner_id: BigInt, name: String, skills: OrdTree<String><UG/SIPD/Skill>, body_id: BigInt}*/null;return $x0; })()
const $UG$SIPD$Hero = $UG$SIPD$Hero$

const $UG$SIPD$Player$ = (() => {var $x0 = /*{$:'Player', id: BigInt, name: String, keys: OrdTree<String><Pair<Bool><V2>>, target: V2, hero: UG/SIPD/Hero}*/null;return $x0; })()
const $UG$SIPD$Player = $UG$SIPD$Player$

const $UG$SIPD$Hero$HeroState$ = (() => {var $x0 = /*{$:'HeroState', cooldowns: OrdTree<String><BigInt>, health: BigInt}*/null;return $x0; })()
const $UG$SIPD$Hero$HeroState = $UG$SIPD$Hero$HeroState$

const $UG$SIPD$GameMap$ = (() => {var $x0 = /*{$:'GameMap', width: BigInt, height: BigInt, bodies: Map<BigInt, Maybe<UG/SIPD/Body>>, bodies_count: BigInt}*/null;return $x0; })()
const $UG$SIPD$GameMap = $UG$SIPD$GameMap$

const $UG$SIPD$State$ = (() => {var $x0 = /*{$:'State', next_id: BigInt, tick: BigInt, players: Map<BigInt, Maybe<UG/SIPD/Player>>, hero_states: Map<BigInt, Maybe<UG/SIPD/Hero/HeroState>>, game_map: UG/SIPD/GameMap}*/null;return $x0; })()
const $UG$SIPD$State = $UG$SIPD$State$

const $UG$SIPD$Body$ = (() => {var $x0 = /*{$:'Body', id: BigInt, hitbox: UG/Shape, tick: ($_$0:UG/SIPD/State) => UG/SIPD/State, effects: List<UG/SIPD/Effect>, collidable: UG/Collision/Collidable, side: UG/SIPD/Side}*/null;return $x0; })()
const $UG$SIPD$Body = $UG$SIPD$Body$

function $UG$SIPD$Body$find_collision$go$(_$0/*:BigInt*/,_$1/*:UG/SIPD/Body*/,_$2/*:List<UG/SIPD/Body>*/) {var $x1 = _$1;var $x2 = _$2;switch ($x2.$) { case "Cons": { var $x3 = $x2.head;var $x0 = ($acc$0 => {var $x5 = ({$: "Pair"});var $x6 = $x1.side;$x5.fst = $x6;var $x7 = $x3.side;$x5.snd = $x7;var $x8 = $x5.fst;switch ($x8.$) { case "Blue": { var $x9 = $x5.snd;switch ($x9.$) { case "Blue": { var $x11 = _$0;var $x12 = ({$: "Body"});var $x13 = $x1.id;$x12.id = $x13;var $x14 = $x1.hitbox;$x12.hitbox = $x14;var $x15 = $x1.tick;$x12.tick = $x15;var $x16 = $x1.effects;$x12.effects = $x16;var $x17 = $x1.collidable;$x12.collidable = $x17;var $x18 = $x1.side;$x12.side = $x18;var $x19 = $x2.tail;var $x10 = $UG$SIPD$Body$find_collision$go$($x11, $x12, $x19);var $x20 = $acc$0;var $x4 = ($x10)($x20); break; } default: { var $x21 = $x1.id;var $x22 = $x3.id;var $diff_ids$1 = $U64$neq$($x21, $x22);var $x23 = $x3.id;var $x24 = _$0;var $diff_ig$2 = $U64$neq$($x23, $x24);var $x25 = $x1.hitbox;var $x26 = $x3.hitbox;var $collides$3 = $UG$Shape$collide$($x25, $x26);var $x29 = $diff_ids$1;var $x30 = $diff_ig$2;var $x28 = $Bool$and$($x29, $x30);var $x31 = $collides$3;var $x27 = $Bool$and$($x28, $x31);switch ($x27.$) { case "True": { var $x33 = $x1.hitbox;var $x34 = $x3.hitbox;var $x32 = $UG$Collision$calculate_collision_normal$($x33, $x34);var $col_normal$4 = $V2$round$($x32);var $x36 = _$0;var $x37 = ({$: "Body"});var $x38 = $x1.id;$x37.id = $x38;var $x39 = $x1.hitbox;$x37.hitbox = $x39;var $x40 = $x1.tick;$x37.tick = $x40;var $x41 = $x1.effects;$x37.effects = $x41;var $x42 = $x1.collidable;$x37.collidable = $x42;var $x43 = $x1.side;$x37.side = $x43;var $x44 = $x2.tail;var $x35 = $UG$SIPD$Body$find_collision$go$($x36, $x37, $x44);var $x45 = ({$: "Cons"});var $x46 = ({$: "Pair"});var $x47 = $col_normal$4;$x46.fst = $x47;var $x48 = ({$: "Body"});var $x49 = $x3.id;$x48.id = $x49;var $x50 = $x3.hitbox;$x48.hitbox = $x50;var $x51 = $x3.tick;$x48.tick = $x51;var $x52 = $x3.effects;$x48.effects = $x52;var $x53 = $x3.collidable;$x48.collidable = $x53;var $x54 = $x3.side;$x48.side = $x54;$x46.snd = $x48;$x45.head = $x46;var $x55 = $acc$0;$x45.tail = $x55;var $x4 = ($x35)($x45); break; } case "False": { var $x57 = _$0;var $x58 = ({$: "Body"});var $x59 = $x1.id;$x58.id = $x59;var $x60 = $x1.hitbox;$x58.hitbox = $x60;var $x61 = $x1.tick;$x58.tick = $x61;var $x62 = $x1.effects;$x58.effects = $x62;var $x63 = $x1.collidable;$x58.collidable = $x63;var $x64 = $x1.side;$x58.side = $x64;var $x65 = $x2.tail;var $x56 = $UG$SIPD$Body$find_collision$go$($x57, $x58, $x65);var $x66 = $acc$0;var $x4 = ($x56)($x66); break; } } break; } } break; } case "Neutral": { var $x67 = $x5.snd;switch ($x67.$) { case "Neutral": { var $x69 = _$0;var $x70 = ({$: "Body"});var $x71 = $x1.id;$x70.id = $x71;var $x72 = $x1.hitbox;$x70.hitbox = $x72;var $x73 = $x1.tick;$x70.tick = $x73;var $x74 = $x1.effects;$x70.effects = $x74;var $x75 = $x1.collidable;$x70.collidable = $x75;var $x76 = $x1.side;$x70.side = $x76;var $x77 = $x2.tail;var $x68 = $UG$SIPD$Body$find_collision$go$($x69, $x70, $x77);var $x78 = $acc$0;var $x4 = ($x68)($x78); break; } default: { var $x79 = $x1.id;var $x80 = $x3.id;var $diff_ids$1 = $U64$neq$($x79, $x80);var $x81 = $x3.id;var $x82 = _$0;var $diff_ig$2 = $U64$neq$($x81, $x82);var $x83 = $x1.hitbox;var $x84 = $x3.hitbox;var $collides$3 = $UG$Shape$collide$($x83, $x84);var $x87 = $diff_ids$1;var $x88 = $diff_ig$2;var $x86 = $Bool$and$($x87, $x88);var $x89 = $collides$3;var $x85 = $Bool$and$($x86, $x89);switch ($x85.$) { case "True": { var $x91 = $x1.hitbox;var $x92 = $x3.hitbox;var $x90 = $UG$Collision$calculate_collision_normal$($x91, $x92);var $col_normal$4 = $V2$round$($x90);var $x94 = _$0;var $x95 = ({$: "Body"});var $x96 = $x1.id;$x95.id = $x96;var $x97 = $x1.hitbox;$x95.hitbox = $x97;var $x98 = $x1.tick;$x95.tick = $x98;var $x99 = $x1.effects;$x95.effects = $x99;var $x100 = $x1.collidable;$x95.collidable = $x100;var $x101 = $x1.side;$x95.side = $x101;var $x102 = $x2.tail;var $x93 = $UG$SIPD$Body$find_collision$go$($x94, $x95, $x102);var $x103 = ({$: "Cons"});var $x104 = ({$: "Pair"});var $x105 = $col_normal$4;$x104.fst = $x105;var $x106 = ({$: "Body"});var $x107 = $x3.id;$x106.id = $x107;var $x108 = $x3.hitbox;$x106.hitbox = $x108;var $x109 = $x3.tick;$x106.tick = $x109;var $x110 = $x3.effects;$x106.effects = $x110;var $x111 = $x3.collidable;$x106.collidable = $x111;var $x112 = $x3.side;$x106.side = $x112;$x104.snd = $x106;$x103.head = $x104;var $x113 = $acc$0;$x103.tail = $x113;var $x4 = ($x93)($x103); break; } case "False": { var $x115 = _$0;var $x116 = ({$: "Body"});var $x117 = $x1.id;$x116.id = $x117;var $x118 = $x1.hitbox;$x116.hitbox = $x118;var $x119 = $x1.tick;$x116.tick = $x119;var $x120 = $x1.effects;$x116.effects = $x120;var $x121 = $x1.collidable;$x116.collidable = $x121;var $x122 = $x1.side;$x116.side = $x122;var $x123 = $x2.tail;var $x114 = $UG$SIPD$Body$find_collision$go$($x115, $x116, $x123);var $x124 = $acc$0;var $x4 = ($x114)($x124); break; } } break; } } break; } case "Red": { var $x125 = $x5.snd;switch ($x125.$) { case "Red": { var $x127 = _$0;var $x128 = ({$: "Body"});var $x129 = $x1.id;$x128.id = $x129;var $x130 = $x1.hitbox;$x128.hitbox = $x130;var $x131 = $x1.tick;$x128.tick = $x131;var $x132 = $x1.effects;$x128.effects = $x132;var $x133 = $x1.collidable;$x128.collidable = $x133;var $x134 = $x1.side;$x128.side = $x134;var $x135 = $x2.tail;var $x126 = $UG$SIPD$Body$find_collision$go$($x127, $x128, $x135);var $x136 = $acc$0;var $x4 = ($x126)($x136); break; } default: { var $x137 = $x1.id;var $x138 = $x3.id;var $diff_ids$1 = $U64$neq$($x137, $x138);var $x139 = $x3.id;var $x140 = _$0;var $diff_ig$2 = $U64$neq$($x139, $x140);var $x141 = $x1.hitbox;var $x142 = $x3.hitbox;var $collides$3 = $UG$Shape$collide$($x141, $x142);var $x145 = $diff_ids$1;var $x146 = $diff_ig$2;var $x144 = $Bool$and$($x145, $x146);var $x147 = $collides$3;var $x143 = $Bool$and$($x144, $x147);switch ($x143.$) { case "True": { var $x149 = $x1.hitbox;var $x150 = $x3.hitbox;var $x148 = $UG$Collision$calculate_collision_normal$($x149, $x150);var $col_normal$4 = $V2$round$($x148);var $x152 = _$0;var $x153 = ({$: "Body"});var $x154 = $x1.id;$x153.id = $x154;var $x155 = $x1.hitbox;$x153.hitbox = $x155;var $x156 = $x1.tick;$x153.tick = $x156;var $x157 = $x1.effects;$x153.effects = $x157;var $x158 = $x1.collidable;$x153.collidable = $x158;var $x159 = $x1.side;$x153.side = $x159;var $x160 = $x2.tail;var $x151 = $UG$SIPD$Body$find_collision$go$($x152, $x153, $x160);var $x161 = ({$: "Cons"});var $x162 = ({$: "Pair"});var $x163 = $col_normal$4;$x162.fst = $x163;var $x164 = ({$: "Body"});var $x165 = $x3.id;$x164.id = $x165;var $x166 = $x3.hitbox;$x164.hitbox = $x166;var $x167 = $x3.tick;$x164.tick = $x167;var $x168 = $x3.effects;$x164.effects = $x168;var $x169 = $x3.collidable;$x164.collidable = $x169;var $x170 = $x3.side;$x164.side = $x170;$x162.snd = $x164;$x161.head = $x162;var $x171 = $acc$0;$x161.tail = $x171;var $x4 = ($x151)($x161); break; } case "False": { var $x173 = _$0;var $x174 = ({$: "Body"});var $x175 = $x1.id;$x174.id = $x175;var $x176 = $x1.hitbox;$x174.hitbox = $x176;var $x177 = $x1.tick;$x174.tick = $x177;var $x178 = $x1.effects;$x174.effects = $x178;var $x179 = $x1.collidable;$x174.collidable = $x179;var $x180 = $x1.side;$x174.side = $x180;var $x181 = $x2.tail;var $x172 = $UG$SIPD$Body$find_collision$go$($x173, $x174, $x181);var $x182 = $acc$0;var $x4 = ($x172)($x182); break; } } break; } } break; } default: { var $x184 = /*Type*/null;var $x185 = $x8;var $x183 = ($x184)($x185);var $x186 = $x5.snd;var $x4 = ($x183)($x186); break; } }return $x4;}); break; } case "Nil": { var $x0 = ($acc$0 => {var $x187 = $acc$0;return $x187;}); break; } }return $x0; }
const $UG$SIPD$Body$find_collision$go = _$0 => _$1 => _$2 => $UG$SIPD$Body$find_collision$go$(_$0,_$1,_$2)

function $UG$SIPD$Body$find_collision$(_$0/*:BigInt*/,_$1/*:UG/SIPD/Body*/,_$2/*:List<UG/SIPD/Body>*/) {var $x2 = _$0;var $x3 = _$1;var $x4 = _$2;var $x1 = $UG$SIPD$Body$find_collision$go$($x2, $x3, $x4);var $x5 = ({$: "Nil"});var $x0 = ($x1)($x5);return $x0; }
const $UG$SIPD$Body$find_collision = _$0 => _$1 => _$2 => $UG$SIPD$Body$find_collision$(_$0,_$1,_$2)

function $V2$mul_scalar$(_$0/*:V2*/,_$1/*:Number*/) {var $x1 = _$0;var $x0 = ({$: "V2"});var $x3 = $x1.x;var $x4 = _$1;var $x2 = $F64$mul$($x3, $x4);$x0.x = $x2;var $x6 = $x1.y;var $x7 = _$1;var $x5 = $F64$mul$($x6, $x7);$x0.y = $x5;return $x0; }
const $V2$mul_scalar = _$0 => _$1 => $V2$mul_scalar$(_$0,_$1)

function $collide_and_slide$handle_collidable$(_$0/*:UG/SIPD/Body*/,_$1/*:UG/Collision/Collidable*/,_$2/*:V2*/,_$3/*:V2*/,_$4/*:V2*/,_$5/*:List<UG/SIPD/Body>*/,_$6/*:Nat*/) {var $x1 = _$0;var $x2 = ({$: "Pair"});var $x3 = $x1.collidable;$x2.fst = $x3;var $x4 = _$1;$x2.snd = $x4;var $x5 = $x2.fst;switch ($x5.$) { case "Untouchable": { var $x6 = $x2.snd;switch ($x6.$) { case "Untouchable": { var $x0 = ({$: "Pair"});var $x8 = _$2;var $x9 = _$4;var $x7 = $V2$add$($x8, $x9);$x0.fst = $x7;var $x10 = _$3;$x0.snd = $x10; break; } default: { var $x0 = ({$: "Pair"});var $x12 = _$2;var $x13 = _$4;var $x11 = $V2$add$($x12, $x13);$x0.fst = $x11;var $x14 = _$3;$x0.snd = $x14; break; } } break; } default: { var $x15 = $x2.snd;switch ($x15.$) { case "Untouchable": { var $x0 = ({$: "Pair"});var $x17 = _$2;var $x18 = _$4;var $x16 = $V2$add$($x17, $x18);$x0.fst = $x16;var $x19 = _$3;$x0.snd = $x19; break; } default: { var $x20 = _$2;var $x21 = _$4;var $new_position$0 = $V2$add$($x20, $x21);var $x22 = $x1.hitbox;var $x24 = $new_position$0;var $x25 = _$2;var $x23 = $V2$sub$($x24, $x25);var $new_hitbox$1 = $UG$Shape$move$($x22, $x23);var $x26 = _$3;var $slide_plane$2 = $V2$normalize$($x26);var $x27 = _$4;var $x29 = $slide_plane$2;var $x31 = _$4;var $x32 = $slide_plane$2;var $x30 = $V2$dot$($x31, $x32);var $x28 = $V2$mul_scalar$($x29, $x30);var $slide_movement$3 = $V2$sub$($x27, $x28);var $x33 = ({$: "Body"});var $x34 = $x1.id;$x33.id = $x34;var $x35 = $new_hitbox$1;$x33.hitbox = $x35;var $x36 = $x1.tick;$x33.tick = $x36;var $x37 = $x1.effects;$x33.effects = $x37;var $x38 = $x1.collidable;$x33.collidable = $x38;var $x39 = $x1.side;$x33.side = $x39;var $x40 = _$2;var $x41 = $slide_movement$3;var $x42 = _$5;var $x43 = _$6;var $x0 = $collide_and_slide$go$($x33, $x40, $x41, $x42, $x43); break; } } break; } }return $x0; }
const $collide_and_slide$handle_collidable = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => _$6 => $collide_and_slide$handle_collidable$(_$0,_$1,_$2,_$3,_$4,_$5,_$6)

function $collide_and_slide$handle_collisions$(_$0/*:UG/SIPD/Body*/) {var $x1 = _$0;switch ($x1.$) { case "Body": { var $x0 = ($position$0 => $remaining_movement$1 => $obstacles$2 => $n$3 => $__10$4 => {var $x3 = $__10$4;switch ($x3.$) { case "Cons": { var $x4 = $x3.head;var $got$5 = $x4.snd;var $x5 = $got$5;var $x6 = ({$: "Body"});var $x7 = $x1.id;$x6.id = $x7;var $x8 = $x1.hitbox;$x6.hitbox = $x8;var $x9 = $x1.tick;$x6.tick = $x9;var $x10 = $x1.effects;$x6.effects = $x10;var $x11 = $x1.collidable;$x6.collidable = $x11;var $x12 = $x1.side;$x6.side = $x12;var $x13 = $x5.collidable;var $x14 = $position$0;var $x15 = $x4.fst;var $x16 = $remaining_movement$1;var $x17 = $obstacles$2;var $x18 = $n$3;var $got$6 = $collide_and_slide$handle_collidable$($x6, $x13, $x14, $x15, $x16, $x17, $x18);var $x19 = $got$6;var $x25 = ({$: "Body"});var $x26 = $x1.id;$x25.id = $x26;var $x27 = $x1.hitbox;$x25.hitbox = $x27;var $x28 = $x1.tick;$x25.tick = $x28;var $x29 = $x1.effects;$x25.effects = $x29;var $x30 = $x1.collidable;$x25.collidable = $x30;var $x31 = $x1.side;$x25.side = $x31;var $x24 = $collide_and_slide$handle_collisions$($x25);var $x32 = $x19.fst;var $x23 = ($x24)($x32);var $x33 = $x19.snd;var $x22 = ($x23)($x33);var $x34 = $obstacles$2;var $x21 = ($x22)($x34);var $x35 = $n$3;var $x20 = ($x21)($x35);var $x36 = $x3.tail;var $x2 = ($x20)($x36); break; } case "Nil": { var $x2 = ({$: "Pair"});var $x37 = $position$0;$x2.fst = $x37;var $x38 = $remaining_movement$1;$x2.snd = $x38; break; } }return $x2;}); break; } default: { var $x39 = /*Type*/null;var $x40 = $x1;var $x0 = ($x39)($x40); break; } }return $x0; }
const $collide_and_slide$handle_collisions = _$0 => $collide_and_slide$handle_collisions$(_$0)

function $collide_and_slide$go$(_$0/*:UG/SIPD/Body*/,_$1/*:V2*/,_$2/*:V2*/,_$3/*:List<UG/SIPD/Body>*/,_$4/*:Nat*/) {var $x1 = _$0;var $x2 = _$4;switch ($x2.$) { case "Succ": { var $x3 = _$1;var $x4 = _$2;var $new_position$0 = $V2$add$($x3, $x4);var $x5 = $x1.hitbox;var $x7 = $new_position$0;var $x8 = _$1;var $x6 = $V2$sub$($x7, $x8);var $new_hitbox$1 = $UG$Shape$move$($x5, $x6);var $x9 = $x1.id;var $x10 = ({$: "Body"});var $x11 = $x1.id;$x10.id = $x11;var $x12 = $new_hitbox$1;$x10.hitbox = $x12;var $x13 = $x1.tick;$x10.tick = $x13;var $x14 = $x1.effects;$x10.effects = $x14;var $x15 = $x1.collidable;$x10.collidable = $x15;var $x16 = $x1.side;$x10.side = $x16;var $x17 = _$3;var $collisions$2 = $UG$SIPD$Body$find_collision$($x9, $x10, $x17);var $x18 = $collisions$2;switch ($x18.$) { case "Nil": { var $x0 = ({$: "Pair"});var $x19 = $new_position$0;$x0.fst = $x19;var $x20 = ({$: "V2"});var $x21 = 0.0;$x20.x = $x21;var $x22 = 0.0;$x20.y = $x22;$x0.snd = $x20; break; } default: { var $x28 = ({$: "Body"});var $x29 = $x1.id;$x28.id = $x29;var $x30 = $x1.hitbox;$x28.hitbox = $x30;var $x31 = $x1.tick;$x28.tick = $x31;var $x32 = $x1.effects;$x28.effects = $x32;var $x33 = $x1.collidable;$x28.collidable = $x33;var $x34 = $x1.side;$x28.side = $x34;var $x27 = $collide_and_slide$handle_collisions$($x28);var $x35 = _$1;var $x26 = ($x27)($x35);var $x36 = _$2;var $x25 = ($x26)($x36);var $x37 = _$3;var $x24 = ($x25)($x37);var $x38 = $x2.pred;var $x23 = ($x24)($x38);var $x39 = $collisions$2;var $x0 = ($x23)($x39); break; } } break; } case "Zero": { var $x0 = ({$: "Pair"});var $x40 = _$1;$x0.fst = $x40;var $x41 = _$2;$x0.snd = $x41; break; } }return $x0; }
const $collide_and_slide$go = _$0 => _$1 => _$2 => _$3 => _$4 => $collide_and_slide$go$(_$0,_$1,_$2,_$3,_$4)

function $UG$Collision$collide_and_slide$(_$0/*:UG/SIPD/Body*/,_$1/*:V2*/,_$2/*:List<UG/SIPD/Body>*/) {var $x1 = _$0;var $x2 = $x1.hitbox;var $initial_position$0 = $UG$Shape$get_center$($x2);var $x3 = ({$: "Body"});var $x4 = $x1.id;$x3.id = $x4;var $x5 = $x1.hitbox;$x3.hitbox = $x5;var $x6 = $x1.tick;$x3.tick = $x6;var $x7 = $x1.effects;$x3.effects = $x7;var $x8 = $x1.collidable;$x3.collidable = $x8;var $x9 = $x1.side;$x3.side = $x9;var $x10 = $initial_position$0;var $x11 = _$1;var $x12 = _$2;var $x13 = ({$: "Succ"});var $x14 = ({$: "Succ"});var $x15 = ({$: "Succ"});var $x16 = ({$: "Zero"});$x15.pred = $x16;$x14.pred = $x15;$x13.pred = $x14;var $x0 = $collide_and_slide$go$($x3, $x10, $x11, $x12, $x13);return $x0; }
const $UG$Collision$collide_and_slide = _$0 => _$1 => _$2 => $UG$Collision$collide_and_slide$(_$0,_$1,_$2)

const $UG$SIPD$Action$ = (() => {var $x0 = /*{$:'SetNick', time: BigInt, pid: BigInt, side: UG/SIPD/Side, nick: String}*/null;return $x0; })()
const $UG$SIPD$Action = $UG$SIPD$Action$

function $UG$SIPD$Side$eq$(_$0/*:UG/SIPD/Side*/) {var $x1 = _$0;switch ($x1.$) { case "Blue": { var $x0 = ($__0$0 => {var $x3 = $__0$0;switch ($x3.$) { case "Blue": { var $x2 = ({$: "True"}); break; } default: { var $x2 = ({$: "False"}); break; } }return $x2;}); break; } case "Neutral": { var $x0 = ($__0$0 => {var $x5 = $__0$0;switch ($x5.$) { case "Neutral": { var $x4 = ({$: "True"}); break; } default: { var $x4 = ({$: "False"}); break; } }return $x4;}); break; } case "Red": { var $x0 = ($__0$0 => {var $x7 = $__0$0;switch ($x7.$) { case "Red": { var $x6 = ({$: "True"}); break; } default: { var $x6 = ({$: "False"}); break; } }return $x6;}); break; } default: { var $x8 = /*Type*/null;var $x9 = $x1;var $x0 = ($x8)($x9); break; } }return $x0; }
const $UG$SIPD$Side$eq = _$0 => $UG$SIPD$Side$eq$(_$0)

function $UG$SIPD$Action$eq$(_$0/*:UG/SIPD/Action*/,_$1/*:UG/SIPD/Action*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = $x1.time;var $x4 = $x2.time;var $time_eq$0 = $U64$eq$($x3, $x4);var $x5 = $x1.pid;var $x6 = $x2.pid;var $pid_eq$1 = $U64$eq$($x5, $x6);var $x7 = $x1.nick;var $x8 = $x2.nick;var $nick_eq$2 = $String$eq$($x7, $x8);var $x10 = $x1.side;var $x9 = $UG$SIPD$Side$eq$($x10);var $x11 = $x2.side;var $side_eq$3 = ($x9)($x11);var $x13 = $time_eq$0;var $x14 = $side_eq$3;var $x12 = $Bool$and$($x13, $x14);var $x16 = $pid_eq$1;var $x17 = $nick_eq$2;var $x15 = $Bool$and$($x16, $x17);var $x0 = $Bool$and$($x12, $x15);return $x0; }
const $UG$SIPD$Action$eq = _$0 => _$1 => $UG$SIPD$Action$eq$(_$0,_$1)

function $UG$SIPD$Body$set_effects$(_$0/*:UG/SIPD/Body*/,_$1/*:List<UG/SIPD/Effect>*/) {var $x1 = _$0;var $x0 = ({$: "Body"});var $x2 = $x1.id;$x0.id = $x2;var $x3 = $x1.hitbox;$x0.hitbox = $x3;var $x4 = $x1.tick;$x0.tick = $x4;var $x5 = _$1;$x0.effects = $x5;var $x6 = $x1.collidable;$x0.collidable = $x6;var $x7 = $x1.side;$x0.side = $x7;return $x0; }
const $UG$SIPD$Body$set_effects = _$0 => _$1 => $UG$SIPD$Body$set_effects$(_$0,_$1)

function $UG$SIPD$Effect$apply$(_$0/*:UG/SIPD/Effect*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = ($x1)($x2);return $x0; }
const $UG$SIPD$Effect$apply = _$0 => _$1 => $UG$SIPD$Effect$apply$(_$0,_$1)

function $UG$SIPD$Body$apply_effects$go$(_$0/*:UG/SIPD/Body*/,_$1/*:UG/SIPD/State*/,_$2/*:List<UG/SIPD/Effect>*/) {while(1){var $x1 = _$2;switch ($x1.$) { case "Cons": { var $x2 = _$0;var $x3 = $x1.tail;var $updated_body$0 = $UG$SIPD$Body$set_effects$($x2, $x3);var $got$1 = $updated_body$0;var $x4 = $got$1;var $got$2 = _$1;var $x5 = $got$2;var $got$3 = $x5.game_map;var $x6 = $got$3;var $x7 = $UG$SIPD$Body;var $x8 = $x6.bodies;var $x9 = $x4.id;var $x10 = $updated_body$0;var $updated_bodies$4 = $Map$insert$($x7, $x8, $x9, $x10);var $x11 = $x1.head;var $x12 = ({$: "State"});var $x13 = $x5.next_id;$x12.next_id = $x13;var $x14 = $x5.tick;$x12.tick = $x14;var $x15 = $x5.players;$x12.players = $x15;var $x16 = $x5.hero_states;$x12.hero_states = $x16;var $x17 = ({$: "GameMap"});var $x18 = $x6.width;$x17.width = $x18;var $x19 = $x6.height;$x17.height = $x19;var $x20 = $updated_bodies$4;$x17.bodies = $x20;var $x21 = $x6.bodies_count;$x17.bodies_count = $x21;$x12.game_map = $x17;var $new_state$5 = $UG$SIPD$Effect$apply$($x11, $x12);var $x22 = $updated_body$0;var $x23 = $new_state$5;var $x24 = $x1.tail;_$0 = $x22;_$1 = $x23;_$2 = $x24;/*TCO*/continue; break; } case "Nil": { var $x0 = _$1; break; } }return $x0; }}
const $UG$SIPD$Body$apply_effects$go = _$0 => _$1 => _$2 => $UG$SIPD$Body$apply_effects$go$(_$0,_$1,_$2)

function $UG$SIPD$Body$apply_effects$(_$0/*:UG/SIPD/Body*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$0;var $x2 = ({$: "Body"});var $x3 = $x1.id;$x2.id = $x3;var $x4 = $x1.hitbox;$x2.hitbox = $x4;var $x5 = $x1.tick;$x2.tick = $x5;var $x6 = $x1.effects;$x2.effects = $x6;var $x7 = $x1.collidable;$x2.collidable = $x7;var $x8 = $x1.side;$x2.side = $x8;var $x9 = _$1;var $x10 = $x1.effects;var $x0 = $UG$SIPD$Body$apply_effects$go$($x2, $x9, $x10);return $x0; }
const $UG$SIPD$Body$apply_effects = _$0 => _$1 => $UG$SIPD$Body$apply_effects$(_$0,_$1)

function $UG$SIPD$Body$delete_body$(_$0/*:BigInt*/,_$1/*:Map<BigInt, Maybe<UG/SIPD/Body>>*/) {var $x1 = $UG$SIPD$Body;var $x2 = _$1;var $x3 = _$0;var $x0 = $Map$delete$($x1, $x2, $x3);return $x0; }
const $UG$SIPD$Body$delete_body = _$0 => _$1 => $UG$SIPD$Body$delete_body$(_$0,_$1)

function $UG$SIPD$Body$get_body$(_$0/*:BigInt*/,_$1/*:Map<BigInt, Maybe<UG/SIPD/Body>>*/) {var $x1 = $UG$SIPD$Body;var $x2 = _$1;var $x3 = _$0;var $x0 = $Map$get$($x1, $x2, $x3);return $x0; }
const $UG$SIPD$Body$get_body = _$0 => _$1 => $UG$SIPD$Body$get_body$(_$0,_$1)

function $UG$SIPD$Body$tick$(_$0/*:UG/SIPD/Body*/) {var $x1 = _$0;var $x0 = $x1.tick;return $x0; }
const $UG$SIPD$Body$tick = _$0 => $UG$SIPD$Body$tick$(_$0)

function $UG$SIPD$GameMap$delete_body$(_$0/*:UG/SIPD/GameMap*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = $x1.bodies;var $bodies$0 = $UG$SIPD$Body$delete_body$($x2, $x3);var $x0 = ({$: "GameMap"});var $x4 = $x1.width;$x0.width = $x4;var $x5 = $x1.height;$x0.height = $x5;var $x6 = $bodies$0;$x0.bodies = $x6;var $x7 = $x1.bodies_count;$x0.bodies_count = $x7;return $x0; }
const $UG$SIPD$GameMap$delete_body = _$0 => _$1 => $UG$SIPD$GameMap$delete_body$(_$0,_$1)

function $UG$SIPD$State$delete_body$(_$0/*:UG/SIPD/State*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = $x1.game_map;var $x3 = _$1;var $new_game_map$0 = $UG$SIPD$GameMap$delete_body$($x2, $x3);var $x0 = ({$: "State"});var $x4 = $x1.next_id;$x0.next_id = $x4;var $x5 = $x1.tick;$x0.tick = $x5;var $x6 = $x1.players;$x0.players = $x6;var $x7 = $x1.hero_states;$x0.hero_states = $x7;var $x8 = $new_game_map$0;$x0.game_map = $x8;return $x0; }
const $UG$SIPD$State$delete_body = _$0 => _$1 => $UG$SIPD$State$delete_body$(_$0,_$1)

function $UG$SIPD$GameMap$update_body$(_$0/*:UG/SIPD/GameMap*/,_$1/*:UG/SIPD/Body*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = $UG$SIPD$Body;var $x4 = $x1.bodies;var $x5 = $x2.id;var $x6 = ({$: "Body"});var $x7 = $x2.id;$x6.id = $x7;var $x8 = $x2.hitbox;$x6.hitbox = $x8;var $x9 = $x2.tick;$x6.tick = $x9;var $x10 = $x2.effects;$x6.effects = $x10;var $x11 = $x2.collidable;$x6.collidable = $x11;var $x12 = $x2.side;$x6.side = $x12;var $new_bodies$0 = $Map$update$($x3, $x4, $x5, $x6);var $x14 = $x2.id;var $x15 = $x1.bodies_count;var $x13 = $U64$gt$($x14, $x15);switch ($x13.$) { case "True": { var $x0 = ({$: "GameMap"});var $x16 = $x1.width;$x0.width = $x16;var $x17 = $x1.height;$x0.height = $x17;var $x18 = $new_bodies$0;$x0.bodies = $x18;var $x19 = $x2.id;$x0.bodies_count = $x19; break; } case "False": { var $x0 = ({$: "GameMap"});var $x20 = $x1.width;$x0.width = $x20;var $x21 = $x1.height;$x0.height = $x21;var $x22 = $new_bodies$0;$x0.bodies = $x22;var $x23 = $x1.bodies_count;$x0.bodies_count = $x23; break; } }return $x0; }
const $UG$SIPD$GameMap$update_body = _$0 => _$1 => $UG$SIPD$GameMap$update_body$(_$0,_$1)

function $UG$SIPD$State$update_body$(_$0/*:UG/SIPD/State*/,_$1/*:UG/SIPD/Body*/) {var $x1 = _$0;var $x2 = $x1.game_map;var $x3 = _$1;var $new_game_map$0 = $UG$SIPD$GameMap$update_body$($x2, $x3);var $x0 = ({$: "State"});var $x4 = $x1.next_id;$x0.next_id = $x4;var $x5 = $x1.tick;$x0.tick = $x5;var $x6 = $x1.players;$x0.players = $x6;var $x7 = $x1.hero_states;$x0.hero_states = $x7;var $x8 = $new_game_map$0;$x0.game_map = $x8;return $x0; }
const $UG$SIPD$State$update_body = _$0 => _$1 => $UG$SIPD$State$update_body$(_$0,_$1)

function $UG$SIPD$Effect$accelerated_move_range$(_$0/*:BigInt*/,_$1/*:Number*/,_$2/*:V2*/,_$3/*:Number*/,_$4/*:Number*/,_$5/*:BigInt*/,_$6/*:UG/SIPD/Effect*/,_$7/*:UG/SIPD/State*/) {var $x1 = _$7;var $x2 = $x1.game_map;var $x4 = _$0;var $x5 = $x2.bodies;var $x3 = $UG$SIPD$Body$get_body$($x4, $x5);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = ({$: "GameMap"});var $x11 = $x2.width;$x10.width = $x11;var $x12 = $x2.height;$x10.height = $x12;var $x13 = $x2.bodies;$x10.bodies = $x13;var $x14 = $x2.bodies_count;$x10.bodies_count = $x14;$x0.game_map = $x10; break; } case "Some": { var $x15 = $x3.value;var $x16 = $x15.hitbox;var $hitbox_center$0 = $UG$Shape$get_center$($x16);var $x17 = _$2;var $x18 = $hitbox_center$0;var $distance_to_target$1 = $V2$sub$($x17, $x18);var $x21 = $distance_to_target$1;var $x19 = $V2$length$($x21);var $x20 = 0.0;var $ln$2 = (Math.round($x19 * Math.pow(10, 2)) / Math.pow(10, 2));var $x24 = $ln$2;var $x25 = 20.0;var $x23 = $F64$lt$($x24, $x25);var $x27 = _$3;var $x28 = 0.0;var $x26 = $F64$lte$($x27, $x28);var $x22 = $Bool$or$($x23, $x26);switch ($x22.$) { case "True": { var $x29 = ({$: "State"});var $x30 = $x1.next_id;$x29.next_id = $x30;var $x31 = $x1.tick;$x29.tick = $x31;var $x32 = $x1.players;$x29.players = $x32;var $x33 = $x1.hero_states;$x29.hero_states = $x33;var $x34 = ({$: "GameMap"});var $x35 = $x2.width;$x34.width = $x35;var $x36 = $x2.height;$x34.height = $x36;var $x37 = $x2.bodies;$x34.bodies = $x37;var $x38 = $x2.bodies_count;$x34.bodies_count = $x38;$x29.game_map = $x34;var $x39 = _$0;var $x0 = $UG$SIPD$State$delete_body$($x29, $x39); break; } case "False": { var $x42 = _$1;var $x43 = _$4;var $x40 = $F64$add$($x42, $x43);var $x41 = 0.0;var $accelerated_speed$3 = (Math.round($x40 * Math.pow(10, 2)) / Math.pow(10, 2));var $x44 = $accelerated_speed$3;var $x45 = _$3;var $move_distance$4 = $F64$min$($x44, $x45);var $x47 = $distance_to_target$1;var $x46 = $V2$normalize$($x47);var $direction$5 = $V2$round$($x46);var $x49 = $direction$5;var $x50 = $move_distance$4;var $x48 = $V2$mul_scalar$($x49, $x50);var $movement$6 = $V2$round$($x48);var $x51 = $x15.hitbox;var $x52 = $movement$6;var $new_hitbox$7 = $UG$Shape$move$($x51, $x52);var $x53 = ({$: "State"});var $x54 = $x1.next_id;$x53.next_id = $x54;var $x55 = $x1.tick;$x53.tick = $x55;var $x56 = $x1.players;$x53.players = $x56;var $x57 = $x1.hero_states;$x53.hero_states = $x57;var $x58 = ({$: "GameMap"});var $x59 = $x2.width;$x58.width = $x59;var $x60 = $x2.height;$x58.height = $x60;var $x61 = $x2.bodies;$x58.bodies = $x61;var $x62 = $x2.bodies_count;$x58.bodies_count = $x62;$x53.game_map = $x58;var $x63 = ({$: "Body"});var $x64 = $x15.id;$x63.id = $x64;var $x65 = $new_hitbox$7;$x63.hitbox = $x65;var $x66 = $x15.tick;$x63.tick = $x66;var $x67 = $x15.effects;$x63.effects = $x67;var $x68 = $x15.collidable;$x63.collidable = $x68;var $x69 = $x15.side;$x63.side = $x69;var $updated_state$8 = $UG$SIPD$State$update_body$($x53, $x63);var $x70 = _$6;var $x71 = $updated_state$8;var $state$9 = $UG$SIPD$Effect$apply$($x70, $x71);var $x73 = _$5;var $x74 = 0n;var $x72 = $U64$gt$($x73, $x74);switch ($x72.$) { case "True": { var $x81 = $UG$SIPD$Effect$accelerated_move_range;var $x82 = _$0;var $x80 = ($x81)($x82);var $x83 = $accelerated_speed$3;var $x79 = ($x80)($x83);var $x84 = _$2;var $x78 = ($x79)($x84);var $x85 = _$3;var $x77 = ($x78)($x85);var $x86 = _$4;var $x76 = ($x77)($x86);var $x88 = _$5;var $x89 = 1n;var $x87 = BigInt.asUintN(64, $x88 - $x89);var $x75 = ($x76)($x87);var $x90 = _$6;var $new_effect$10 = ($x75)($x90);var $x91 = $state$9;var $x92 = ({$: "Body"});var $x93 = $x15.id;$x92.id = $x93;var $x94 = $new_hitbox$7;$x92.hitbox = $x94;var $x95 = $x15.tick;$x92.tick = $x95;var $x96 = ({$: "Cons"});var $x97 = $new_effect$10;$x96.head = $x97;var $x98 = $x15.effects;$x96.tail = $x98;$x92.effects = $x96;var $x99 = $x15.collidable;$x92.collidable = $x99;var $x100 = $x15.side;$x92.side = $x100;var $x0 = $UG$SIPD$State$update_body$($x91, $x92); break; } case "False": { var $x101 = $state$9;var $x102 = _$0;var $x0 = $UG$SIPD$State$delete_body$($x101, $x102); break; } } break; } } break; } }return $x0; }
const $UG$SIPD$Effect$accelerated_move_range = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => _$6 => _$7 => $UG$SIPD$Effect$accelerated_move_range$(_$0,_$1,_$2,_$3,_$4,_$5,_$6,_$7)

function $damage$handle_collidable$(_$0/*:BigInt*/,_$1/*:UG/SIPD/Body*/,_$2/*:UG/SIPD/Body*/,_$3/*:UG/SIPD/State*/) {var $x1 = _$1;var $x2 = _$2;var $x3 = $x2.collidable;switch ($x3.$) { case "TakesEffects": { var $got$0 = _$3;var $x4 = $got$0;var $x6 = $UG$SIPD$Hero$HeroState;var $x7 = $x4.hero_states;var $x8 = $x2.id;var $x5 = $Map$get$($x6, $x7, $x8);switch ($x5.$) { case "Some": { var $got$1 = $x5.value;var $x9 = $got$1;var $x10 = $x9.health;var $x11 = _$0;var $new_health$2 = $U64$sub$($x10, $x11);var $x12 = $UG$SIPD$Hero$HeroState;var $x13 = $x4.hero_states;var $x14 = $x2.id;var $x15 = ({$: "HeroState"});var $x16 = $x9.cooldowns;$x15.cooldowns = $x16;var $x17 = $new_health$2;$x15.health = $x17;var $updated_hero_states$3 = $Map$insert$($x12, $x13, $x14, $x15);var $x18 = ({$: "State"});var $x19 = $x4.next_id;$x18.next_id = $x19;var $x20 = $x4.tick;$x18.tick = $x20;var $x21 = $x4.players;$x18.players = $x21;var $x22 = $updated_hero_states$3;$x18.hero_states = $x22;var $x23 = $x4.game_map;$x18.game_map = $x23;var $x24 = $x1.id;var $state$4 = $UG$SIPD$State$delete_body$($x18, $x24);var $x27 = $new_health$2;var $x28 = 0n;var $x26 = $U64$lte$($x27, $x28);var $x30 = _$0;var $x31 = $x9.health;var $x29 = $U64$gte$($x30, $x31);var $x25 = $Bool$or$($x26, $x29);switch ($x25.$) { case "True": { var $x32 = $state$4;var $x33 = $x2.id;var $x0 = $UG$SIPD$State$delete_body$($x32, $x33); break; } case "False": { var $x0 = $state$4; break; } } break; } case "None": { var $x0 = _$3; break; } } break; } default: { var $x0 = _$3; break; } }return $x0; }
const $damage$handle_collidable = _$0 => _$1 => _$2 => _$3 => $damage$handle_collidable$(_$0,_$1,_$2,_$3)

function $UG$SIPD$Effect$collide_and_damage$go$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:BigInt*/,_$3/*:UG/SIPD/Body*/,_$4/*:List<Pair<V2><UG/SIPD/Body>>*/) {var $x1 = _$4;switch ($x1.$) { case "Cons": { var $x2 = $x1.head;var $x0 = ($state$0 => {var $got$1 = $x2.snd;var $x4 = $got$1;var $x6 = _$0;var $x7 = $x4.id;var $x5 = $U64$eq$($x6, $x7);switch ($x5.$) { case "True": { var $x9 = _$0;var $x10 = _$1;var $x11 = _$2;var $x12 = _$3;var $x13 = $x1.tail;var $x8 = $UG$SIPD$Effect$collide_and_damage$go$($x9, $x10, $x11, $x12, $x13);var $x14 = $state$0;var $x3 = ($x8)($x14); break; } case "False": { var $x15 = _$2;var $x16 = _$3;var $x17 = $x2.snd;var $x18 = $state$0;var $new_state$2 = $damage$handle_collidable$($x15, $x16, $x17, $x18);var $x20 = _$0;var $x21 = _$1;var $x22 = _$2;var $x23 = _$3;var $x24 = $x1.tail;var $x19 = $UG$SIPD$Effect$collide_and_damage$go$($x20, $x21, $x22, $x23, $x24);var $x25 = $new_state$2;var $x3 = ($x19)($x25); break; } }return $x3;}); break; } case "Nil": { var $x0 = ($state$0 => {var $x26 = $state$0;return $x26;}); break; } }return $x0; }
const $UG$SIPD$Effect$collide_and_damage$go = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Effect$collide_and_damage$go$(_$0,_$1,_$2,_$3,_$4)

function $UG$SIPD$GameMap$get_body$(_$0/*:Map<BigInt, Maybe<UG/SIPD/Body>>*/,_$1/*:BigInt*/) {var $x1 = $UG$SIPD$Body;var $x2 = _$0;var $x3 = _$1;var $x0 = $Map$get$($x1, $x2, $x3);return $x0; }
const $UG$SIPD$GameMap$get_body = _$0 => _$1 => $UG$SIPD$GameMap$get_body$(_$0,_$1)

function $UG$SIPD$Effect$collide_and_damage$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:BigInt*/,_$3/*:UG/SIPD/State*/) {var $got$0 = _$3;var $x1 = $got$0;var $got$1 = $x1.game_map;var $x2 = $got$1;var $x3 = $UG$SIPD$Body;var $x4 = $x2.bodies;var $x5 = $x2.bodies_count;var $bodies_list$2 = $Map$values$($x3, $x4, $x5);var $x7 = $x2.bodies;var $x8 = _$1;var $x6 = $UG$SIPD$GameMap$get_body$($x7, $x8);switch ($x6.$) { case "Some": { var $got$3 = $x6.value;var $x9 = $got$3;var $x10 = _$0;var $x11 = $x6.value;var $x12 = $bodies_list$2;var $collision_results$4 = $UG$SIPD$Body$find_collision$($x10, $x11, $x12);var $x14 = _$0;var $x15 = _$1;var $x16 = _$2;var $x17 = $x6.value;var $x18 = $collision_results$4;var $x13 = $UG$SIPD$Effect$collide_and_damage$go$($x14, $x15, $x16, $x17, $x18);var $x19 = _$3;var $x0 = ($x13)($x19); break; } case "None": { var $x0 = _$3; break; } }return $x0; }
const $UG$SIPD$Effect$collide_and_damage = _$0 => _$1 => _$2 => _$3 => $UG$SIPD$Effect$collide_and_damage$(_$0,_$1,_$2,_$3)

function $dps$handle_collidable$(_$0/*:BigInt*/,_$1/*:UG/SIPD/Body*/,_$2/*:UG/SIPD/Body*/,_$3/*:UG/SIPD/State*/) {var $x1 = _$1;var $x2 = _$2;var $x3 = $x2.collidable;switch ($x3.$) { case "TakesEffects": { var $got$0 = _$3;var $x4 = $got$0;var $x6 = $UG$SIPD$Hero$HeroState;var $x7 = $x4.hero_states;var $x8 = $x2.id;var $x5 = $Map$get$($x6, $x7, $x8);switch ($x5.$) { case "Some": { var $got$1 = $x5.value;var $x9 = $got$1;var $x10 = $x9.health;var $x11 = _$0;var $new_health$2 = $U64$sub$($x10, $x11);var $x12 = $UG$SIPD$Hero$HeroState;var $x13 = $x4.hero_states;var $x14 = $x2.id;var $x15 = ({$: "HeroState"});var $x16 = $x9.cooldowns;$x15.cooldowns = $x16;var $x17 = $new_health$2;$x15.health = $x17;var $updated_hero_states$3 = $Map$insert$($x12, $x13, $x14, $x15);var $x20 = $new_health$2;var $x21 = 0n;var $x19 = $U64$lte$($x20, $x21);var $x23 = _$0;var $x24 = $x9.health;var $x22 = $U64$gte$($x23, $x24);var $x18 = $Bool$or$($x19, $x22);switch ($x18.$) { case "True": { var $x25 = ({$: "State"});var $x26 = $x4.next_id;$x25.next_id = $x26;var $x27 = $x4.tick;$x25.tick = $x27;var $x28 = $x4.players;$x25.players = $x28;var $x29 = $updated_hero_states$3;$x25.hero_states = $x29;var $x30 = $x4.game_map;$x25.game_map = $x30;var $x31 = $x2.id;var $x0 = $UG$SIPD$State$delete_body$($x25, $x31); break; } case "False": { var $x0 = ({$: "State"});var $x32 = $x4.next_id;$x0.next_id = $x32;var $x33 = $x4.tick;$x0.tick = $x33;var $x34 = $x4.players;$x0.players = $x34;var $x35 = $updated_hero_states$3;$x0.hero_states = $x35;var $x36 = $x4.game_map;$x0.game_map = $x36; break; } } break; } case "None": { var $x0 = _$3; break; } } break; } default: { var $x0 = _$3; break; } }return $x0; }
const $dps$handle_collidable = _$0 => _$1 => _$2 => _$3 => $dps$handle_collidable$(_$0,_$1,_$2,_$3)

function $UG$SIPD$Effect$collide_and_dps$go$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:List<Pair<V2><UG/SIPD/Body>>*/) {var $x1 = _$2;switch ($x1.$) { case "Cons": { var $x2 = $x1.head;var $x0 = ($state$0 => {var $got$1 = $x2.snd;var $x4 = $got$1;var $x6 = _$0;var $x7 = $x4.id;var $x5 = $U64$eq$($x6, $x7);switch ($x5.$) { case "True": { var $new_state$2 = $state$0;var $x9 = _$0;var $x10 = _$1;var $x11 = $x1.tail;var $x8 = $UG$SIPD$Effect$collide_and_dps$go$($x9, $x10, $x11);var $x12 = $new_state$2;var $x3 = ($x8)($x12); break; } case "False": { var $x13 = _$1;var $x14 = ({$: "Body"});var $x15 = $x4.id;$x14.id = $x15;var $x16 = $x4.hitbox;$x14.hitbox = $x16;var $x17 = $x4.tick;$x14.tick = $x17;var $x18 = $x4.effects;$x14.effects = $x18;var $x19 = $x4.collidable;$x14.collidable = $x19;var $x20 = $x4.side;$x14.side = $x20;var $x21 = $x2.snd;var $x22 = $state$0;var $new_state$2 = $dps$handle_collidable$($x13, $x14, $x21, $x22);var $x24 = _$0;var $x25 = _$1;var $x26 = $x1.tail;var $x23 = $UG$SIPD$Effect$collide_and_dps$go$($x24, $x25, $x26);var $x27 = $new_state$2;var $x3 = ($x23)($x27); break; } }return $x3;}); break; } case "Nil": { var $x0 = ($state$0 => {var $x28 = $state$0;return $x28;}); break; } }return $x0; }
const $UG$SIPD$Effect$collide_and_dps$go = _$0 => _$1 => _$2 => $UG$SIPD$Effect$collide_and_dps$go$(_$0,_$1,_$2)

function $UG$SIPD$Effect$collide_and_dps$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:BigInt*/,_$3/*:UG/SIPD/State*/) {var $got$0 = _$3;var $x1 = $got$0;var $got$1 = $x1.game_map;var $x2 = $got$1;var $x3 = $UG$SIPD$Body;var $x4 = $x2.bodies;var $x5 = $x2.bodies_count;var $bodies_list$2 = $Map$values$($x3, $x4, $x5);var $x7 = $x2.bodies;var $x8 = _$1;var $x6 = $UG$SIPD$GameMap$get_body$($x7, $x8);switch ($x6.$) { case "Some": { var $got$3 = $x6.value;var $x9 = $got$3;var $x10 = _$0;var $x11 = ({$: "Body"});var $x12 = $x9.id;$x11.id = $x12;var $x13 = $x9.hitbox;$x11.hitbox = $x13;var $x14 = $x9.tick;$x11.tick = $x14;var $x15 = $x9.effects;$x11.effects = $x15;var $x16 = $x9.collidable;$x11.collidable = $x16;var $x17 = $x9.side;$x11.side = $x17;var $x18 = $bodies_list$2;var $collision_results$4 = $UG$SIPD$Body$find_collision$($x10, $x11, $x18);var $x20 = _$0;var $x21 = _$2;var $x22 = $collision_results$4;var $x19 = $UG$SIPD$Effect$collide_and_dps$go$($x20, $x21, $x22);var $x23 = _$3;var $x0 = ($x19)($x23); break; } case "None": { var $x0 = _$3; break; } }return $x0; }
const $UG$SIPD$Effect$collide_and_dps = _$0 => _$1 => _$2 => _$3 => $UG$SIPD$Effect$collide_and_dps$(_$0,_$1,_$2,_$3)

function $UG$SIPD$Player$get_mouse_pos$(_$0/*:UG/SIPD/Player*/,_$1/*:String*/) {var $x1 = _$0;var $x4 = $String;var $x6 = $Bool;var $x7 = $V2;var $x5 = $Pair$($x6, $x7);var $x8 = $String$Ord;var $x9 = $x1.keys;var $x3 = $OrdTree$get$($x4, $x5, $x8, $x9);var $x10 = _$1;var $x2 = ($x3)($x10);switch ($x2.$) { case "None": { var $x0 = ({$: "V2"});var $x11 = 0.0;$x0.x = $x11;var $x12 = 0.0;$x0.y = $x12; break; } case "Some": { var $x13 = $x2.value;var $x0 = $x13.snd; break; } }return $x0; }
const $UG$SIPD$Player$get_mouse_pos = _$0 => _$1 => $UG$SIPD$Player$get_mouse_pos$(_$0,_$1)

function $UG$SIPD$State$generate_id$(_$0/*:UG/SIPD/State*/) {var $x1 = _$0;var $x2 = $x1.next_id;var $x3 = 1n;var $nxt_next_id$0 = BigInt.asUintN(64, $x2 + $x3);var $x0 = ({$: "Pair"});var $x4 = $x1.next_id;$x0.fst = $x4;var $x5 = ({$: "State"});var $x6 = $nxt_next_id$0;$x5.next_id = $x6;var $x7 = $x1.tick;$x5.tick = $x7;var $x8 = $x1.players;$x5.players = $x8;var $x9 = $x1.hero_states;$x5.hero_states = $x9;var $x10 = $x1.game_map;$x5.game_map = $x10;$x0.snd = $x5;return $x0; }
const $UG$SIPD$State$generate_id = _$0 => $UG$SIPD$State$generate_id$(_$0)

function $UG$Shape$start_centered_rectangle$(_$0/*:V2*/,_$1/*:Number*/,_$2/*:Number*/) {var $x1 = _$1;var $x2 = 2.0;var $half_width$0 = $F64$div$($x1, $x2);var $x4 = 0.0;var $x5 = $half_width$0;var $x3 = $F64$sub$($x4, $x5);var $x6 = _$2;var $top_left$1 = $V2$new$($x3, $x6);var $x7 = $half_width$0;var $x8 = _$2;var $top_right$2 = $V2$new$($x7, $x8);var $x9 = $half_width$0;var $x10 = 0.0;var $bottom_right$3 = $V2$new$($x9, $x10);var $x12 = 0.0;var $x13 = $half_width$0;var $x11 = $F64$sub$($x12, $x13);var $x14 = 0.0;var $bottom_left$4 = $V2$new$($x11, $x14);var $x0 = ({$: "Polygon"});var $x15 = _$0;$x0.center = $x15;var $x16 = ({$: "Cons"});var $x17 = $top_left$1;$x16.head = $x17;var $x18 = ({$: "Cons"});var $x19 = $top_right$2;$x18.head = $x19;var $x20 = ({$: "Cons"});var $x21 = $bottom_right$3;$x20.head = $x21;var $x22 = ({$: "Cons"});var $x23 = $bottom_left$4;$x22.head = $x23;var $x24 = ({$: "Nil"});$x22.tail = $x24;$x20.tail = $x22;$x18.tail = $x20;$x16.tail = $x18;$x0.vertices = $x16;return $x0; }
const $UG$Shape$start_centered_rectangle = _$0 => _$1 => _$2 => $UG$Shape$start_centered_rectangle$(_$0,_$1,_$2)

function $V2$calculate_angle$(_$0/*:V2*/,_$1/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = $x2.x;var $x4 = $x1.x;var $dx$0 = $F64$sub$($x3, $x4);var $x5 = $x2.y;var $x6 = $x1.y;var $dy$1 = $F64$sub$($x5, $x6);var $x7 = 0.0;var $x9 = $dx$0;var $x10 = $dy$1;var $x8 = Math.atan2($x9, $x10);var $x0 = $F64$sub$($x7, $x8);return $x0; }
const $V2$calculate_angle = _$0 => _$1 => $V2$calculate_angle$(_$0,_$1)

function $UG$Shape$get_rotation$(_$0/*:UG/Shape*/) {var $x1 = _$0;switch ($x1.$) { case "Circle": { var $x0 = 0.0; break; } case "Polygon": { var $x2 = $x1.vertices;switch ($x2.$) { case "Nil": { var $x0 = 0.0; break; } case "Cons": { var $x3 = $x2.tail;switch ($x3.$) { case "Nil": { var $x0 = 0.0; break; } case "Cons": { var $x5 = $x3.head;var $x4 = $V2$x$($x5);var $x7 = $x2.head;var $x6 = $V2$x$($x7);var $dx$0 = $F64$sub$($x4, $x6);var $x9 = $x3.head;var $x8 = $V2$y$($x9);var $x11 = $x2.head;var $x10 = $V2$y$($x11);var $dy$1 = $F64$sub$($x8, $x10);var $x14 = $dy$1;var $x15 = $dx$0;var $x12 = Math.atan2($x14, $x15);var $x13 = 0.0;var $x0 = (Math.round($x12 * Math.pow(10, 2)) / Math.pow(10, 2)); break; } } break; } } break; } }return $x0; }
const $UG$Shape$get_rotation = _$0 => $UG$Shape$get_rotation$(_$0)

function $calculate_angle_diff$(_$0/*:Number*/) {var $x3 = _$0;var $x2 = $F64$abs$($x3);var $x4 = 3.1415;var $x1 = $F64$gt$($x2, $x4);switch ($x1.$) { case "True": { var $x6 = _$0;var $x7 = 0.0;var $x5 = $F64$gt$($x6, $x7);switch ($x5.$) { case "True": { var $x8 = _$0;var $x10 = 2.0;var $x11 = 3.1415;var $x9 = $F64$mul$($x10, $x11);var $x0 = $F64$sub$($x8, $x9); break; } case "False": { var $x12 = _$0;var $x14 = 2.0;var $x15 = 3.1415;var $x13 = $F64$mul$($x14, $x15);var $x0 = $F64$add$($x12, $x13); break; } } break; } case "False": { var $x0 = _$0; break; } }return $x0; }
const $calculate_angle_diff = _$0 => $calculate_angle_diff$(_$0)

function $V2$rotate$(_$0/*:V2*/,_$1/*:Number*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = 0.0;var $cos_theta$0 = Math.cos($x2);var $x4 = _$1;var $x5 = 0.0;var $sin_theta$1 = Math.sin($x4);var $x7 = $x1.x;var $x8 = $cos_theta$0;var $x6 = $F64$mul$($x7, $x8);var $x10 = $x1.y;var $x11 = $sin_theta$1;var $x9 = $F64$mul$($x10, $x11);var $new_x$2 = $F64$sub$($x6, $x9);var $x13 = $x1.x;var $x14 = $sin_theta$1;var $x12 = $F64$mul$($x13, $x14);var $x16 = $x1.y;var $x17 = $cos_theta$0;var $x15 = $F64$mul$($x16, $x17);var $new_y$3 = $F64$add$($x12, $x15);var $x0 = ({$: "V2"});var $x18 = $new_x$2;$x0.x = $x18;var $x19 = $new_y$3;$x0.y = $x19;return $x0; }
const $V2$rotate = _$0 => _$1 => $V2$rotate$(_$0,_$1)

function $UG$Shape$rotate$(_$0/*:UG/Shape*/,_$1/*:Number*/) {var $x1 = _$0;switch ($x1.$) { case "Circle": { var $x0 = ({$: "Circle"});var $x2 = $x1.center;$x0.center = $x2;var $x3 = $x1.radius;$x0.radius = $x3; break; } case "Polygon": { var $x4 = $V2;var $x5 = $V2;var $x6 = $x1.vertices;var $x7 = ($vert$0 => {var $x9 = $vert$0;var $x10 = _$1;var $x8 = $V2$rotate$($x9, $x10);return $x8;});var $rotated_vertices$0 = $List$map$($x4, $x5, $x6, $x7);var $x0 = ({$: "Polygon"});var $x11 = $x1.center;$x0.center = $x11;var $x12 = $rotated_vertices$0;$x0.vertices = $x12; break; } }return $x0; }
const $UG$Shape$rotate = _$0 => _$1 => $UG$Shape$rotate$(_$0,_$1)

function $UG$SIPD$GameMap$insert_body$(_$0/*:UG/SIPD/GameMap*/,_$1/*:UG/SIPD/Body*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = $UG$SIPD$Body;var $x4 = $x1.bodies;var $x5 = $x2.id;var $x6 = ({$: "Body"});var $x7 = $x2.id;$x6.id = $x7;var $x8 = $x2.hitbox;$x6.hitbox = $x8;var $x9 = $x2.tick;$x6.tick = $x9;var $x10 = $x2.effects;$x6.effects = $x10;var $x11 = $x2.collidable;$x6.collidable = $x11;var $x12 = $x2.side;$x6.side = $x12;var $new_bodies$0 = $Map$insert$($x3, $x4, $x5, $x6);var $x13 = $new_bodies$0;var $x14 = $x2.id;var $res$1 = $UG$SIPD$GameMap$get_body$($x13, $x14);var $x16 = $x2.id;var $x17 = $x1.bodies_count;var $x15 = $U64$gt$($x16, $x17);switch ($x15.$) { case "True": { var $x0 = ({$: "GameMap"});var $x18 = $x1.width;$x0.width = $x18;var $x19 = $x1.height;$x0.height = $x19;var $x20 = $new_bodies$0;$x0.bodies = $x20;var $x21 = $x2.id;$x0.bodies_count = $x21; break; } case "False": { var $x0 = ({$: "GameMap"});var $x22 = $x1.width;$x0.width = $x22;var $x23 = $x1.height;$x0.height = $x23;var $x24 = $new_bodies$0;$x0.bodies = $x24;var $x25 = $x1.bodies_count;$x0.bodies_count = $x25; break; } }return $x0; }
const $UG$SIPD$GameMap$insert_body = _$0 => _$1 => $UG$SIPD$GameMap$insert_body$(_$0,_$1)

function $UG$SIPD$State$insert_body$(_$0/*:UG/SIPD/State*/,_$1/*:UG/SIPD/Body*/) {var $x1 = _$0;var $x2 = $x1.game_map;var $x3 = _$1;var $new_game_map$0 = $UG$SIPD$GameMap$insert_body$($x2, $x3);var $x0 = ({$: "State"});var $x4 = $x1.next_id;$x0.next_id = $x4;var $x5 = $x1.tick;$x0.tick = $x5;var $x6 = $x1.players;$x0.players = $x6;var $x7 = $x1.hero_states;$x0.hero_states = $x7;var $x8 = $new_game_map$0;$x0.game_map = $x8;return $x0; }
const $UG$SIPD$State$insert_body = _$0 => _$1 => $UG$SIPD$State$insert_body$(_$0,_$1)

function $UG$SIPD$Effect$tick_disintegrate_line$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:Number*/,_$4/*:Number*/,_$5/*:UG/SIPD/State*/) {var $x1 = _$5;var $x2 = $x1.game_map;var $x4 = _$0;var $x5 = $x2.bodies;var $x3 = $UG$SIPD$Body$get_body$($x4, $x5);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = ({$: "GameMap"});var $x11 = $x2.width;$x10.width = $x11;var $x12 = $x2.height;$x10.height = $x12;var $x13 = $x2.bodies;$x10.bodies = $x13;var $x14 = $x2.bodies_count;$x10.bodies_count = $x14;$x0.game_map = $x10; break; } case "Some": { var $x16 = _$1;var $x17 = $x2.bodies;var $x15 = $UG$SIPD$Body$get_body$($x16, $x17);switch ($x15.$) { case "None": { var $x0 = ({$: "State"});var $x18 = $x1.next_id;$x0.next_id = $x18;var $x19 = $x1.tick;$x0.tick = $x19;var $x20 = $x1.players;$x0.players = $x20;var $x21 = $x1.hero_states;$x0.hero_states = $x21;var $x22 = ({$: "GameMap"});var $x23 = $x2.width;$x22.width = $x23;var $x24 = $x2.height;$x22.height = $x24;var $x25 = $x2.bodies;$x22.bodies = $x25;var $x26 = $x2.bodies_count;$x22.bodies_count = $x26;$x0.game_map = $x22; break; } case "Some": { var $x28 = $UG$SIPD$Player;var $x29 = $x1.players;var $x30 = _$1;var $x27 = $Map$get$($x28, $x29, $x30);switch ($x27.$) { case "None": { var $x0 = ({$: "State"});var $x31 = $x1.next_id;$x0.next_id = $x31;var $x32 = $x1.tick;$x0.tick = $x32;var $x33 = $x1.players;$x0.players = $x33;var $x34 = $x1.hero_states;$x0.hero_states = $x34;var $x35 = ({$: "GameMap"});var $x36 = $x2.width;$x35.width = $x36;var $x37 = $x2.height;$x35.height = $x37;var $x38 = $x2.bodies;$x35.bodies = $x38;var $x39 = $x2.bodies_count;$x35.bodies_count = $x39;$x0.game_map = $x35; break; } case "Some": { var $got$0 = $x15.value;var $x40 = $got$0;var $x41 = $x40.hitbox;var $hero_pos$1 = $UG$Shape$get_center$($x41);var $x42 = $hero_pos$1;var $x43 = _$2;var $x44 = _$3;var $def_line$2 = $UG$Shape$start_centered_rectangle$($x42, $x43, $x44);var $got$3 = $x3.value;var $x45 = $got$3;var $got$4 = $x27.value;var $x46 = $got$4;var $x49 = $hero_pos$1;var $x50 = $x46.target;var $x47 = $V2$calculate_angle$($x49, $x50);var $x48 = 0.0;var $target_angle$5 = (Math.round($x47 * Math.pow(10, 2)) / Math.pow(10, 2));var $x53 = $x45.hitbox;var $x51 = $UG$Shape$get_rotation$($x53);var $x52 = 0.0;var $current_angle$6 = (Math.round($x51 * Math.pow(10, 2)) / Math.pow(10, 2));var $x56 = $target_angle$5;var $x57 = $current_angle$6;var $x54 = $F64$sub$($x56, $x57);var $x55 = 0.0;var $raw_diff$7 = (Math.round($x54 * Math.pow(10, 2)) / Math.pow(10, 2));var $x60 = $raw_diff$7;var $x58 = $calculate_angle_diff$($x60);var $x59 = 0.0;var $angle_diff$8 = (Math.round($x58 * Math.pow(10, 2)) / Math.pow(10, 2));var $x63 = $angle_diff$8;var $x62 = $F64$abs$($x63);var $x64 = _$4;var $x61 = $F64$gt$($x62, $x64);switch ($x61.$) { case "True": { var $x67 = $current_angle$6;var $x71 = _$4;var $x73 = $angle_diff$8;var $x72 = $F64$sign$($x73);var $x69 = $F64$mul$($x71, $x72);var $x70 = 0.0;var $x68 = (Math.round($x69 * Math.pow(10, 2)) / Math.pow(10, 2));var $x65 = $F64$add$($x67, $x68);var $x66 = 0.0;var $new_angle$9 = (Math.round($x65 * Math.pow(10, 2)) / Math.pow(10, 2));var $x74 = $def_line$2;var $x75 = $new_angle$9;var $new_line_shape$10 = $UG$Shape$rotate$($x74, $x75);var $x76 = ({$: "State"});var $x77 = $x1.next_id;$x76.next_id = $x77;var $x78 = $x1.tick;$x76.tick = $x78;var $x79 = $x1.players;$x76.players = $x79;var $x80 = $x1.hero_states;$x76.hero_states = $x80;var $x81 = ({$: "GameMap"});var $x82 = $x2.width;$x81.width = $x82;var $x83 = $x2.height;$x81.height = $x83;var $x84 = $x2.bodies;$x81.bodies = $x84;var $x85 = $x2.bodies_count;$x81.bodies_count = $x85;$x76.game_map = $x81;var $x86 = ({$: "Body"});var $x87 = $x45.id;$x86.id = $x87;var $x88 = $new_line_shape$10;$x86.hitbox = $x88;var $x89 = $x45.tick;$x86.tick = $x89;var $x90 = $x45.effects;$x86.effects = $x90;var $x91 = $x45.collidable;$x86.collidable = $x91;var $x92 = $x45.side;$x86.side = $x92;var $new_state$11 = $UG$SIPD$State$insert_body$($x76, $x86);var $x93 = ({$: "Body"});var $x94 = $x45.id;$x93.id = $x94;var $x95 = $new_line_shape$10;$x93.hitbox = $x95;var $x96 = $x45.tick;$x93.tick = $x96;var $x97 = $x45.effects;$x93.effects = $x97;var $x98 = $x45.collidable;$x93.collidable = $x98;var $x99 = $x45.side;$x93.side = $x99;var $x100 = $new_state$11;var $x0 = $UG$SIPD$Body$apply_effects$($x93, $x100); break; } case "False": { var $new_angle$9 = $target_angle$5;var $x101 = $def_line$2;var $x102 = $new_angle$9;var $new_line_shape$10 = $UG$Shape$rotate$($x101, $x102);var $x103 = ({$: "State"});var $x104 = $x1.next_id;$x103.next_id = $x104;var $x105 = $x1.tick;$x103.tick = $x105;var $x106 = $x1.players;$x103.players = $x106;var $x107 = $x1.hero_states;$x103.hero_states = $x107;var $x108 = ({$: "GameMap"});var $x109 = $x2.width;$x108.width = $x109;var $x110 = $x2.height;$x108.height = $x110;var $x111 = $x2.bodies;$x108.bodies = $x111;var $x112 = $x2.bodies_count;$x108.bodies_count = $x112;$x103.game_map = $x108;var $x113 = ({$: "Body"});var $x114 = $x45.id;$x113.id = $x114;var $x115 = $new_line_shape$10;$x113.hitbox = $x115;var $x116 = $x45.tick;$x113.tick = $x116;var $x117 = $x45.effects;$x113.effects = $x117;var $x118 = $x45.collidable;$x113.collidable = $x118;var $x119 = $x45.side;$x113.side = $x119;var $new_state$11 = $UG$SIPD$State$insert_body$($x103, $x113);var $x120 = ({$: "Body"});var $x121 = $x45.id;$x120.id = $x121;var $x122 = $new_line_shape$10;$x120.hitbox = $x122;var $x123 = $x45.tick;$x120.tick = $x123;var $x124 = $x45.effects;$x120.effects = $x124;var $x125 = $x45.collidable;$x120.collidable = $x125;var $x126 = $x45.side;$x120.side = $x126;var $x127 = $new_state$11;var $x0 = $UG$SIPD$Body$apply_effects$($x120, $x127); break; } } break; } } break; } } break; } }return $x0; }
const $UG$SIPD$Effect$tick_disintegrate_line = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $UG$SIPD$Effect$tick_disintegrate_line$(_$0,_$1,_$2,_$3,_$4,_$5)

function $disintegrate$create_disintegrate_line$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:Number*/,_$4/*:Number*/,_$5/*:V2*/,_$6/*:V2*/,_$7/*:UG/SIPD/Side*/) {var $x2 = _$6;var $x3 = _$5;var $x1 = $V2$sub$($x2, $x3);var $direction$0 = $V2$normalize$($x1);var $center$1 = _$5;var $x4 = $center$1;var $x5 = _$2;var $x6 = _$3;var $body_shape$2 = $UG$Shape$start_centered_rectangle$($x4, $x5, $x6);var $x11 = $UG$SIPD$Effect$tick_disintegrate_line;var $x12 = _$0;var $x10 = ($x11)($x12);var $x13 = _$1;var $x9 = ($x10)($x13);var $x14 = _$2;var $x8 = ($x9)($x14);var $x15 = _$3;var $x7 = ($x8)($x15);var $x16 = _$4;var $body_tick$3 = ($x7)($x16);var $x0 = ({$: "Body"});var $x17 = _$0;$x0.id = $x17;var $x18 = $body_shape$2;$x0.hitbox = $x18;var $x19 = $body_tick$3;$x0.tick = $x19;var $x20 = ({$: "Nil"});$x0.effects = $x20;var $x21 = ({$: "Untouchable"});$x0.collidable = $x21;var $x22 = _$7;$x0.side = $x22;return $x0; }
const $disintegrate$create_disintegrate_line = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => _$6 => _$7 => $disintegrate$create_disintegrate_line$(_$0,_$1,_$2,_$3,_$4,_$5,_$6,_$7)

function $UG$SIPD$Effect$spawn_body$(_$0/*:UG/SIPD/Body*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$1;var $x2 = _$0;var $x0 = $UG$SIPD$State$insert_body$($x1, $x2);return $x0; }
const $UG$SIPD$Effect$spawn_body = _$0 => _$1 => $UG$SIPD$Effect$spawn_body$(_$0,_$1)

function $UG$SIPD$Effect$with_duration$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:UG/SIPD/Effect*/,_$3/*:UG/SIPD/State*/) {var $x1 = _$3;var $x2 = $x1.game_map;var $x4 = _$1;var $x5 = $x2.bodies;var $x3 = $UG$SIPD$Body$get_body$($x4, $x5);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = ({$: "GameMap"});var $x11 = $x2.width;$x10.width = $x11;var $x12 = $x2.height;$x10.height = $x12;var $x13 = $x2.bodies;$x10.bodies = $x13;var $x14 = $x2.bodies_count;$x10.bodies_count = $x14;$x0.game_map = $x10; break; } case "Some": { var $x15 = $x3.value;var $x17 = _$0;var $x18 = 0n;var $x16 = $U64$gt$($x17, $x18);switch ($x16.$) { case "False": { var $x19 = _$1;var $x20 = $x2.bodies;var $updated_bodies$0 = $UG$SIPD$Body$delete_body$($x19, $x20);var $x0 = ({$: "State"});var $x21 = $x1.next_id;$x0.next_id = $x21;var $x22 = $x1.tick;$x0.tick = $x22;var $x23 = $x1.players;$x0.players = $x23;var $x24 = $x1.hero_states;$x0.hero_states = $x24;var $x25 = ({$: "GameMap"});var $x26 = $x2.width;$x25.width = $x26;var $x27 = $x2.height;$x25.height = $x27;var $x28 = $updated_bodies$0;$x25.bodies = $x28;var $x29 = $x2.bodies_count;$x25.bodies_count = $x29;$x0.game_map = $x25; break; } case "True": { var $x30 = _$0;var $x31 = 1n;var $remaining_ticks$0 = BigInt.asUintN(64, $x30 - $x31);var $x34 = $UG$SIPD$Effect$with_duration;var $x35 = $remaining_ticks$0;var $x33 = ($x34)($x35);var $x36 = _$1;var $x32 = ($x33)($x36);var $x37 = _$2;var $new_effect$1 = ($x32)($x37);var $x38 = ({$: "State"});var $x39 = $x1.next_id;$x38.next_id = $x39;var $x40 = $x1.tick;$x38.tick = $x40;var $x41 = $x1.players;$x38.players = $x41;var $x42 = $x1.hero_states;$x38.hero_states = $x42;var $x43 = ({$: "GameMap"});var $x44 = $x2.width;$x43.width = $x44;var $x45 = $x2.height;$x43.height = $x45;var $x46 = $x2.bodies;$x43.bodies = $x46;var $x47 = $x2.bodies_count;$x43.bodies_count = $x47;$x38.game_map = $x43;var $x48 = ({$: "Body"});var $x49 = $x15.id;$x48.id = $x49;var $x50 = $x15.hitbox;$x48.hitbox = $x50;var $x51 = $x15.tick;$x48.tick = $x51;var $x52 = ({$: "Cons"});var $x53 = $new_effect$1;$x52.head = $x53;var $x54 = $x15.effects;$x52.tail = $x54;$x48.effects = $x52;var $x55 = $x15.collidable;$x48.collidable = $x55;var $x56 = $x15.side;$x48.side = $x56;var $state$2 = $UG$SIPD$State$insert_body$($x38, $x48);var $x57 = _$2;var $x58 = $state$2;var $x0 = $UG$SIPD$Effect$apply$($x57, $x58); break; } } break; } }return $x0; }
const $UG$SIPD$Effect$with_duration = _$0 => _$1 => _$2 => _$3 => $UG$SIPD$Effect$with_duration$(_$0,_$1,_$2,_$3)

function $UG$SIPD$Hero$HeroState$update_cooldown$(_$0/*:BigInt*/,_$1/*:String*/,_$2/*:UG/SIPD/State*/,_$3/*:BigInt*/) {var $x1 = _$2;var $x3 = $UG$SIPD$Hero$HeroState;var $x4 = $x1.hero_states;var $x5 = _$0;var $x2 = $Map$get$($x3, $x4, $x5);switch ($x2.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = $x1.game_map;$x0.game_map = $x10; break; } case "Some": { var $x11 = $x2.value;var $x12 = $String;var $x13 = /*BigInt*/null;var $x14 = $String$Ord;var $x15 = $x11.cooldowns;var $x16 = ({$: "Pair"});var $x17 = _$1;$x16.fst = $x17;var $x18 = _$3;$x16.snd = $x18;var $new_cooldowns$0 = $OrdTree$insert$($x12, $x13, $x14, $x15, $x16);var $x19 = $UG$SIPD$Hero$HeroState;var $x20 = $x1.hero_states;var $x21 = _$0;var $x22 = ({$: "HeroState"});var $x23 = $new_cooldowns$0;$x22.cooldowns = $x23;var $x24 = $x11.health;$x22.health = $x24;var $new_hero_states$1 = $Map$insert$($x19, $x20, $x21, $x22);var $x0 = ({$: "State"});var $x25 = $x1.next_id;$x0.next_id = $x25;var $x26 = $x1.tick;$x0.tick = $x26;var $x27 = $x1.players;$x0.players = $x27;var $x28 = $new_hero_states$1;$x0.hero_states = $x28;var $x29 = $x1.game_map;$x0.game_map = $x29; break; } }return $x0; }
const $UG$SIPD$Hero$HeroState$update_cooldown = _$0 => _$1 => _$2 => _$3 => $UG$SIPD$Hero$HeroState$update_cooldown$(_$0,_$1,_$2,_$3)

function $disintegrate$block_player_movement$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:UG/SIPD/State*/) {var $movement_key$0 = JSTR_TO_LIST(`RightClick`);var $x1 = _$1;var $x2 = $movement_key$0;var $x3 = _$2;var $x4 = _$0;var $x0 = $UG$SIPD$Hero$HeroState$update_cooldown$($x1, $x2, $x3, $x4);return $x0; }
const $disintegrate$block_player_movement = _$0 => _$1 => _$2 => $disintegrate$block_player_movement$(_$0,_$1,_$2)

function $UG$SIPD$Effect$disintegrate$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:Number*/,_$4/*:Number*/,_$5/*:UG/SIPD/State*/) {var $x1 = _$5;var $x2 = $x1.game_map;var $x4 = $UG$SIPD$Player;var $x5 = $x1.players;var $x6 = _$0;var $x3 = $Map$get$($x4, $x5, $x6);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x7 = $x1.next_id;$x0.next_id = $x7;var $x8 = $x1.tick;$x0.tick = $x8;var $x9 = $x1.players;$x0.players = $x9;var $x10 = $x1.hero_states;$x0.hero_states = $x10;var $x11 = ({$: "GameMap"});var $x12 = $x2.width;$x11.width = $x12;var $x13 = $x2.height;$x11.height = $x13;var $x14 = $x2.bodies;$x11.bodies = $x14;var $x15 = $x2.bodies_count;$x11.bodies_count = $x15;$x0.game_map = $x11; break; } case "Some": { var $x16 = $x3.value;var $got$0 = $x16.hero;var $x17 = $got$0;var $x18 = $x17.body_id;var $x19 = $x2.bodies;var $hero_body$1 = $UG$SIPD$Body$get_body$($x18, $x19);var $x20 = $hero_body$1;switch ($x20.$) { case "None": { var $x0 = ({$: "State"});var $x21 = $x1.next_id;$x0.next_id = $x21;var $x22 = $x1.tick;$x0.tick = $x22;var $x23 = $x1.players;$x0.players = $x23;var $x24 = $x1.hero_states;$x0.hero_states = $x24;var $x25 = ({$: "GameMap"});var $x26 = $x2.width;$x25.width = $x26;var $x27 = $x2.height;$x25.height = $x27;var $x28 = $x2.bodies;$x25.bodies = $x28;var $x29 = $x2.bodies_count;$x25.bodies_count = $x29;$x0.game_map = $x25; break; } case "Some": { var $got$2 = $x20.value;var $x30 = $got$2;var $x31 = $x30.hitbox;var $hero_pos$3 = $UG$Shape$get_center$($x31);var $x32 = ({$: "Player"});var $x33 = $x16.id;$x32.id = $x33;var $x34 = $x16.name;$x32.name = $x34;var $x35 = $x16.keys;$x32.keys = $x35;var $x36 = $x16.target;$x32.target = $x36;var $x37 = $x16.hero;$x32.hero = $x37;var $x38 = JSTR_TO_LIST(`R`);var $target$4 = $UG$SIPD$Player$get_mouse_pos$($x32, $x38);var $x41 = $target$4;var $x42 = $hero_pos$3;var $x40 = $V2$sub$($x41, $x42);var $x39 = $V2$normalize$($x40);var $direction$5 = $V2$round$($x39);var $x44 = $hero_pos$3;var $x46 = $direction$5;var $x47 = _$3;var $x45 = $V2$mul_scalar$($x46, $x47);var $x43 = $V2$add$($x44, $x45);var $line_end$6 = $V2$round$($x43);var $x48 = ({$: "State"});var $x49 = $x1.next_id;$x48.next_id = $x49;var $x50 = $x1.tick;$x48.tick = $x50;var $x51 = $x1.players;$x48.players = $x51;var $x52 = $x1.hero_states;$x48.hero_states = $x52;var $x53 = ({$: "GameMap"});var $x54 = $x2.width;$x53.width = $x54;var $x55 = $x2.height;$x53.height = $x55;var $x56 = $x2.bodies;$x53.bodies = $x56;var $x57 = $x2.bodies_count;$x53.bodies_count = $x57;$x48.game_map = $x53;var $got$7 = $UG$SIPD$State$generate_id$($x48);var $x58 = $got$7;var $x59 = $x58.fst;var $x60 = _$0;var $x61 = _$2;var $x62 = _$3;var $x63 = _$4;var $x64 = $hero_pos$3;var $x65 = $line_end$6;var $x66 = $x30.side;var $disintegrate_line$8 = $disintegrate$create_disintegrate_line$($x59, $x60, $x61, $x62, $x63, $x64, $x65, $x66);var $dmg_per_tick$9 = 1n;var $x67 = $UG$SIPD$Effect$spawn_body;var $x68 = $disintegrate_line$8;var $spawn_effect$10 = ($x67)($x68);var $x71 = $UG$SIPD$Effect$with_duration;var $x72 = _$1;var $x70 = ($x71)($x72);var $x73 = $x58.fst;var $x69 = ($x70)($x73);var $x77 = $UG$SIPD$Effect$collide_and_dps;var $x78 = $x30.id;var $x76 = ($x77)($x78);var $x79 = $x58.fst;var $x75 = ($x76)($x79);var $x80 = $dmg_per_tick$9;var $x74 = ($x75)($x80);var $with_duration$11 = ($x69)($x74);var $x81 = $spawn_effect$10;var $x82 = $x58.snd;var $state$12 = $UG$SIPD$Effect$apply$($x81, $x82);var $x83 = _$1;var $x84 = _$0;var $x85 = $state$12;var $state$13 = $disintegrate$block_player_movement$($x83, $x84, $x85);var $x86 = $with_duration$11;var $x87 = $state$13;var $state$14 = $UG$SIPD$Effect$apply$($x86, $x87);var $x0 = $state$14; break; } } break; } }return $x0; }
const $UG$SIPD$Effect$disintegrate = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $UG$SIPD$Effect$disintegrate$(_$0,_$1,_$2,_$3,_$4,_$5)

function $V2$mul$(_$0/*:V2*/,_$1/*:V2*/) {var $x1 = _$0;var $x2 = _$1;var $x0 = ({$: "V2"});var $x4 = $x1.x;var $x5 = $x2.x;var $x3 = $F64$mul$($x4, $x5);$x0.x = $x3;var $x7 = $x1.y;var $x8 = $x2.y;var $x6 = $F64$mul$($x7, $x8);$x0.y = $x6;return $x0; }
const $V2$mul = _$0 => _$1 => $V2$mul$(_$0,_$1)

function $knockback$handle_collidable$(_$0/*:V2*/,_$1/*:BigInt*/,_$2/*:UG/SIPD/Body*/,_$3/*:UG/SIPD/Body*/,_$4/*:UG/SIPD/State*/) {var $x1 = _$2;var $x2 = _$3;var $x3 = $x2.collidable;switch ($x3.$) { case "TakesEffects": { var $got$0 = _$4;var $x4 = $got$0;var $x5 = $UG$SIPD$Player;var $x6 = $x4.players;var $x7 = $x2.id;var $maybe_player$1 = $Map$get$($x5, $x6, $x7);var $x8 = $maybe_player$1;switch ($x8.$) { case "None": { var $x0 = _$4; break; } case "Some": { var $got$2 = $x8.value;var $x9 = $got$2;var $x10 = $x1.hitbox;var $center1$3 = $UG$Shape$get_center$($x10);var $x11 = $x2.hitbox;var $center2$4 = $UG$Shape$get_center$($x11);var $x13 = $center2$4;var $x14 = $center1$3;var $x12 = $V2$sub$($x13, $x14);var $knockback_vector$5 = $V2$normalize$($x12);var $x15 = $knockback_vector$5;var $x16 = _$0;var $scaled_knockback$6 = $V2$mul$($x15, $x16);var $x17 = $x2.hitbox;var $x18 = $scaled_knockback$6;var $new_hitbox$7 = $UG$Shape$move$($x17, $x18);var $x19 = $new_hitbox$7;var $new_target$8 = $UG$Shape$get_center$($x19);var $x20 = $UG$SIPD$Hero$HeroState;var $x21 = $x4.hero_states;var $x22 = $x9.id;var $maybe_hero_state$9 = $Map$get$($x20, $x21, $x22);var $x23 = $maybe_hero_state$9;switch ($x23.$) { case "None": { var $x0 = _$4; break; } case "Some": { var $got$10 = $x23.value;var $x24 = $got$10;var $x25 = $x24.health;var $x26 = _$1;var $new_hp$11 = $U64$sub$($x25, $x26);var $x27 = $UG$SIPD$Hero$HeroState;var $x28 = $x4.hero_states;var $x29 = $x9.id;var $x30 = ({$: "HeroState"});var $x31 = $x24.cooldowns;$x30.cooldowns = $x31;var $x32 = $new_hp$11;$x30.health = $x32;var $updated_hero_states$12 = $Map$insert$($x27, $x28, $x29, $x30);var $x33 = $UG$SIPD$Player;var $x34 = $x4.players;var $x35 = $x9.id;var $x36 = ({$: "Player"});var $x37 = $x9.id;$x36.id = $x37;var $x38 = $x9.name;$x36.name = $x38;var $x39 = $x9.keys;$x36.keys = $x39;var $x40 = $new_target$8;$x36.target = $x40;var $x41 = $x9.hero;$x36.hero = $x41;var $updated_players$13 = $Map$insert$($x33, $x34, $x35, $x36);var $x42 = $x4.game_map;var $x43 = ({$: "Body"});var $x44 = $x2.id;$x43.id = $x44;var $x45 = $new_hitbox$7;$x43.hitbox = $x45;var $x46 = $x2.tick;$x43.tick = $x46;var $x47 = $x2.effects;$x43.effects = $x47;var $x48 = $x2.collidable;$x43.collidable = $x48;var $x49 = $x2.side;$x43.side = $x49;var $updated_map$14 = $UG$SIPD$GameMap$update_body$($x42, $x43);var $x52 = $new_hp$11;var $x53 = 0n;var $x51 = $U64$lte$($x52, $x53);var $x55 = _$1;var $x56 = $x24.health;var $x54 = $U64$gte$($x55, $x56);var $x50 = $Bool$or$($x51, $x54);switch ($x50.$) { case "True": { var $x57 = ({$: "State"});var $x58 = $x4.next_id;$x57.next_id = $x58;var $x59 = $x4.tick;$x57.tick = $x59;var $x60 = $updated_players$13;$x57.players = $x60;var $x61 = $updated_hero_states$12;$x57.hero_states = $x61;var $x62 = $updated_map$14;$x57.game_map = $x62;var $x63 = $x2.id;var $x0 = $UG$SIPD$State$delete_body$($x57, $x63); break; } case "False": { var $x0 = ({$: "State"});var $x64 = $x4.next_id;$x0.next_id = $x64;var $x65 = $x4.tick;$x0.tick = $x65;var $x66 = $updated_players$13;$x0.players = $x66;var $x67 = $updated_hero_states$12;$x0.hero_states = $x67;var $x68 = $updated_map$14;$x0.game_map = $x68; break; } } break; } } break; } } break; } default: { var $x0 = _$4; break; } }return $x0; }
const $knockback$handle_collidable = _$0 => _$1 => _$2 => _$3 => _$4 => $knockback$handle_collidable$(_$0,_$1,_$2,_$3,_$4)

function $UG$SIPD$Effect$knockback$go$(_$0/*:BigInt*/,_$1/*:V2*/,_$2/*:BigInt*/,_$3/*:UG/SIPD/Body*/,_$4/*:List<Pair<V2><UG/SIPD/Body>>*/) {var $x1 = _$4;switch ($x1.$) { case "Cons": { var $x2 = $x1.head;var $x0 = ($state$0 => {var $got$1 = $x2.snd;var $x4 = $got$1;var $x6 = _$0;var $x7 = $x4.id;var $x5 = $U64$eq$($x6, $x7);switch ($x5.$) { case "True": { var $new_state$2 = $state$0;var $x9 = _$0;var $x10 = _$1;var $x11 = _$2;var $x12 = _$3;var $x13 = $x1.tail;var $x8 = $UG$SIPD$Effect$knockback$go$($x9, $x10, $x11, $x12, $x13);var $x14 = $new_state$2;var $x3 = ($x8)($x14); break; } case "False": { var $x15 = _$1;var $x16 = _$2;var $x17 = _$3;var $x18 = $x2.snd;var $x19 = $state$0;var $new_state$2 = $knockback$handle_collidable$($x15, $x16, $x17, $x18, $x19);var $x21 = _$0;var $x22 = _$1;var $x23 = _$2;var $x24 = _$3;var $x25 = $x1.tail;var $x20 = $UG$SIPD$Effect$knockback$go$($x21, $x22, $x23, $x24, $x25);var $x26 = $new_state$2;var $x3 = ($x20)($x26); break; } }return $x3;}); break; } case "Nil": { var $x0 = ($state$0 => {var $x27 = $state$0;return $x27;}); break; } }return $x0; }
const $UG$SIPD$Effect$knockback$go = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Effect$knockback$go$(_$0,_$1,_$2,_$3,_$4)

function $UG$SIPD$Effect$knockback$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:V2*/,_$3/*:BigInt*/,_$4/*:UG/SIPD/State*/) {var $got$0 = _$4;var $x1 = $got$0;var $got$1 = $x1.game_map;var $x2 = $got$1;var $x3 = $UG$SIPD$Body;var $x4 = $x2.bodies;var $x5 = $x2.bodies_count;var $bodies_list$2 = $Map$values$($x3, $x4, $x5);var $x7 = $x2.bodies;var $x8 = _$1;var $x6 = $UG$SIPD$GameMap$get_body$($x7, $x8);switch ($x6.$) { case "Some": { var $got$3 = $x6.value;var $x9 = $got$3;var $x10 = _$0;var $x11 = $x6.value;var $x12 = $bodies_list$2;var $collision_results$4 = $UG$SIPD$Body$find_collision$($x10, $x11, $x12);var $x14 = _$0;var $x15 = _$2;var $x16 = _$3;var $x17 = $x6.value;var $x18 = $collision_results$4;var $x13 = $UG$SIPD$Effect$knockback$go$($x14, $x15, $x16, $x17, $x18);var $x19 = _$4;var $x0 = ($x13)($x19); break; } case "None": { var $x0 = _$4; break; } }return $x0; }
const $UG$SIPD$Effect$knockback = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Effect$knockback$(_$0,_$1,_$2,_$3,_$4)

function $V2$perpendicular$(_$0/*:V2*/) {var $x1 = _$0;var $x0 = ({$: "V2"});var $x3 = $x1.y;var $x2 = $F64$negate$($x3);$x0.x = $x2;var $x4 = $x1.x;$x0.y = $x4;return $x0; }
const $V2$perpendicular = _$0 => $V2$perpendicular$(_$0)

function $magic_missiles$calculate_targets$(_$0/*:V2*/,_$1/*:V2*/,_$2/*:Number*/) {var $x3 = _$1;var $x4 = _$0;var $x2 = $V2$sub$($x3, $x4);var $x1 = $V2$normalize$($x2);var $direction$0 = $V2$round$($x1);var $x5 = $direction$0;var $perpend$1 = $V2$perpendicular$($x5);var $x9 = _$1;var $x10 = _$0;var $x8 = $V2$sub$($x9, $x10);var $x6 = $V2$length$($x8);var $x7 = 0.0;var $distance$2 = (Math.round($x6 * Math.pow(10, 2)) / Math.pow(10, 2));var $x14 = 1.0;var $x16 = 1.0;var $x18 = $distance$2;var $x19 = _$2;var $x17 = $F64$div$($x18, $x19);var $x15 = $F64$min$($x16, $x17);var $x13 = $F64$sub$($x14, $x15);var $x20 = 1.0;var $x11 = $F64$mul$($x13, $x20);var $x12 = 0.0;var $spread$3 = (Math.round($x11 * Math.pow(10, 2)) / Math.pow(10, 2));var $x22 = $perpend$1;var $x24 = $spread$3;var $x25 = _$2;var $x23 = $F64$mul$($x24, $x25);var $x21 = $V2$mul_scalar$($x22, $x23);var $side_offset$4 = $V2$round$($x21);var $x26 = _$0;var $x28 = $direction$0;var $x29 = _$2;var $x27 = $V2$mul_scalar$($x28, $x29);var $max_target$5 = $V2$add$($x26, $x27);var $x33 = $max_target$5;var $x34 = $side_offset$4;var $x32 = $V2$sub$($x33, $x34);var $x30 = $V2$length$($x32);var $x31 = 0.0;var $adjusted_range$6 = (Math.round($x30 * Math.pow(10, 2)) / Math.pow(10, 2));var $x36 = _$0;var $x38 = $direction$0;var $x39 = $adjusted_range$6;var $x37 = $V2$mul_scalar$($x38, $x39);var $x35 = $V2$add$($x36, $x37);var $corrected_max_target$7 = $V2$round$($x35);var $x41 = $corrected_max_target$7;var $x42 = $side_offset$4;var $x40 = $V2$sub$($x41, $x42);var $left_target$8 = $V2$round$($x40);var $x44 = $corrected_max_target$7;var $x45 = $side_offset$4;var $x43 = $V2$add$($x44, $x45);var $right_target$9 = $V2$round$($x43);var $x0 = ({$: "Pair"});var $x46 = $corrected_max_target$7;$x0.fst = $x46;var $x47 = ({$: "Pair"});var $x48 = $left_target$8;$x47.fst = $x48;var $x49 = $right_target$9;$x47.snd = $x49;$x0.snd = $x47;return $x0; }
const $magic_missiles$calculate_targets = _$0 => _$1 => _$2 => $magic_missiles$calculate_targets$(_$0,_$1,_$2)

function $UG$Shape$circle$(_$0/*:V2*/,_$1/*:Number*/) {var $x0 = ({$: "Circle"});var $x1 = _$0;$x0.center = $x1;var $x2 = _$1;$x0.radius = $x2;return $x0; }
const $UG$Shape$circle = _$0 => _$1 => $UG$Shape$circle$(_$0,_$1)

function $magic_missiles$tick_projectile$(_$0/*:BigInt*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$1;var $x2 = $x1.game_map;var $x4 = _$0;var $x5 = $x2.bodies;var $x3 = $UG$SIPD$Body$get_body$($x4, $x5);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = ({$: "GameMap"});var $x11 = $x2.width;$x10.width = $x11;var $x12 = $x2.height;$x10.height = $x12;var $x13 = $x2.bodies;$x10.bodies = $x13;var $x14 = $x2.bodies_count;$x10.bodies_count = $x14;$x0.game_map = $x10; break; } case "Some": { var $x15 = $x3.value;var $x16 = ({$: "State"});var $x17 = $x1.next_id;$x16.next_id = $x17;var $x18 = $x1.tick;$x16.tick = $x18;var $x19 = $x1.players;$x16.players = $x19;var $x20 = $x1.hero_states;$x16.hero_states = $x20;var $x21 = ({$: "GameMap"});var $x22 = $x2.width;$x21.width = $x22;var $x23 = $x2.height;$x21.height = $x23;var $x24 = $x2.bodies;$x21.bodies = $x24;var $x25 = $x2.bodies_count;$x21.bodies_count = $x25;$x16.game_map = $x21;var $x0 = $UG$SIPD$Body$apply_effects$($x15, $x16); break; } }return $x0; }
const $magic_missiles$tick_projectile = _$0 => _$1 => $magic_missiles$tick_projectile$(_$0,_$1)

function $magic_missiles$create_projectile$(_$0/*:BigInt*/,_$1/*:V2*/,_$2/*:V2*/,_$3/*:Number*/,_$4/*:UG/SIPD/Side*/) {var $x0 = ({$: "Body"});var $x1 = _$0;$x0.id = $x1;var $x3 = _$1;var $x4 = _$3;var $x2 = $UG$Shape$circle$($x3, $x4);$x0.hitbox = $x2;var $x6 = $magic_missiles$tick_projectile;var $x7 = _$0;var $x5 = ($x6)($x7);$x0.tick = $x5;var $x8 = ({$: "Nil"});$x0.effects = $x8;var $x9 = ({$: "Untouchable"});$x0.collidable = $x9;var $x10 = _$4;$x0.side = $x10;return $x0; }
const $magic_missiles$create_projectile = _$0 => _$1 => _$2 => _$3 => _$4 => $magic_missiles$create_projectile$(_$0,_$1,_$2,_$3,_$4)

function $magic_missiles$go$(_$0/*:UG/SIPD/Body*/,_$1/*:UG/SIPD/Player*/,_$2/*:Number*/,_$3/*:BigInt*/,_$4/*:Number*/,_$5/*:UG/SIPD/State*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = $x1.hitbox;var $hero_pos$0 = $UG$Shape$get_center$($x3);var $x4 = ({$: "Player"});var $x5 = $x2.id;$x4.id = $x5;var $x6 = $x2.name;$x4.name = $x6;var $x7 = $x2.keys;$x4.keys = $x7;var $x8 = $x2.target;$x4.target = $x8;var $x9 = $x2.hero;$x4.hero = $x9;var $x10 = JSTR_TO_LIST(`Q`);var $mouse_pos$1 = $UG$SIPD$Player$get_mouse_pos$($x4, $x10);var $click_pos$2 = $x2.target;var $x13 = $mouse_pos$1;var $x14 = $hero_pos$0;var $x12 = $V2$sub$($x13, $x14);var $x11 = $V2$normalize$($x12);var $direction$3 = $V2$round$($x11);var $x15 = $direction$3;var $perpend$4 = $V2$perpendicular$($x15);var $offset_distance$5 = 40.0;var $x17 = $hero_pos$0;var $x20 = $direction$3;var $x21 = $offset_distance$5;var $x19 = $V2$mul_scalar$($x20, $x21);var $x23 = $perpend$4;var $x25 = 30.0;var $x24 = $F64$negate$($x25);var $x22 = $V2$mul_scalar$($x23, $x24);var $x18 = $V2$add$($x19, $x22);var $x16 = $V2$add$($x17, $x18);var $left_missile_pos$6 = $V2$round$($x16);var $x27 = $hero_pos$0;var $x30 = $direction$3;var $x31 = $offset_distance$5;var $x29 = $V2$mul_scalar$($x30, $x31);var $x33 = $perpend$4;var $x34 = 30.0;var $x32 = $V2$mul_scalar$($x33, $x34);var $x28 = $V2$add$($x29, $x32);var $x26 = $V2$add$($x27, $x28);var $right_missile_pos$7 = $V2$round$($x26);var $x36 = $hero_pos$0;var $x38 = $direction$3;var $x39 = $offset_distance$5;var $x37 = $V2$mul_scalar$($x38, $x39);var $x35 = $V2$add$($x36, $x37);var $center_missile_pos$8 = $V2$round$($x35);var $x40 = $hero_pos$0;var $x41 = $mouse_pos$1;var $x42 = _$2;var $got$9 = $magic_missiles$calculate_targets$($x40, $x41, $x42);var $x43 = $got$9;var $got$10 = $x43.snd;var $x44 = $got$10;var $x45 = _$5;var $got$11 = $UG$SIPD$State$generate_id$($x45);var $x46 = $got$11;var $x47 = $x46.fst;var $x48 = $center_missile_pos$8;var $x49 = $x43.fst;var $x50 = _$4;var $x51 = $x1.side;var $projectile1$12 = $magic_missiles$create_projectile$($x47, $x48, $x49, $x50, $x51);var $x52 = $x46.snd;var $got$13 = $UG$SIPD$State$generate_id$($x52);var $x53 = $got$13;var $x54 = $x53.fst;var $x55 = $left_missile_pos$6;var $x56 = $x44.fst;var $x57 = _$4;var $x58 = $x1.side;var $projectile2$14 = $magic_missiles$create_projectile$($x54, $x55, $x56, $x57, $x58);var $x59 = $x53.snd;var $got$15 = $UG$SIPD$State$generate_id$($x59);var $x60 = $got$15;var $x61 = $x60.fst;var $x62 = $right_missile_pos$7;var $x63 = $x44.snd;var $x64 = _$4;var $x65 = $x1.side;var $projectile3$16 = $magic_missiles$create_projectile$($x61, $x62, $x63, $x64, $x65);var $speed$17 = 1.0;var $acceleration$18 = 0.1;var $x66 = $UG$SIPD$Effect$spawn_body;var $x67 = $projectile1$12;var $spawn_effect1$19 = ($x66)($x67);var $x74 = $UG$SIPD$Effect$accelerated_move_range;var $x75 = $x46.fst;var $x73 = ($x74)($x75);var $x76 = $speed$17;var $x72 = ($x73)($x76);var $x77 = $x43.fst;var $x71 = ($x72)($x77);var $x78 = _$2;var $x70 = ($x71)($x78);var $x79 = $acceleration$18;var $x69 = ($x70)($x79);var $x80 = _$3;var $x68 = ($x69)($x80);var $x84 = $UG$SIPD$Effect$collide_and_damage;var $x85 = $x2.id;var $x83 = ($x84)($x85);var $x86 = $x46.fst;var $x82 = ($x83)($x86);var $x87 = 147n;var $x81 = ($x82)($x87);var $move_effect1$20 = ($x68)($x81);var $x88 = $UG$SIPD$Effect$spawn_body;var $x89 = $projectile2$14;var $spawn_effect2$21 = ($x88)($x89);var $x96 = $UG$SIPD$Effect$accelerated_move_range;var $x97 = $x53.fst;var $x95 = ($x96)($x97);var $x98 = $speed$17;var $x94 = ($x95)($x98);var $x99 = $x44.fst;var $x93 = ($x94)($x99);var $x100 = _$2;var $x92 = ($x93)($x100);var $x101 = $acceleration$18;var $x91 = ($x92)($x101);var $x102 = _$3;var $x90 = ($x91)($x102);var $x106 = $UG$SIPD$Effect$collide_and_damage;var $x107 = $x2.id;var $x105 = ($x106)($x107);var $x108 = $x53.fst;var $x104 = ($x105)($x108);var $x109 = 147n;var $x103 = ($x104)($x109);var $move_effect2$22 = ($x90)($x103);var $x110 = $UG$SIPD$Effect$spawn_body;var $x111 = $projectile3$16;var $spawn_effect3$23 = ($x110)($x111);var $x118 = $UG$SIPD$Effect$accelerated_move_range;var $x119 = $x60.fst;var $x117 = ($x118)($x119);var $x120 = $speed$17;var $x116 = ($x117)($x120);var $x121 = $x44.snd;var $x115 = ($x116)($x121);var $x122 = _$2;var $x114 = ($x115)($x122);var $x123 = $acceleration$18;var $x113 = ($x114)($x123);var $x124 = _$3;var $x112 = ($x113)($x124);var $x128 = $UG$SIPD$Effect$collide_and_damage;var $x129 = $x2.id;var $x127 = ($x128)($x129);var $x130 = $x60.fst;var $x126 = ($x127)($x130);var $x131 = 147n;var $x125 = ($x126)($x131);var $move_effect3$24 = ($x112)($x125);var $x132 = $spawn_effect1$19;var $x133 = $x60.snd;var $state$25 = $UG$SIPD$Effect$apply$($x132, $x133);var $x134 = $spawn_effect2$21;var $x135 = $state$25;var $state$26 = $UG$SIPD$Effect$apply$($x134, $x135);var $x136 = $spawn_effect3$23;var $x137 = $state$26;var $state$27 = $UG$SIPD$Effect$apply$($x136, $x137);var $x138 = $move_effect1$20;var $x139 = $state$27;var $state$28 = $UG$SIPD$Effect$apply$($x138, $x139);var $x140 = $move_effect2$22;var $x141 = $state$28;var $state$29 = $UG$SIPD$Effect$apply$($x140, $x141);var $x142 = $move_effect3$24;var $x143 = $state$29;var $state$30 = $UG$SIPD$Effect$apply$($x142, $x143);var $x0 = $state$30;return $x0; }
const $magic_missiles$go = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $magic_missiles$go$(_$0,_$1,_$2,_$3,_$4,_$5)

function $UG$SIPD$Effect$magic_missiles$(_$0/*:BigInt*/,_$1/*:Number*/,_$2/*:BigInt*/,_$3/*:Number*/,_$4/*:UG/SIPD/State*/) {var $x1 = _$4;var $x2 = $x1.game_map;var $x4 = $UG$SIPD$Player;var $x5 = $x1.players;var $x6 = _$0;var $x3 = $Map$get$($x4, $x5, $x6);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x7 = $x1.next_id;$x0.next_id = $x7;var $x8 = $x1.tick;$x0.tick = $x8;var $x9 = $x1.players;$x0.players = $x9;var $x10 = $x1.hero_states;$x0.hero_states = $x10;var $x11 = ({$: "GameMap"});var $x12 = $x2.width;$x11.width = $x12;var $x13 = $x2.height;$x11.height = $x13;var $x14 = $x2.bodies;$x11.bodies = $x14;var $x15 = $x2.bodies_count;$x11.bodies_count = $x15;$x0.game_map = $x11; break; } case "Some": { var $x16 = $x3.value;var $x17 = $x16.hero;var $x19 = $x17.body_id;var $x20 = $x2.bodies;var $x18 = $UG$SIPD$Body$get_body$($x19, $x20);switch ($x18.$) { case "None": { var $x0 = ({$: "State"});var $x21 = $x1.next_id;$x0.next_id = $x21;var $x22 = $x1.tick;$x0.tick = $x22;var $x23 = $x1.players;$x0.players = $x23;var $x24 = $x1.hero_states;$x0.hero_states = $x24;var $x25 = ({$: "GameMap"});var $x26 = $x2.width;$x25.width = $x26;var $x27 = $x2.height;$x25.height = $x27;var $x28 = $x2.bodies;$x25.bodies = $x28;var $x29 = $x2.bodies_count;$x25.bodies_count = $x29;$x0.game_map = $x25; break; } case "Some": { var $x30 = $x18.value;var $x31 = ({$: "Player"});var $x32 = $x16.id;$x31.id = $x32;var $x33 = $x16.name;$x31.name = $x33;var $x34 = $x16.keys;$x31.keys = $x34;var $x35 = $x16.target;$x31.target = $x35;var $x36 = ({$: "Hero"});var $x37 = $x17.owner_id;$x36.owner_id = $x37;var $x38 = $x17.name;$x36.name = $x38;var $x39 = $x17.skills;$x36.skills = $x39;var $x40 = $x17.body_id;$x36.body_id = $x40;$x31.hero = $x36;var $x41 = _$1;var $x42 = _$2;var $x43 = _$3;var $x44 = ({$: "State"});var $x45 = $x1.next_id;$x44.next_id = $x45;var $x46 = $x1.tick;$x44.tick = $x46;var $x47 = $x1.players;$x44.players = $x47;var $x48 = $x1.hero_states;$x44.hero_states = $x48;var $x49 = ({$: "GameMap"});var $x50 = $x2.width;$x49.width = $x50;var $x51 = $x2.height;$x49.height = $x51;var $x52 = $x2.bodies;$x49.bodies = $x52;var $x53 = $x2.bodies_count;$x49.bodies_count = $x53;$x44.game_map = $x49;var $x0 = $magic_missiles$go$($x30, $x31, $x41, $x42, $x43, $x44); break; } } break; } }return $x0; }
const $UG$SIPD$Effect$magic_missiles = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Effect$magic_missiles$(_$0,_$1,_$2,_$3,_$4)

function $UG$SIPD$Effect$move$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:UG/SIPD/State*/) {var $x1 = _$2;var $x2 = $x1.game_map;var $x3 = ({$: "Pair"});var $x5 = $UG$SIPD$Player;var $x6 = $x1.players;var $x7 = _$0;var $x4 = $Map$get$($x5, $x6, $x7);$x3.fst = $x4;var $x9 = $x2.bodies;var $x10 = _$1;var $x8 = $UG$SIPD$GameMap$get_body$($x9, $x10);$x3.snd = $x8;var $x11 = $x3.fst;switch ($x11.$) { case "None": { var $x12 = $x3.snd;switch ($x12.$) { case "None": { var $x0 = ({$: "State"});var $x13 = $x1.next_id;$x0.next_id = $x13;var $x14 = $x1.tick;$x0.tick = $x14;var $x15 = $x1.players;$x0.players = $x15;var $x16 = $x1.hero_states;$x0.hero_states = $x16;var $x17 = ({$: "GameMap"});var $x18 = $x2.width;$x17.width = $x18;var $x19 = $x2.height;$x17.height = $x19;var $x20 = $x2.bodies;$x17.bodies = $x20;var $x21 = $x2.bodies_count;$x17.bodies_count = $x21;$x0.game_map = $x17; break; } default: { var $x0 = ({$: "State"});var $x22 = $x1.next_id;$x0.next_id = $x22;var $x23 = $x1.tick;$x0.tick = $x23;var $x24 = $x1.players;$x0.players = $x24;var $x25 = $x1.hero_states;$x0.hero_states = $x25;var $x26 = ({$: "GameMap"});var $x27 = $x2.width;$x26.width = $x27;var $x28 = $x2.height;$x26.height = $x28;var $x29 = $x2.bodies;$x26.bodies = $x29;var $x30 = $x2.bodies_count;$x26.bodies_count = $x30;$x0.game_map = $x26; break; } } break; } case "Some": { var $x31 = $x11.value;switch ($x31.$) { case "Player": { var $x32 = $x3.snd;switch ($x32.$) { case "None": { var $x0 = ({$: "State"});var $x33 = $x1.next_id;$x0.next_id = $x33;var $x34 = $x1.tick;$x0.tick = $x34;var $x35 = $x1.players;$x0.players = $x35;var $x36 = $x1.hero_states;$x0.hero_states = $x36;var $x37 = ({$: "GameMap"});var $x38 = $x2.width;$x37.width = $x38;var $x39 = $x2.height;$x37.height = $x39;var $x40 = $x2.bodies;$x37.bodies = $x40;var $x41 = $x2.bodies_count;$x37.bodies_count = $x41;$x0.game_map = $x37; break; } case "Some": { var $x42 = $x32.value;var $old_bodies_count$0 = $x2.bodies_count;var $x43 = $x42.hitbox;var $hitbox_center$1 = $UG$Shape$get_center$($x43);var $x44 = $x31.target;var $x45 = $hitbox_center$1;var $distance_to_target$2 = $V2$sub$($x44, $x45);var $x46 = $distance_to_target$2;var $ln$3 = $V2$length$($x46);var $x48 = $ln$3;var $x49 = 0.1;var $x47 = $F64$lt$($x48, $x49);switch ($x47.$) { case "True": { var $x0 = ({$: "State"});var $x50 = $x1.next_id;$x0.next_id = $x50;var $x51 = $x1.tick;$x0.tick = $x51;var $x52 = $x1.players;$x0.players = $x52;var $x53 = $x1.hero_states;$x0.hero_states = $x53;var $x54 = ({$: "GameMap"});var $x55 = $x2.width;$x54.width = $x55;var $x56 = $x2.height;$x54.height = $x56;var $x57 = $x2.bodies;$x54.bodies = $x57;var $x58 = $old_bodies_count$0;$x54.bodies_count = $x58;$x0.game_map = $x54; break; } case "False": { var $constant_speed$4 = 1.15;var $x59 = $distance_to_target$2;var $direction$5 = $V2$normalize$($x59);var $x61 = $direction$5;var $x63 = $constant_speed$4;var $x64 = $ln$3;var $x62 = $F64$min$($x63, $x64);var $x60 = $V2$mul_scalar$($x61, $x62);var $movement$6 = $V2$round$($x60);var $x65 = $UG$SIPD$Body;var $x66 = $x2.bodies;var $x67 = $x2.bodies_count;var $bodies_list$7 = $Map$values$($x65, $x66, $x67);var $x68 = ({$: "Body"});var $x69 = $x42.id;$x68.id = $x69;var $x70 = $x42.hitbox;$x68.hitbox = $x70;var $x71 = $x42.tick;$x68.tick = $x71;var $x72 = $x42.effects;$x68.effects = $x72;var $x73 = $x42.collidable;$x68.collidable = $x73;var $x74 = $x42.side;$x68.side = $x74;var $x75 = $movement$6;var $x76 = $bodies_list$7;var $got$8 = $UG$Collision$collide_and_slide$($x68, $x75, $x76);var $x77 = $got$8;var $x78 = $x42.hitbox;var $x81 = $x77.fst;var $x80 = $V2$round$($x81);var $x82 = $hitbox_center$1;var $x79 = $V2$sub$($x80, $x82);var $new_hitbox$9 = $UG$Shape$move$($x78, $x79);var $x83 = ({$: "GameMap"});var $x84 = $x2.width;$x83.width = $x84;var $x85 = $x2.height;$x83.height = $x85;var $x86 = $x2.bodies;$x83.bodies = $x86;var $x87 = $x2.bodies_count;$x83.bodies_count = $x87;var $x88 = ({$: "Body"});var $x89 = $x42.id;$x88.id = $x89;var $x90 = $new_hitbox$9;$x88.hitbox = $x90;var $x91 = $x42.tick;$x88.tick = $x91;var $x92 = $x42.effects;$x88.effects = $x92;var $x93 = $x42.collidable;$x88.collidable = $x93;var $x94 = $x42.side;$x88.side = $x94;var $updated_map$10 = $UG$SIPD$GameMap$insert_body$($x83, $x88);var $x0 = ({$: "State"});var $x95 = $x1.next_id;$x0.next_id = $x95;var $x96 = $x1.tick;$x0.tick = $x96;var $x97 = $x1.players;$x0.players = $x97;var $x98 = $x1.hero_states;$x0.hero_states = $x98;var $x99 = $updated_map$10;$x0.game_map = $x99; break; } } break; } } break; } default: { var $x101 = /*Type*/null;var $x102 = $x31;var $x100 = ($x101)($x102);var $x103 = $x3.snd;var $x0 = ($x100)($x103); break; } } break; } default: { var $x105 = /*Type*/null;var $x106 = $x11;var $x104 = ($x105)($x106);var $x107 = $x3.snd;var $x0 = ($x104)($x107); break; } }return $x0; }
const $UG$SIPD$Effect$move = _$0 => _$1 => _$2 => $UG$SIPD$Effect$move$(_$0,_$1,_$2)

function $UG$SIPD$Effect$move_range$(_$0/*:BigInt*/,_$1/*:Number*/,_$2/*:V2*/,_$3/*:Number*/,_$4/*:BigInt*/,_$5/*:UG/SIPD/Effect*/,_$6/*:UG/SIPD/State*/) {var $x1 = _$6;var $x2 = $x1.game_map;var $x4 = _$0;var $x5 = $x2.bodies;var $x3 = $UG$SIPD$Body$get_body$($x4, $x5);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = ({$: "GameMap"});var $x11 = $x2.width;$x10.width = $x11;var $x12 = $x2.height;$x10.height = $x12;var $x13 = $x2.bodies;$x10.bodies = $x13;var $x14 = $x2.bodies_count;$x10.bodies_count = $x14;$x0.game_map = $x10; break; } case "Some": { var $x15 = $x3.value;var $x16 = $x15.hitbox;var $hitbox_center$0 = $UG$Shape$get_center$($x16);var $x18 = _$2;var $x19 = $hitbox_center$0;var $x17 = $V2$sub$($x18, $x19);var $distance_to_target$1 = $V2$round$($x17);var $x22 = $distance_to_target$1;var $x20 = $V2$length$($x22);var $x21 = 0.0;var $ln$2 = (Math.round($x20 * Math.pow(10, 2)) / Math.pow(10, 2));var $x25 = $ln$2;var $x26 = 1.0;var $x24 = $F64$lt$($x25, $x26);var $x28 = _$3;var $x29 = 0.0;var $x27 = $F64$lte$($x28, $x29);var $x23 = $Bool$or$($x24, $x27);switch ($x23.$) { case "True": { var $x30 = ({$: "State"});var $x31 = $x1.next_id;$x30.next_id = $x31;var $x32 = $x1.tick;$x30.tick = $x32;var $x33 = $x1.players;$x30.players = $x33;var $x34 = $x1.hero_states;$x30.hero_states = $x34;var $x35 = ({$: "GameMap"});var $x36 = $x2.width;$x35.width = $x36;var $x37 = $x2.height;$x35.height = $x37;var $x38 = $x2.bodies;$x35.bodies = $x38;var $x39 = $x2.bodies_count;$x35.bodies_count = $x39;$x30.game_map = $x35;var $x40 = _$0;var $x0 = $UG$SIPD$State$delete_body$($x30, $x40); break; } case "False": { var $constant_speed$3 = _$1;var $x41 = $constant_speed$3;var $x42 = _$3;var $move_distance$4 = $F64$min$($x41, $x42);var $x44 = $distance_to_target$1;var $x43 = $V2$normalize$($x44);var $direction$5 = $V2$round$($x43);var $x46 = $direction$5;var $x47 = $move_distance$4;var $x45 = $V2$mul_scalar$($x46, $x47);var $movement$6 = $V2$round$($x45);var $x48 = $x15.hitbox;var $x49 = $movement$6;var $new_hitbox$7 = $UG$Shape$move$($x48, $x49);var $x50 = ({$: "State"});var $x51 = $x1.next_id;$x50.next_id = $x51;var $x52 = $x1.tick;$x50.tick = $x52;var $x53 = $x1.players;$x50.players = $x53;var $x54 = $x1.hero_states;$x50.hero_states = $x54;var $x55 = ({$: "GameMap"});var $x56 = $x2.width;$x55.width = $x56;var $x57 = $x2.height;$x55.height = $x57;var $x58 = $x2.bodies;$x55.bodies = $x58;var $x59 = $x2.bodies_count;$x55.bodies_count = $x59;$x50.game_map = $x55;var $x60 = ({$: "Body"});var $x61 = $x15.id;$x60.id = $x61;var $x62 = $new_hitbox$7;$x60.hitbox = $x62;var $x63 = $x15.tick;$x60.tick = $x63;var $x64 = $x15.effects;$x60.effects = $x64;var $x65 = $x15.collidable;$x60.collidable = $x65;var $x66 = $x15.side;$x60.side = $x66;var $updated_state$8 = $UG$SIPD$State$update_body$($x50, $x60);var $x67 = _$5;var $x68 = $updated_state$8;var $state$9 = $UG$SIPD$Effect$apply$($x67, $x68);var $x70 = _$4;var $x71 = 0n;var $x69 = $U64$gt$($x70, $x71);switch ($x69.$) { case "True": { var $x77 = $UG$SIPD$Effect$move_range;var $x78 = _$0;var $x76 = ($x77)($x78);var $x79 = _$1;var $x75 = ($x76)($x79);var $x80 = _$2;var $x74 = ($x75)($x80);var $x81 = _$3;var $x73 = ($x74)($x81);var $x83 = _$4;var $x84 = 1n;var $x82 = BigInt.asUintN(64, $x83 - $x84);var $x72 = ($x73)($x82);var $x85 = _$5;var $new_effect$10 = ($x72)($x85);var $x86 = $state$9;var $x87 = ({$: "Body"});var $x88 = $x15.id;$x87.id = $x88;var $x89 = $new_hitbox$7;$x87.hitbox = $x89;var $x90 = $x15.tick;$x87.tick = $x90;var $x91 = ({$: "Cons"});var $x92 = $new_effect$10;$x91.head = $x92;var $x93 = $x15.effects;$x91.tail = $x93;$x87.effects = $x91;var $x94 = $x15.collidable;$x87.collidable = $x94;var $x95 = $x15.side;$x87.side = $x95;var $x0 = $UG$SIPD$State$update_body$($x86, $x87); break; } case "False": { var $x96 = $state$9;var $x97 = _$0;var $x0 = $UG$SIPD$State$delete_body$($x96, $x97); break; } } break; } } break; } }return $x0; }
const $UG$SIPD$Effect$move_range = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => _$6 => $UG$SIPD$Effect$move_range$(_$0,_$1,_$2,_$3,_$4,_$5,_$6)

function $grow_projectile$(_$0/*:UG/SIPD/State*/,_$1/*:BigInt*/) {var $x1 = _$0;var $x2 = $x1.game_map;var $x4 = _$1;var $x5 = $x2.bodies;var $x3 = $UG$SIPD$Body$get_body$($x4, $x5);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = ({$: "GameMap"});var $x11 = $x2.width;$x10.width = $x11;var $x12 = $x2.height;$x10.height = $x12;var $x13 = $x2.bodies;$x10.bodies = $x13;var $x14 = $x2.bodies_count;$x10.bodies_count = $x14;$x0.game_map = $x10; break; } case "Some": { var $x15 = $x3.value;var $x16 = $x15.hitbox;switch ($x16.$) { case "Circle": { var $growth_factor$0 = 1.5e-2;var $x19 = $x16.radius;var $x21 = $x16.radius;var $x22 = $growth_factor$0;var $x20 = $F64$mul$($x21, $x22);var $x17 = $F64$add$($x19, $x20);var $x18 = 0.0;var $new_radius$1 = (Math.round($x17 * Math.pow(10, 2)) / Math.pow(10, 2));var $x23 = $x16.center;var $x24 = $new_radius$1;var $new_hitbox$2 = $UG$Shape$circle$($x23, $x24);var $x25 = ({$: "State"});var $x26 = $x1.next_id;$x25.next_id = $x26;var $x27 = $x1.tick;$x25.tick = $x27;var $x28 = $x1.players;$x25.players = $x28;var $x29 = $x1.hero_states;$x25.hero_states = $x29;var $x30 = ({$: "GameMap"});var $x31 = $x2.width;$x30.width = $x31;var $x32 = $x2.height;$x30.height = $x32;var $x33 = $x2.bodies;$x30.bodies = $x33;var $x34 = $x2.bodies_count;$x30.bodies_count = $x34;$x25.game_map = $x30;var $x35 = ({$: "Body"});var $x36 = $x15.id;$x35.id = $x36;var $x37 = $new_hitbox$2;$x35.hitbox = $x37;var $x38 = $x15.tick;$x35.tick = $x38;var $x39 = $x15.effects;$x35.effects = $x39;var $x40 = $x15.collidable;$x35.collidable = $x40;var $x41 = $x15.side;$x35.side = $x41;var $x0 = $UG$SIPD$State$insert_body$($x25, $x35); break; } case "Polygon": { var $x0 = ({$: "State"});var $x42 = $x1.next_id;$x0.next_id = $x42;var $x43 = $x1.tick;$x0.tick = $x43;var $x44 = $x1.players;$x0.players = $x44;var $x45 = $x1.hero_states;$x0.hero_states = $x45;var $x46 = ({$: "GameMap"});var $x47 = $x2.width;$x46.width = $x47;var $x48 = $x2.height;$x46.height = $x48;var $x49 = $x2.bodies;$x46.bodies = $x49;var $x50 = $x2.bodies_count;$x46.bodies_count = $x50;$x0.game_map = $x46; break; } } break; } }return $x0; }
const $grow_projectile = _$0 => _$1 => $grow_projectile$(_$0,_$1)

function $tick_projectile$(_$0/*:BigInt*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$1;var $x2 = $x1.game_map;var $x4 = _$0;var $x5 = $x2.bodies;var $x3 = $UG$SIPD$Body$get_body$($x4, $x5);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = ({$: "GameMap"});var $x11 = $x2.width;$x10.width = $x11;var $x12 = $x2.height;$x10.height = $x12;var $x13 = $x2.bodies;$x10.bodies = $x13;var $x14 = $x2.bodies_count;$x10.bodies_count = $x14;$x0.game_map = $x10; break; } case "Some": { var $x15 = $x3.value;var $x16 = ({$: "State"});var $x17 = $x1.next_id;$x16.next_id = $x17;var $x18 = $x1.tick;$x16.tick = $x18;var $x19 = $x1.players;$x16.players = $x19;var $x20 = $x1.hero_states;$x16.hero_states = $x20;var $x21 = ({$: "GameMap"});var $x22 = $x2.width;$x21.width = $x22;var $x23 = $x2.height;$x21.height = $x23;var $x24 = $x2.bodies;$x21.bodies = $x24;var $x25 = $x2.bodies_count;$x21.bodies_count = $x25;$x16.game_map = $x21;var $state$0 = $UG$SIPD$Body$apply_effects$($x15, $x16);var $x26 = $state$0;var $x27 = _$0;var $x0 = $grow_projectile$($x26, $x27); break; } }return $x0; }
const $tick_projectile = _$0 => _$1 => $tick_projectile$(_$0,_$1)

function $shoot$go$(_$0/*:UG/SIPD/Body*/,_$1/*:UG/SIPD/Player*/,_$2/*:Number*/,_$3/*:Number*/,_$4/*:BigInt*/,_$5/*:UG/SIPD/State*/) {var $x1 = _$0;var $x2 = $x1.hitbox;var $hero_pos$0 = $UG$Shape$get_center$($x2);var $x3 = _$1;var $x4 = JSTR_TO_LIST(`W`);var $mouse_pos$1 = $UG$SIPD$Player$get_mouse_pos$($x3, $x4);var $x6 = $mouse_pos$1;var $x7 = $hero_pos$0;var $x5 = $V2$sub$($x6, $x7);var $direction$2 = $V2$normalize$($x5);var $speed$3 = 1.9;var $x8 = 20.0;var $x9 = 2.0;var $offset_distance$4 = $x8 * $x9;var $x11 = $hero_pos$0;var $x13 = $direction$2;var $x14 = $offset_distance$4;var $x12 = $V2$mul_scalar$($x13, $x14);var $x10 = $V2$add$($x11, $x12);var $bullet_pos$5 = $V2$round$($x10);var $x16 = $hero_pos$0;var $x18 = $direction$2;var $x19 = _$2;var $x17 = $V2$mul_scalar$($x18, $x19);var $x15 = $V2$add$($x16, $x17);var $real_target$6 = $V2$round$($x15);var $x20 = $bullet_pos$5;var $x21 = _$3;var $bullet_shape$7 = $UG$Shape$circle$($x20, $x21);var $x22 = _$5;var $got$8 = $UG$SIPD$State$generate_id$($x22);var $x23 = $got$8;var $x24 = $UG$SIPD$Effect$spawn_body;var $x25 = ({$: "Body"});var $x26 = $x23.fst;$x25.id = $x26;var $x27 = $bullet_shape$7;$x25.hitbox = $x27;var $x29 = $tick_projectile;var $x30 = $x23.fst;var $x28 = ($x29)($x30);$x25.tick = $x28;var $x31 = ({$: "Nil"});$x25.effects = $x31;var $x32 = ({$: "Untouchable"});$x25.collidable = $x32;var $x33 = $x1.side;$x25.side = $x33;var $spawn_effect$9 = ($x24)($x25);var $x39 = $UG$SIPD$Effect$move_range;var $x40 = $x23.fst;var $x38 = ($x39)($x40);var $x41 = $speed$3;var $x37 = ($x38)($x41);var $x42 = $real_target$6;var $x36 = ($x37)($x42);var $x43 = _$2;var $x35 = ($x36)($x43);var $x44 = _$4;var $x34 = ($x35)($x44);var $x48 = $UG$SIPD$Effect$collide_and_damage;var $x49 = $x1.id;var $x47 = ($x48)($x49);var $x50 = $x23.fst;var $x46 = ($x47)($x50);var $x51 = 135n;var $x45 = ($x46)($x51);var $move_effect$10 = ($x34)($x45);var $x52 = $spawn_effect$9;var $x53 = $x23.snd;var $state_after_spawn$11 = $UG$SIPD$Effect$apply$($x52, $x53);var $x54 = $move_effect$10;var $x55 = $state_after_spawn$11;var $x0 = $UG$SIPD$Effect$apply$($x54, $x55);return $x0; }
const $shoot$go = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $shoot$go$(_$0,_$1,_$2,_$3,_$4,_$5)

function $UG$SIPD$Effect$shoot$(_$0/*:BigInt*/,_$1/*:Number*/,_$2/*:Number*/,_$3/*:BigInt*/,_$4/*:UG/SIPD/State*/) {var $x1 = _$4;var $x2 = $x1.game_map;var $x4 = $UG$SIPD$Player;var $x5 = $x1.players;var $x6 = _$0;var $x3 = $Map$get$($x4, $x5, $x6);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x7 = $x1.next_id;$x0.next_id = $x7;var $x8 = $x1.tick;$x0.tick = $x8;var $x9 = $x1.players;$x0.players = $x9;var $x10 = $x1.hero_states;$x0.hero_states = $x10;var $x11 = ({$: "GameMap"});var $x12 = $x2.width;$x11.width = $x12;var $x13 = $x2.height;$x11.height = $x13;var $x14 = $x2.bodies;$x11.bodies = $x14;var $x15 = $x2.bodies_count;$x11.bodies_count = $x15;$x0.game_map = $x11; break; } case "Some": { var $x16 = $x3.value;var $x17 = $x16.hero;var $x19 = $x17.body_id;var $x20 = $x2.bodies;var $x18 = $UG$SIPD$Body$get_body$($x19, $x20);switch ($x18.$) { case "None": { var $x0 = ({$: "State"});var $x21 = $x1.next_id;$x0.next_id = $x21;var $x22 = $x1.tick;$x0.tick = $x22;var $x23 = $x1.players;$x0.players = $x23;var $x24 = $x1.hero_states;$x0.hero_states = $x24;var $x25 = ({$: "GameMap"});var $x26 = $x2.width;$x25.width = $x26;var $x27 = $x2.height;$x25.height = $x27;var $x28 = $x2.bodies;$x25.bodies = $x28;var $x29 = $x2.bodies_count;$x25.bodies_count = $x29;$x0.game_map = $x25; break; } case "Some": { var $x30 = $x18.value;var $x31 = ({$: "Player"});var $x32 = $x16.id;$x31.id = $x32;var $x33 = $x16.name;$x31.name = $x33;var $x34 = $x16.keys;$x31.keys = $x34;var $x35 = $x16.target;$x31.target = $x35;var $x36 = ({$: "Hero"});var $x37 = $x17.owner_id;$x36.owner_id = $x37;var $x38 = $x17.name;$x36.name = $x38;var $x39 = $x17.skills;$x36.skills = $x39;var $x40 = $x17.body_id;$x36.body_id = $x40;$x31.hero = $x36;var $x41 = _$1;var $x42 = _$2;var $x43 = _$3;var $x44 = ({$: "State"});var $x45 = $x1.next_id;$x44.next_id = $x45;var $x46 = $x1.tick;$x44.tick = $x46;var $x47 = $x1.players;$x44.players = $x47;var $x48 = $x1.hero_states;$x44.hero_states = $x48;var $x49 = ({$: "GameMap"});var $x50 = $x2.width;$x49.width = $x50;var $x51 = $x2.height;$x49.height = $x51;var $x52 = $x2.bodies;$x49.bodies = $x52;var $x53 = $x2.bodies_count;$x49.bodies_count = $x53;$x44.game_map = $x49;var $x0 = $shoot$go$($x30, $x31, $x41, $x42, $x43, $x44); break; } } break; } }return $x0; }
const $UG$SIPD$Effect$shoot = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Effect$shoot$(_$0,_$1,_$2,_$3,_$4)

function $UG$SIPD$Effect$teleport$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:UG/SIPD/State*/) {var $x1 = _$3;var $x2 = $x1.game_map;var $x3 = ({$: "Pair"});var $x5 = $UG$SIPD$Player;var $x6 = $x1.players;var $x7 = _$0;var $x4 = $Map$get$($x5, $x6, $x7);$x3.fst = $x4;var $x9 = $x2.bodies;var $x10 = _$1;var $x8 = $UG$SIPD$GameMap$get_body$($x9, $x10);$x3.snd = $x8;var $x11 = $x3.fst;switch ($x11.$) { case "None": { var $x12 = $x3.snd;switch ($x12.$) { case "None": { var $x0 = ({$: "State"});var $x13 = $x1.next_id;$x0.next_id = $x13;var $x14 = $x1.tick;$x0.tick = $x14;var $x15 = $x1.players;$x0.players = $x15;var $x16 = $x1.hero_states;$x0.hero_states = $x16;var $x17 = ({$: "GameMap"});var $x18 = $x2.width;$x17.width = $x18;var $x19 = $x2.height;$x17.height = $x19;var $x20 = $x2.bodies;$x17.bodies = $x20;var $x21 = $x2.bodies_count;$x17.bodies_count = $x21;$x0.game_map = $x17; break; } default: { var $x0 = ({$: "State"});var $x22 = $x1.next_id;$x0.next_id = $x22;var $x23 = $x1.tick;$x0.tick = $x23;var $x24 = $x1.players;$x0.players = $x24;var $x25 = $x1.hero_states;$x0.hero_states = $x25;var $x26 = ({$: "GameMap"});var $x27 = $x2.width;$x26.width = $x27;var $x28 = $x2.height;$x26.height = $x28;var $x29 = $x2.bodies;$x26.bodies = $x29;var $x30 = $x2.bodies_count;$x26.bodies_count = $x30;$x0.game_map = $x26; break; } } break; } case "Some": { var $x31 = $x11.value;switch ($x31.$) { case "Player": { var $x32 = $x3.snd;switch ($x32.$) { case "None": { var $x0 = ({$: "State"});var $x33 = $x1.next_id;$x0.next_id = $x33;var $x34 = $x1.tick;$x0.tick = $x34;var $x35 = $x1.players;$x0.players = $x35;var $x36 = $x1.hero_states;$x0.hero_states = $x36;var $x37 = ({$: "GameMap"});var $x38 = $x2.width;$x37.width = $x38;var $x39 = $x2.height;$x37.height = $x39;var $x40 = $x2.bodies;$x37.bodies = $x40;var $x41 = $x2.bodies_count;$x37.bodies_count = $x41;$x0.game_map = $x37; break; } case "Some": { var $x42 = $x32.value;var $x43 = $x42.hitbox;var $hitbox_center$0 = $UG$Shape$get_center$($x43);var $x45 = $x31.target;var $x46 = $hitbox_center$0;var $x44 = $V2$sub$($x45, $x46);var $direction$1 = $V2$normalize$($x44);var $x48 = $x31.target;var $x49 = $hitbox_center$0;var $x47 = $V2$sub$($x48, $x49);var $distance$2 = $V2$length$($x47);var $x50 = $distance$2;var $x51 = _$2;var $teleport_dist$3 = $F64$min$($x50, $x51);var $x52 = $direction$1;var $x53 = $teleport_dist$3;var $movement$4 = $V2$mul_scalar$($x52, $x53);var $x54 = $hitbox_center$0;var $x55 = $movement$4;var $new_center$5 = $V2$add$($x54, $x55);var $x56 = $x42.hitbox;var $x57 = $movement$4;var $new_hitbox$6 = $UG$Shape$move$($x56, $x57);var $x58 = ({$: "State"});var $x59 = $x1.next_id;$x58.next_id = $x59;var $x60 = $x1.tick;$x58.tick = $x60;var $x61 = $x1.players;$x58.players = $x61;var $x62 = $x1.hero_states;$x58.hero_states = $x62;var $x63 = ({$: "GameMap"});var $x64 = $x2.width;$x63.width = $x64;var $x65 = $x2.height;$x63.height = $x65;var $x66 = $x2.bodies;$x63.bodies = $x66;var $x67 = $x2.bodies_count;$x63.bodies_count = $x67;$x58.game_map = $x63;var $x68 = ({$: "Body"});var $x69 = $x42.id;$x68.id = $x69;var $x70 = $new_hitbox$6;$x68.hitbox = $x70;var $x71 = $x42.tick;$x68.tick = $x71;var $x72 = $x42.effects;$x68.effects = $x72;var $x73 = $x42.collidable;$x68.collidable = $x73;var $x74 = $x42.side;$x68.side = $x74;var $x0 = $UG$SIPD$State$insert_body$($x58, $x68); break; } } break; } default: { var $x76 = /*Type*/null;var $x77 = $x31;var $x75 = ($x76)($x77);var $x78 = $x3.snd;var $x0 = ($x75)($x78); break; } } break; } default: { var $x80 = /*Type*/null;var $x81 = $x11;var $x79 = ($x80)($x81);var $x82 = $x3.snd;var $x0 = ($x79)($x82); break; } }return $x0; }
const $UG$SIPD$Effect$teleport = _$0 => _$1 => _$2 => _$3 => $UG$SIPD$Effect$teleport$(_$0,_$1,_$2,_$3)

function $tick_wave$(_$0/*:BigInt*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$1;var $x2 = $x1.game_map;var $x4 = _$0;var $x5 = $x2.bodies;var $x3 = $UG$SIPD$Body$get_body$($x4, $x5);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x6 = $x1.next_id;$x0.next_id = $x6;var $x7 = $x1.tick;$x0.tick = $x7;var $x8 = $x1.players;$x0.players = $x8;var $x9 = $x1.hero_states;$x0.hero_states = $x9;var $x10 = ({$: "GameMap"});var $x11 = $x2.width;$x10.width = $x11;var $x12 = $x2.height;$x10.height = $x12;var $x13 = $x2.bodies;$x10.bodies = $x13;var $x14 = $x2.bodies_count;$x10.bodies_count = $x14;$x0.game_map = $x10; break; } case "Some": { var $x15 = $x3.value;var $x16 = ({$: "State"});var $x17 = $x1.next_id;$x16.next_id = $x17;var $x18 = $x1.tick;$x16.tick = $x18;var $x19 = $x1.players;$x16.players = $x19;var $x20 = $x1.hero_states;$x16.hero_states = $x20;var $x21 = ({$: "GameMap"});var $x22 = $x2.width;$x21.width = $x22;var $x23 = $x2.height;$x21.height = $x23;var $x24 = $x2.bodies;$x21.bodies = $x24;var $x25 = $x2.bodies_count;$x21.bodies_count = $x25;$x16.game_map = $x21;var $x0 = $UG$SIPD$Body$apply_effects$($x15, $x16); break; } }return $x0; }
const $tick_wave = _$0 => _$1 => $tick_wave$(_$0,_$1)

function $create_wave_body$(_$0/*:V2*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:UG/SIPD/Side*/) {var $x0 = ({$: "Body"});var $x1 = _$1;$x0.id = $x1;var $x3 = _$0;var $x4 = _$2;var $x2 = $UG$Shape$circle$($x3, $x4);$x0.hitbox = $x2;var $x6 = $tick_wave;var $x7 = _$1;var $x5 = ($x6)($x7);$x0.tick = $x5;var $x8 = ({$: "Nil"});$x0.effects = $x8;var $x9 = ({$: "Untouchable"});$x0.collidable = $x9;var $x10 = _$3;$x0.side = $x10;return $x0; }
const $create_wave_body = _$0 => _$1 => _$2 => _$3 => $create_wave_body$(_$0,_$1,_$2,_$3)

function $UG$SIPD$Effect$wave_of_force$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:BigInt*/,_$4/*:UG/SIPD/State*/) {var $x1 = _$4;var $x2 = $x1.game_map;var $x4 = $UG$SIPD$Player;var $x5 = $x1.players;var $x6 = _$0;var $x3 = $Map$get$($x4, $x5, $x6);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x7 = $x1.next_id;$x0.next_id = $x7;var $x8 = $x1.tick;$x0.tick = $x8;var $x9 = $x1.players;$x0.players = $x9;var $x10 = $x1.hero_states;$x0.hero_states = $x10;var $x11 = ({$: "GameMap"});var $x12 = $x2.width;$x11.width = $x12;var $x13 = $x2.height;$x11.height = $x13;var $x14 = $x2.bodies;$x11.bodies = $x14;var $x15 = $x2.bodies_count;$x11.bodies_count = $x15;$x0.game_map = $x11; break; } case "Some": { var $x17 = $UG$SIPD$Body;var $x18 = $x2.bodies;var $x19 = _$0;var $x16 = $Map$get$($x17, $x18, $x19);switch ($x16.$) { case "None": { var $x0 = ({$: "State"});var $x20 = $x1.next_id;$x0.next_id = $x20;var $x21 = $x1.tick;$x0.tick = $x21;var $x22 = $x1.players;$x0.players = $x22;var $x23 = $x1.hero_states;$x0.hero_states = $x23;var $x24 = ({$: "GameMap"});var $x25 = $x2.width;$x24.width = $x25;var $x26 = $x2.height;$x24.height = $x26;var $x27 = $x2.bodies;$x24.bodies = $x27;var $x28 = $x2.bodies_count;$x24.bodies_count = $x28;$x0.game_map = $x24; break; } case "Some": { var $got$0 = $x16.value;var $x29 = $got$0;var $x30 = $x3.value;var $x31 = JSTR_TO_LIST(`Z`);var $target$1 = $UG$SIPD$Player$get_mouse_pos$($x30, $x31);var $x32 = ({$: "State"});var $x33 = $x1.next_id;$x32.next_id = $x33;var $x34 = $x1.tick;$x32.tick = $x34;var $x35 = $x1.players;$x32.players = $x35;var $x36 = $x1.hero_states;$x32.hero_states = $x36;var $x37 = ({$: "GameMap"});var $x38 = $x2.width;$x37.width = $x38;var $x39 = $x2.height;$x37.height = $x39;var $x40 = $x2.bodies;$x37.bodies = $x40;var $x41 = $x2.bodies_count;$x37.bodies_count = $x41;$x32.game_map = $x37;var $got$2 = $UG$SIPD$State$generate_id$($x32);var $x42 = $got$2;var $x43 = $target$1;var $x44 = $x42.fst;var $x45 = _$2;var $x46 = $x29.side;var $wave_body$3 = $create_wave_body$($x43, $x44, $x45, $x46);var $x47 = $UG$SIPD$Effect$spawn_body;var $x48 = $wave_body$3;var $spawn_effect$4 = ($x47)($x48);var $x51 = $UG$SIPD$Effect$with_duration;var $x52 = _$1;var $x50 = ($x51)($x52);var $x53 = $x42.fst;var $x49 = ($x50)($x53);var $x58 = $UG$SIPD$Effect$knockback;var $x59 = _$0;var $x57 = ($x58)($x59);var $x60 = $x42.fst;var $x56 = ($x57)($x60);var $x61 = ({$: "V2"});var $x62 = 10.0;$x61.x = $x62;var $x63 = 10.0;$x61.y = $x63;var $x55 = ($x56)($x61);var $x64 = _$3;var $x54 = ($x55)($x64);var $with_duration_effect$5 = ($x49)($x54);var $x65 = $spawn_effect$4;var $x66 = $x42.snd;var $state$6 = $UG$SIPD$Effect$apply$($x65, $x66);var $x67 = $with_duration_effect$5;var $x68 = $state$6;var $state$7 = $UG$SIPD$Effect$apply$($x67, $x68);var $x0 = $state$7; break; } } break; } }return $x0; }
const $UG$SIPD$Effect$wave_of_force = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Effect$wave_of_force$(_$0,_$1,_$2,_$3,_$4)

const $UG$SIPD$Event$Click$ = (() => {var $x0 = /*{$:'LeftButton'} | {$:'RightButton'}*/null;return $x0; })()
const $UG$SIPD$Event$Click = $UG$SIPD$Event$Click$

const $UG$SIPD$Event$ = (() => {var $x0 = /*{$:'KeyEvent', time: BigInt, pid: BigInt, key: String, pressed: Bool} | {$:'MouseClick', time: BigInt, pid: BigInt, click: UG/SIPD/Event/Click, x: Number, y: Number} | {$:'KeyMouse', time: BigInt, pid: BigInt, key: String, pressed: Bool, x: Number, y: Number} | {$:'MouseMove', time: BigInt, pid: BigInt, x: Number, y: Number} | {$:'ActionEvent', action: UG/SIPD/Action}*/null;return $x0; })()
const $UG$SIPD$Event = $UG$SIPD$Event$

function $UG$SIPD$Event$Click$eq$(_$0/*:UG/SIPD/Event/Click*/) {var $x1 = _$0;switch ($x1.$) { case "LeftButton": { var $x0 = ($__0$0 => {var $x3 = $__0$0;switch ($x3.$) { case "LeftButton": { var $x2 = ({$: "True"}); break; } default: { var $x2 = ({$: "False"}); break; } }return $x2;}); break; } case "RightButton": { var $x0 = ($__0$0 => {var $x5 = $__0$0;switch ($x5.$) { case "RightButton": { var $x4 = ({$: "True"}); break; } default: { var $x4 = ({$: "False"}); break; } }return $x4;}); break; } default: { var $x6 = /*Type*/null;var $x7 = $x1;var $x0 = ($x6)($x7); break; } }return $x0; }
const $UG$SIPD$Event$Click$eq = _$0 => $UG$SIPD$Event$Click$eq$(_$0)

function $UG$SIPD$Event$eq$(_$0/*:UG/SIPD/Event*/) {var $x1 = _$0;switch ($x1.$) { case "ActionEvent": { var $x0 = ($__1$0 => {var $x3 = $__1$0;switch ($x3.$) { case "ActionEvent": { var $x4 = $x1.action;var $x5 = $x3.action;var $x2 = $UG$SIPD$Action$eq$($x4, $x5); break; } default: { var $x2 = ({$: "False"}); break; } }return $x2;}); break; } case "KeyEvent": { var $x0 = ($__4$0 => {var $x7 = $__4$0;switch ($x7.$) { case "KeyEvent": { var $x8 = $x1.time;var $x9 = $x7.time;var $time_eq$1 = $U64$eq$($x8, $x9);var $x10 = $x1.pid;var $x11 = $x7.pid;var $pid_eq$2 = $U64$eq$($x10, $x11);var $x12 = $x1.key;var $x13 = $x7.key;var $key_eq$3 = $String$eq$($x12, $x13);var $x15 = $x1.pressed;var $x14 = $Bool$eq$($x15);var $x16 = $x7.pressed;var $pressed_eq$4 = ($x14)($x16);var $x17 = $time_eq$1;var $x19 = $pid_eq$2;var $x21 = $key_eq$3;var $x22 = $pressed_eq$4;var $x20 = $Bool$and$($x21, $x22);var $x18 = $Bool$and$($x19, $x20);var $x6 = $Bool$and$($x17, $x18); break; } default: { var $x6 = ({$: "False"}); break; } }return $x6;}); break; } case "KeyMouse": { var $x23 = $x1.key;switch ($x23.$) { case "Cons": { var $x0 = ($__7$0 => {var $x25 = $__7$0;switch ($x25.$) { case "KeyMouse": { var $x26 = $x25.key;switch ($x26.$) { case "Cons": { var $x27 = $x1.time;var $x28 = $x25.time;var $time_eq$1 = $U64$eq$($x27, $x28);var $x29 = $x1.pid;var $x30 = $x25.pid;var $pid_eq$2 = $U64$eq$($x29, $x30);var $x31 = $x23.head;var $x32 = $x26.head;var $key_eq$3 = $Char$eq$($x31, $x32);var $x34 = $x1.pressed;var $x33 = $Bool$eq$($x34);var $x35 = $x25.pressed;var $pressed_eq$4 = ($x33)($x35);var $x36 = $x1.x;var $x37 = $x25.x;var $x_eq$5 = $F64$eq$($x36, $x37);var $x38 = $x1.y;var $x39 = $x25.y;var $y_eq$6 = $F64$eq$($x38, $x39);var $x40 = $time_eq$1;var $x42 = $pid_eq$2;var $x44 = $key_eq$3;var $x46 = $pressed_eq$4;var $x48 = $x_eq$5;var $x49 = $y_eq$6;var $x47 = $Bool$and$($x48, $x49);var $x45 = $Bool$and$($x46, $x47);var $x43 = $Bool$and$($x44, $x45);var $x41 = $Bool$and$($x42, $x43);var $x24 = $Bool$and$($x40, $x41); break; } default: { var $x24 = ({$: "False"}); break; } } break; } default: { var $x24 = ({$: "False"}); break; } }return $x24;}); break; } default: { var $x0 = ($e2$0 => {var $x50 = ({$: "False"});return $x50;}); break; } } break; } case "MouseClick": { var $x0 = ($__5$0 => {var $x52 = $__5$0;switch ($x52.$) { case "MouseClick": { var $x53 = $x1.time;var $x54 = $x52.time;var $time_eq$1 = $U64$eq$($x53, $x54);var $x55 = $x1.pid;var $x56 = $x52.pid;var $pid_eq$2 = $U64$eq$($x55, $x56);var $x58 = $x1.click;var $x57 = $UG$SIPD$Event$Click$eq$($x58);var $x59 = $x52.click;var $click_eq$3 = ($x57)($x59);var $x60 = $x1.x;var $x61 = $x52.x;var $x_eq$4 = $F64$eq$($x60, $x61);var $x62 = $x1.y;var $x63 = $x52.y;var $y_eq$5 = $F64$eq$($x62, $x63);var $x64 = $time_eq$1;var $x66 = $pid_eq$2;var $x68 = $click_eq$3;var $x70 = $x_eq$4;var $x71 = $y_eq$5;var $x69 = $Bool$and$($x70, $x71);var $x67 = $Bool$and$($x68, $x69);var $x65 = $Bool$and$($x66, $x67);var $x51 = $Bool$and$($x64, $x65); break; } default: { var $x51 = ({$: "False"}); break; } }return $x51;}); break; } case "MouseMove": { var $x0 = ($__4$0 => {var $x73 = $__4$0;switch ($x73.$) { case "MouseMove": { var $x74 = $x1.time;var $x75 = $x73.time;var $time_eq$1 = $U64$eq$($x74, $x75);var $x76 = $x1.pid;var $x77 = $x73.pid;var $pid_eq$2 = $U64$eq$($x76, $x77);var $x78 = $x1.x;var $x79 = $x73.x;var $x_eq$3 = $F64$eq$($x78, $x79);var $x80 = $x1.y;var $x81 = $x73.y;var $y_eq$4 = $F64$eq$($x80, $x81);var $x82 = $time_eq$1;var $x84 = $pid_eq$2;var $x86 = $x_eq$3;var $x87 = $y_eq$4;var $x85 = $Bool$and$($x86, $x87);var $x83 = $Bool$and$($x84, $x85);var $x72 = $Bool$and$($x82, $x83); break; } default: { var $x72 = ({$: "False"}); break; } }return $x72;}); break; } default: { var $x88 = /*Type*/null;var $x89 = $x1;var $x0 = ($x88)($x89); break; } }return $x0; }
const $UG$SIPD$Event$eq = _$0 => $UG$SIPD$Event$eq$(_$0)

function $UG$SIPD$Event$get_event_pid$(_$0/*:UG/SIPD/Event*/) {var $x1 = _$0;switch ($x1.$) { case "ActionEvent": { var $x2 = $x1.action;var $x0 = $x2.pid; break; } case "KeyEvent": { var $x0 = $x1.pid; break; } case "KeyMouse": { var $x0 = $x1.pid; break; } case "MouseClick": { var $x0 = $x1.pid; break; } case "MouseMove": { var $x0 = $x1.pid; break; } }return $x0; }
const $UG$SIPD$Event$get_event_pid = _$0 => $UG$SIPD$Event$get_event_pid$(_$0)

function $UG$SM$Game$(_$0/*:Type*/,_$1/*:Type*/) {var $x0 = /*{$:'Game', init: _$0, when: ($_$0:_$1) => ($_$1:_$0) => _$0, tick: ($_$0:_$0) => _$0}*/null;return $x0; }
const $UG$SM$Game = _$0 => _$1 => $UG$SM$Game$(_$0,_$1)

const $UG$SIPD$Game$ = (() => {var $x1 = $UG$SIPD$State;var $x2 = $UG$SIPD$Event;var $x0 = $UG$SM$Game$($x1, $x2);return $x0; })()
const $UG$SIPD$Game = $UG$SIPD$Game$

const $UG$SIPD$GameMap$initial_map$ = (() => {var $x1 = $UG$SIPD$Body;var $empty$0 = $Map$empty$($x1);var $x0 = $empty$0;return $x0; })()
const $UG$SIPD$GameMap$initial_map = $UG$SIPD$GameMap$initial_map$

function $UG$SIPD$GameMap$init$(_$0/*:BigInt*/,_$1/*:BigInt*/) {var $x0 = ({$: "GameMap"});var $x1 = _$0;$x0.width = $x1;var $x2 = _$1;$x0.height = $x2;var $x3 = $UG$SIPD$GameMap$initial_map;$x0.bodies = $x3;var $x4 = 10000n;$x0.bodies_count = $x4;return $x0; }
const $UG$SIPD$GameMap$init = _$0 => _$1 => $UG$SIPD$GameMap$init$(_$0,_$1)

const $UG$SIPD$Game$init$ = (() => {var $x0 = ({$: "State"});var $x1 = 20n;$x0.next_id = $x1;var $x2 = 0n;$x0.tick = $x2;var $x4 = $UG$SIPD$Player;var $x3 = $Map$empty$($x4);$x0.players = $x3;var $x6 = $UG$SIPD$Hero$HeroState;var $x5 = $Map$empty$($x6);$x0.hero_states = $x5;var $x8 = 1200n;var $x9 = 1200n;var $x7 = $UG$SIPD$GameMap$init$($x8, $x9);$x0.game_map = $x7;return $x0; })()
const $UG$SIPD$Game$init = $UG$SIPD$Game$init$

function $update_cooldown$(_$0/*:Pair<String><BigInt>*/,_$1/*:OrdTree<String><BigInt>*/) {var $x1 = _$0;var $x4 = $x1.snd;var $x5 = 0n;var $x3 = BigInt.asUintN(64, $x4 === $x5);var $x2 = $U64$to_bool$($x3);switch ($x2.$) { case "True": { var $x0 = _$1; break; } case "False": { var $x6 = $String;var $x7 = /*BigInt*/null;var $x8 = $String$Ord;var $x9 = _$1;var $x10 = ({$: "Pair"});var $x11 = $x1.fst;$x10.fst = $x11;var $x13 = $x1.snd;var $x14 = 1n;var $x12 = BigInt.asUintN(64, $x13 - $x14);$x10.snd = $x12;var $x0 = $OrdTree$insert$($x6, $x7, $x8, $x9, $x10); break; } }return $x0; }
const $update_cooldown = _$0 => _$1 => $update_cooldown$(_$0,_$1)

function $decrement_cooldowns$(_$0/*:UG/SIPD/Hero/HeroState*/) {var $x1 = _$0;var $x2 = $String;var $x3 = /*BigInt*/null;var $x4 = $x1.cooldowns;var $x6 = $String;var $x7 = /*BigInt*/null;var $x5 = $OrdTree$($x6, $x7);var $x8 = $x1.cooldowns;var $x9 = $update_cooldown;var $new_cooldowns$0 = $OrdTree$fold$($x2, $x3, $x4, $x5, $x8, $x9);var $x0 = ({$: "HeroState"});var $x10 = $new_cooldowns$0;$x0.cooldowns = $x10;var $x11 = $x1.health;$x0.health = $x11;return $x0; }
const $decrement_cooldowns = _$0 => $decrement_cooldowns$(_$0)

function $update_hero_state$(_$0/*:UG/SIPD/State*/,_$1/*:BigInt*/,_$2/*:UG/SIPD/Hero/HeroState*/) {var $x1 = _$0;var $x2 = $UG$SIPD$Hero$HeroState;var $x3 = $x1.hero_states;var $x4 = _$1;var $x6 = _$2;var $x5 = $decrement_cooldowns$($x6);var $new_hero_states$0 = $Map$insert$($x2, $x3, $x4, $x5);var $x0 = ({$: "State"});var $x7 = $x1.next_id;$x0.next_id = $x7;var $x8 = $x1.tick;$x0.tick = $x8;var $x9 = $x1.players;$x0.players = $x9;var $x10 = $new_hero_states$0;$x0.hero_states = $x10;var $x11 = $x1.game_map;$x0.game_map = $x11;return $x0; }
const $update_hero_state = _$0 => _$1 => _$2 => $update_hero_state$(_$0,_$1,_$2)

function $update_cooldowns$(_$0/*:UG/SIPD/State*/) {var $x1 = _$0;var $x2 = $x1.game_map;var $x3 = $UG$SIPD$Hero$HeroState;var $x4 = $UG$SIPD$State;var $x5 = $x1.hero_states;var $x6 = $x2.bodies_count;var $x7 = ({$: "State"});var $x8 = $x1.next_id;$x7.next_id = $x8;var $x9 = $x1.tick;$x7.tick = $x9;var $x10 = $x1.players;$x7.players = $x10;var $x11 = $x1.hero_states;$x7.hero_states = $x11;var $x12 = ({$: "GameMap"});var $x13 = $x2.width;$x12.width = $x13;var $x14 = $x2.height;$x12.height = $x14;var $x15 = $x2.bodies;$x12.bodies = $x15;var $x16 = $x2.bodies_count;$x12.bodies_count = $x16;$x7.game_map = $x12;var $x17 = $update_hero_state;var $x0 = $Map$fold$($x3, $x4, $x5, $x6, $x7, $x17);return $x0; }
const $update_cooldowns = _$0 => $update_cooldowns$(_$0)

function $UG$SIPD$Game$tick$(_$0/*:UG/SIPD/State*/) {var $x1 = _$0;var $got$0 = $x1.game_map;var $x2 = $got$0;var $x3 = $UG$SIPD$Body;var $x4 = $x2.bodies;var $x5 = $x2.bodies_count;var $body_values$1 = $Map$values$($x3, $x4, $x5);var $x6 = $UG$SIPD$Body;var $x7 = $body_values$1;var $x8 = $UG$SIPD$State;var $x9 = ({$: "State"});var $x10 = $x1.next_id;$x9.next_id = $x10;var $x11 = $x1.tick;$x9.tick = $x11;var $x12 = $x1.players;$x9.players = $x12;var $x13 = $x1.hero_states;$x9.hero_states = $x13;var $x14 = $x1.game_map;$x9.game_map = $x14;var $x15 = ($body$2 => $acc$3 => {var $x18 = $body$2;var $x17 = $UG$SIPD$Body$tick$($x18);var $x19 = $acc$3;var $x16 = ($x17)($x19);return $x16;});var $updated_gs$2 = $List$fold$($x6, $x7, $x8, $x9, $x15);var $got$3 = $updated_gs$2;var $x20 = $got$3;var $x21 = $x20.tick;var $x22 = 1n;var $updated_tick$4 = $U64$add$($x21, $x22);var $x23 = ({$: "State"});var $x24 = $x20.next_id;$x23.next_id = $x24;var $x25 = $updated_tick$4;$x23.tick = $x25;var $x26 = $x20.players;$x23.players = $x26;var $x27 = $x20.hero_states;$x23.hero_states = $x27;var $x28 = $x20.game_map;$x23.game_map = $x28;var $x0 = $update_cooldowns$($x23);return $x0; }
const $UG$SIPD$Game$tick = _$0 => $UG$SIPD$Game$tick$(_$0)

function $get_player_name$(_$0/*:UG/SIPD/Event*/) {var $x1 = _$0;switch ($x1.$) { case "ActionEvent": { var $x2 = $x1.action;switch ($x2.$) { case "SetNick": { var $x0 = $x2.nick; break; } default: { var $x3 = /*Type*/null;var $x4 = $x2;var $x0 = ($x3)($x4); break; } } break; } default: { var $x0 = JSTR_TO_LIST(`Anon`); break; } }return $x0; }
const $get_player_name = _$0 => $get_player_name$(_$0)

function $get_player_side$(_$0/*:UG/SIPD/Event*/) {var $x1 = _$0;switch ($x1.$) { case "ActionEvent": { var $x2 = $x1.action;switch ($x2.$) { case "SetNick": { var $x0 = $x2.side; break; } default: { var $x3 = /*Type*/null;var $x4 = $x2;var $x0 = ($x3)($x4); break; } } break; } default: { var $x0 = ({$: "Neutral"}); break; } }return $x0; }
const $get_player_side = _$0 => $get_player_side$(_$0)

const $UG$SIPD$unit_scaling$ = (() => {var $x0 = 32.0;return $x0; })()
const $UG$SIPD$unit_scaling = $UG$SIPD$unit_scaling$

function $get_body_effects_state$(_$0/*:Maybe<UG/SIPD/Body>*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$0;switch ($x1.$) { case "None": { var $x0 = _$1; break; } case "Some": { var $x2 = $x1.value;var $x3 = _$1;var $x0 = $UG$SIPD$Body$apply_effects$($x2, $x3); break; } }return $x0; }
const $get_body_effects_state = _$0 => _$1 => $get_body_effects_state$(_$0,_$1)

function $UG$SIPD$Hero$HeroState$key_on_cooldown$(_$0/*:String*/,_$1/*:OrdTree<String><BigInt>*/) {var $x3 = $String;var $x4 = /*BigInt*/null;var $x5 = $String$Ord;var $x6 = _$1;var $x2 = $OrdTree$get$($x3, $x4, $x5, $x6);var $x7 = _$0;var $x1 = ($x2)($x7);switch ($x1.$) { case "None": { var $x0 = ({$: "True"}); break; } case "Some": { var $x8 = $x1.value;var $x9 = 0n;var $x0 = $U64$neq$($x8, $x9); break; } }return $x0; }
const $UG$SIPD$Hero$HeroState$key_on_cooldown = _$0 => _$1 => $UG$SIPD$Hero$HeroState$key_on_cooldown$(_$0,_$1)

function $UG$SIPD$Skill$apply$(_$0/*:UG/SIPD/Skill*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$0;var $x2 = $UG$SIPD$Effect;var $x3 = $x1.effects;var $x4 = $UG$SIPD$State;var $x5 = _$1;var $x6 = ($state$0 => $effect$1 => {var $x8 = $effect$1;var $x9 = $state$0;var $x7 = ($x8)($x9);return $x7;});var $x0 = $List$foldl$($x2, $x3, $x4, $x5, $x6);return $x0; }
const $UG$SIPD$Skill$apply = _$0 => _$1 => $UG$SIPD$Skill$apply$(_$0,_$1)

function $revert_cooldown$(_$0/*:Maybe<UG/SIPD/Hero/HeroState>*/,_$1/*:UG/SIPD/State*/,_$2/*:BigInt*/,_$3/*:String*/,_$4/*:BigInt*/) {var $x1 = _$0;switch ($x1.$) { case "None": { var $x0 = _$1; break; } case "Some": { var $x2 = $x1.value;var $x3 = $String;var $x4 = /*BigInt*/null;var $x5 = $String$Ord;var $x6 = $x2.cooldowns;var $x7 = ({$: "Pair"});var $x8 = _$3;$x7.fst = $x8;var $x9 = _$4;$x7.snd = $x9;var $updated_cooldowns$0 = $OrdTree$insert$($x3, $x4, $x5, $x6, $x7);var $got$1 = _$1;var $x10 = $got$1;var $x11 = $UG$SIPD$Hero$HeroState;var $x12 = $x10.hero_states;var $x13 = _$2;var $x14 = ({$: "HeroState"});var $x15 = $updated_cooldowns$0;$x14.cooldowns = $x15;var $x16 = $x2.health;$x14.health = $x16;var $updated_hero_states$2 = $Map$insert$($x11, $x12, $x13, $x14);var $x0 = ({$: "State"});var $x17 = $x10.next_id;$x0.next_id = $x17;var $x18 = $x10.tick;$x0.tick = $x18;var $x19 = $x10.players;$x0.players = $x19;var $x20 = $updated_hero_states$2;$x0.hero_states = $x20;var $x21 = $x10.game_map;$x0.game_map = $x21; break; } }return $x0; }
const $revert_cooldown = _$0 => _$1 => _$2 => _$3 => _$4 => $revert_cooldown$(_$0,_$1,_$2,_$3,_$4)

function $get_skill$(_$0/*:OrdTree<String><UG/SIPD/Skill>*/,_$1/*:String*/) {var $x2 = $String;var $x3 = $UG$SIPD$Skill;var $x4 = $String$Ord;var $x5 = _$0;var $x1 = $OrdTree$get$($x2, $x3, $x4, $x5);var $x6 = _$1;var $x0 = ($x1)($x6);return $x0; }
const $get_skill = _$0 => _$1 => $get_skill$(_$0,_$1)

function $UG$SIPD$Player$is_player_key_pressed$(_$0/*:String*/,_$1/*:OrdTree<String><Pair<Bool><V2>>*/) {var $x3 = $String;var $x5 = $Bool;var $x6 = $V2;var $x4 = $Pair$($x5, $x6);var $x7 = $String$Ord;var $x8 = _$1;var $x2 = $OrdTree$get$($x3, $x4, $x7, $x8);var $x9 = _$0;var $x1 = ($x2)($x9);switch ($x1.$) { case "None": { var $x0 = ({$: "False"}); break; } case "Some": { var $x10 = $x1.value;var $x0 = $x10.fst; break; } }return $x0; }
const $UG$SIPD$Player$is_player_key_pressed = _$0 => _$1 => $UG$SIPD$Player$is_player_key_pressed$(_$0,_$1)

function $UG$SIPD$Hero$apply_skill_if_pressed$(_$0/*:String*/,_$1/*:BigInt*/,_$2/*:OrdTree<String><UG/SIPD/Skill>*/,_$3/*:OrdTree<String><Pair<Bool><V2>>*/,_$4/*:OrdTree<String><BigInt>*/,_$5/*:UG/SIPD/State*/) {var $x1 = ({$: "Pair"});var $x3 = _$2;var $x4 = _$0;var $x2 = $get_skill$($x3, $x4);$x1.fst = $x2;var $x6 = _$0;var $x7 = _$3;var $x5 = $UG$SIPD$Player$is_player_key_pressed$($x6, $x7);$x1.snd = $x5;var $x8 = $x1.fst;switch ($x8.$) { case "None": { var $x9 = $x1.snd;switch ($x9.$) { case "False": { var $x0 = _$5; break; } case "True": { var $x0 = _$5; break; } } break; } case "Some": { var $x10 = $x1.snd;switch ($x10.$) { case "False": { var $x0 = _$5; break; } case "True": { var $x11 = _$0;var $x12 = _$4;var $on_cooldown$0 = $UG$SIPD$Hero$HeroState$key_on_cooldown$($x11, $x12);var $x15 = $on_cooldown$0;var $x14 = $Bool$eq$($x15);var $x16 = ({$: "True"});var $x13 = ($x14)($x16);switch ($x13.$) { case "True": { var $x0 = _$5; break; } case "False": { var $x17 = $x8.value;var $x18 = _$5;var $new_state$1 = $UG$SIPD$Skill$apply$($x17, $x18);var $got$2 = $x8.value;var $x19 = $got$2;var $got$3 = $new_state$1;var $x20 = $got$3;var $x21 = $UG$SIPD$Hero$HeroState;var $x22 = $x20.hero_states;var $x23 = _$1;var $hero_state$4 = $Map$get$($x21, $x22, $x23);var $x24 = $hero_state$4;var $x25 = $new_state$1;var $x26 = _$1;var $x27 = _$0;var $x28 = $x19.cooldown;var $x0 = $revert_cooldown$($x24, $x25, $x26, $x27, $x28); break; } } break; } } break; } }return $x0; }
const $UG$SIPD$Hero$apply_skill_if_pressed = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $UG$SIPD$Hero$apply_skill_if_pressed$(_$0,_$1,_$2,_$3,_$4,_$5)

function $UG$SIPD$Hero$apply_pressed_skills$(_$0/*:List<String>*/,_$1/*:BigInt*/,_$2/*:OrdTree<String><UG/SIPD/Skill>*/,_$3/*:OrdTree<String><Pair<Bool><V2>>*/,_$4/*:OrdTree<String><BigInt>*/,_$5/*:UG/SIPD/State*/) {while(1){var $x1 = _$0;switch ($x1.$) { case "Cons": { var $x2 = $x1.head;var $x3 = _$1;var $x4 = _$2;var $x5 = _$3;var $x6 = _$4;var $x7 = _$5;var $new_state$0 = $UG$SIPD$Hero$apply_skill_if_pressed$($x2, $x3, $x4, $x5, $x6, $x7);var $x8 = $x1.tail;var $x9 = _$1;var $x10 = _$2;var $x11 = _$3;var $x12 = _$4;var $x13 = $new_state$0;_$0 = $x8;_$1 = $x9;_$2 = $x10;_$3 = $x11;_$4 = $x12;_$5 = $x13;/*TCO*/continue; break; } case "Nil": { var $x0 = _$5; break; } }return $x0; }}
const $UG$SIPD$Hero$apply_pressed_skills = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $UG$SIPD$Hero$apply_pressed_skills$(_$0,_$1,_$2,_$3,_$4,_$5)

function $apply_skill_if_not_on_cooldown$(_$0/*:UG/SIPD/Skill*/,_$1/*:BigInt*/,_$2/*:UG/SIPD/State*/) {var $x2 = _$1;var $x3 = 0n;var $x1 = $U64$eq$($x2, $x3);switch ($x1.$) { case "True": { var $x4 = _$0;var $x5 = _$2;var $x0 = $UG$SIPD$Skill$apply$($x4, $x5); break; } case "False": { var $x0 = _$2; break; } }return $x0; }
const $apply_skill_if_not_on_cooldown = _$0 => _$1 => _$2 => $apply_skill_if_not_on_cooldown$(_$0,_$1,_$2)

function $tick$(_$0/*:BigInt*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$1;var $x2 = $x1.game_map;var $x4 = $UG$SIPD$Player;var $x5 = $x1.players;var $x6 = _$0;var $x3 = $Map$get$($x4, $x5, $x6);switch ($x3.$) { case "None": { var $x0 = ({$: "State"});var $x7 = $x1.next_id;$x0.next_id = $x7;var $x8 = $x1.tick;$x0.tick = $x8;var $x9 = $x1.players;$x0.players = $x9;var $x10 = $x1.hero_states;$x0.hero_states = $x10;var $x11 = ({$: "GameMap"});var $x12 = $x2.width;$x11.width = $x12;var $x13 = $x2.height;$x11.height = $x13;var $x14 = $x2.bodies;$x11.bodies = $x14;var $x15 = $x2.bodies_count;$x11.bodies_count = $x15;$x0.game_map = $x11; break; } case "Some": { var $x16 = $x3.value;var $x17 = $x16.hero;var $x19 = $UG$SIPD$Hero$HeroState;var $x20 = $x1.hero_states;var $x21 = _$0;var $x18 = $Map$get$($x19, $x20, $x21);switch ($x18.$) { case "None": { var $x0 = ({$: "State"});var $x22 = $x1.next_id;$x0.next_id = $x22;var $x23 = $x1.tick;$x0.tick = $x23;var $x24 = $x1.players;$x0.players = $x24;var $x25 = $x1.hero_states;$x0.hero_states = $x25;var $x26 = ({$: "GameMap"});var $x27 = $x2.width;$x26.width = $x27;var $x28 = $x2.height;$x26.height = $x28;var $x29 = $x2.bodies;$x26.bodies = $x29;var $x30 = $x2.bodies_count;$x26.bodies_count = $x30;$x0.game_map = $x26; break; } case "Some": { var $x31 = $x18.value;var $x32 = $UG$SIPD$Body;var $x33 = $x2.bodies;var $x34 = $x17.body_id;var $maybe_hero_body$0 = $Map$get$($x32, $x33, $x34);var $x35 = $maybe_hero_body$0;var $x36 = ({$: "State"});var $x37 = $x1.next_id;$x36.next_id = $x37;var $x38 = $x1.tick;$x36.tick = $x38;var $x39 = $x1.players;$x36.players = $x39;var $x40 = $x1.hero_states;$x36.hero_states = $x40;var $x41 = ({$: "GameMap"});var $x42 = $x2.width;$x41.width = $x42;var $x43 = $x2.height;$x41.height = $x43;var $x44 = $x2.bodies;$x41.bodies = $x44;var $x45 = $x2.bodies_count;$x41.bodies_count = $x45;$x36.game_map = $x41;var $body_effects_state$1 = $get_body_effects_state$($x35, $x36);var $x46 = $String;var $x47 = $UG$SIPD$Skill;var $x48 = $x17.skills;var $skill_keys$2 = $OrdTree$keys$($x46, $x47, $x48);var $x49 = $skill_keys$2;var $x50 = _$0;var $x51 = $x17.skills;var $x52 = $x16.keys;var $x53 = $x31.cooldowns;var $x54 = $body_effects_state$1;var $state_after_skills$3 = $UG$SIPD$Hero$apply_pressed_skills$($x49, $x50, $x51, $x52, $x53, $x54);var $x56 = $String;var $x57 = $UG$SIPD$Skill;var $x58 = $String$Ord;var $x59 = $x17.skills;var $x55 = $OrdTree$get$($x56, $x57, $x58, $x59);var $x60 = JSTR_TO_LIST(`RightClick`);var $maybe_right_click$4 = ($x55)($x60);var $x61 = $maybe_right_click$4;switch ($x61.$) { case "None": { var $x0 = $state_after_skills$3; break; } case "Some": { var $x63 = $String;var $x64 = /*BigInt*/null;var $x65 = $String$Ord;var $x66 = $x31.cooldowns;var $x62 = $OrdTree$get$($x63, $x64, $x65, $x66);var $x67 = JSTR_TO_LIST(`RightClick`);var $cooldown$5 = ($x62)($x67);var $x68 = $cooldown$5;switch ($x68.$) { case "None": { var $x0 = $state_after_skills$3; break; } case "Some": { var $x69 = $x61.value;var $x70 = $x68.value;var $x71 = $state_after_skills$3;var $x0 = $apply_skill_if_not_on_cooldown$($x69, $x70, $x71); break; } } break; } } break; } } break; } }return $x0; }
const $tick = _$0 => _$1 => $tick$(_$0,_$1)

function $insert_skill$(_$0/*:OrdTree<String><UG/SIPD/Skill>*/,_$1/*:String*/,_$2/*:UG/SIPD/Skill*/) {var $x1 = $String;var $x2 = $UG$SIPD$Skill;var $x3 = $String$Ord;var $x4 = _$0;var $x5 = ({$: "Pair"});var $x6 = _$1;$x5.fst = $x6;var $x7 = _$2;$x5.snd = $x7;var $x0 = $OrdTree$insert$($x1, $x2, $x3, $x4, $x5);return $x0; }
const $insert_skill = _$0 => _$1 => _$2 => $insert_skill$(_$0,_$1,_$2)

function $UG$SIPD$Skill$move$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:BigInt*/) {var $x0 = ({$: "Skill"});var $x1 = JSTR_TO_LIST(`move`);$x0.name = $x1;var $x2 = ({$: "Cons"});var $x5 = $UG$SIPD$Effect$move;var $x6 = _$0;var $x4 = ($x5)($x6);var $x7 = _$1;var $x3 = ($x4)($x7);$x2.head = $x3;var $x8 = ({$: "Nil"});$x2.tail = $x8;$x0.effects = $x2;var $x9 = _$2;$x0.cooldown = $x9;return $x0; }
const $UG$SIPD$Skill$move = _$0 => _$1 => _$2 => $UG$SIPD$Skill$move$(_$0,_$1,_$2)

function $UG$SIPD$Skill$teleport$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:BigInt*/) {var $x0 = ({$: "Skill"});var $x1 = JSTR_TO_LIST(`teleport`);$x0.name = $x1;var $x2 = ({$: "Cons"});var $x6 = $UG$SIPD$Effect$teleport;var $x7 = _$0;var $x5 = ($x6)($x7);var $x8 = _$1;var $x4 = ($x5)($x8);var $x9 = _$2;var $x3 = ($x4)($x9);$x2.head = $x3;var $x10 = ({$: "Nil"});$x2.tail = $x10;$x0.effects = $x2;var $x11 = _$3;$x0.cooldown = $x11;return $x0; }
const $UG$SIPD$Skill$teleport = _$0 => _$1 => _$2 => _$3 => $UG$SIPD$Skill$teleport$(_$0,_$1,_$2,_$3)

const $UG$SIPD$range_unit$ = (() => {var $x1 = 0.5;var $x2 = $UG$SIPD$unit_scaling;var $x0 = $F64$mul$($x1, $x2);return $x0; })()
const $UG$SIPD$range_unit = $UG$SIPD$range_unit$

function $time_to_tick$(_$0/*:BigInt*/) {var $x2 = _$0;var $x3 = $TPS;var $x1 = $U64$mul$($x2, $x3);var $x4 = 2n;var $x0 = $U64$mul$($x1, $x4);return $x0; }
const $time_to_tick = _$0 => $time_to_tick$(_$0)

function $UG$SIPD$Skill$wave_of_force$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:BigInt*/,_$4/*:BigInt*/) {var $x0 = ({$: "Skill"});var $x1 = JSTR_TO_LIST(`wave_of_force`);$x0.name = $x1;var $x2 = ({$: "Cons"});var $x7 = $UG$SIPD$Effect$wave_of_force;var $x8 = _$0;var $x6 = ($x7)($x8);var $x9 = _$1;var $x5 = ($x6)($x9);var $x10 = _$2;var $x4 = ($x5)($x10);var $x11 = _$3;var $x3 = ($x4)($x11);$x2.head = $x3;var $x12 = ({$: "Nil"});$x2.tail = $x12;$x0.effects = $x2;var $x13 = _$4;$x0.cooldown = $x13;return $x0; }
const $UG$SIPD$Skill$wave_of_force = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Skill$wave_of_force$(_$0,_$1,_$2,_$3,_$4)

function $UG$SIPD$Skill$shoot$(_$0/*:BigInt*/,_$1/*:Number*/,_$2/*:Number*/,_$3/*:BigInt*/,_$4/*:BigInt*/) {var $x0 = ({$: "Skill"});var $x1 = JSTR_TO_LIST(`shoot`);$x0.name = $x1;var $x2 = ({$: "Cons"});var $x7 = $UG$SIPD$Effect$shoot;var $x8 = _$0;var $x6 = ($x7)($x8);var $x9 = _$1;var $x5 = ($x6)($x9);var $x10 = _$2;var $x4 = ($x5)($x10);var $x11 = _$3;var $x3 = ($x4)($x11);$x2.head = $x3;var $x12 = ({$: "Nil"});$x2.tail = $x12;$x0.effects = $x2;var $x13 = _$4;$x0.cooldown = $x13;return $x0; }
const $UG$SIPD$Skill$shoot = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Skill$shoot$(_$0,_$1,_$2,_$3,_$4)

function $UG$SIPD$Skill$magic_missiles$(_$0/*:BigInt*/,_$1/*:Number*/,_$2/*:BigInt*/,_$3/*:Number*/,_$4/*:BigInt*/) {var $x0 = ({$: "Skill"});var $x1 = JSTR_TO_LIST(`magic_missiles`);$x0.name = $x1;var $x2 = ({$: "Cons"});var $x7 = $UG$SIPD$Effect$magic_missiles;var $x8 = _$0;var $x6 = ($x7)($x8);var $x9 = _$1;var $x5 = ($x6)($x9);var $x10 = _$2;var $x4 = ($x5)($x10);var $x11 = _$3;var $x3 = ($x4)($x11);$x2.head = $x3;var $x12 = ({$: "Nil"});$x2.tail = $x12;$x0.effects = $x2;var $x13 = _$4;$x0.cooldown = $x13;return $x0; }
const $UG$SIPD$Skill$magic_missiles = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SIPD$Skill$magic_missiles$(_$0,_$1,_$2,_$3,_$4)

function $UG$SIPD$Skill$disintegrate$(_$0/*:BigInt*/,_$1/*:BigInt*/,_$2/*:Number*/,_$3/*:Number*/,_$4/*:Number*/,_$5/*:BigInt*/) {var $x0 = ({$: "Skill"});var $x1 = JSTR_TO_LIST(`disintegrate`);$x0.name = $x1;var $x2 = ({$: "Cons"});var $x8 = $UG$SIPD$Effect$disintegrate;var $x9 = _$0;var $x7 = ($x8)($x9);var $x10 = _$1;var $x6 = ($x7)($x10);var $x11 = _$2;var $x5 = ($x6)($x11);var $x12 = _$3;var $x4 = ($x5)($x12);var $x13 = _$4;var $x3 = ($x4)($x13);$x2.head = $x3;var $x14 = ({$: "Nil"});$x2.tail = $x14;$x0.effects = $x2;var $x15 = _$5;$x0.cooldown = $x15;return $x0; }
const $UG$SIPD$Skill$disintegrate = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $UG$SIPD$Skill$disintegrate$(_$0,_$1,_$2,_$3,_$4,_$5)

function $insert_cooldown$(_$0/*:OrdTree<String><BigInt>*/,_$1/*:String*/,_$2/*:BigInt*/) {var $x1 = $String;var $x2 = /*BigInt*/null;var $x3 = $String$Ord;var $x4 = _$0;var $x5 = ({$: "Pair"});var $x6 = _$1;$x5.fst = $x6;var $x7 = _$2;$x5.snd = $x7;var $x0 = $OrdTree$insert$($x1, $x2, $x3, $x4, $x5);return $x0; }
const $insert_cooldown = _$0 => _$1 => _$2 => $insert_cooldown$(_$0,_$1,_$2)

function $make_skills$(_$0/*:UG/SIPD/State*/,_$1/*:BigInt*/,_$2/*:BigInt*/) {var $x1 = _$0;var $x2 = $String;var $x3 = $UG$SIPD$Skill;var $s$0 = $OrdTree$empty$($x2, $x3);var $x4 = $s$0;var $x5 = JSTR_TO_LIST(`RightClick`);var $x7 = _$1;var $x8 = _$2;var $x9 = 0n;var $x6 = $UG$SIPD$Skill$move$($x7, $x8, $x9);var $s$1 = $insert_skill$($x4, $x5, $x6);var $x10 = $s$1;var $x11 = JSTR_TO_LIST(`E`);var $x13 = _$1;var $x14 = _$2;var $x16 = $UG$SIPD$range_unit;var $x17 = 4.0;var $x15 = $F64$mul$($x16, $x17);var $x19 = 3n;var $x18 = $time_to_tick$($x19);var $x12 = $UG$SIPD$Skill$teleport$($x13, $x14, $x15, $x18);var $s$2 = $insert_skill$($x10, $x11, $x12);var $x20 = $s$2;var $x21 = JSTR_TO_LIST(`Z`);var $x23 = _$1;var $x24 = 100n;var $x26 = 2.0;var $x27 = $UG$SIPD$unit_scaling;var $x25 = $F64$mul$($x26, $x27);var $x28 = 160n;var $x30 = 10n;var $x29 = $time_to_tick$($x30);var $x22 = $UG$SIPD$Skill$wave_of_force$($x23, $x24, $x25, $x28, $x29);var $s$3 = $insert_skill$($x20, $x21, $x22);var $x31 = $s$3;var $x32 = JSTR_TO_LIST(`W`);var $x34 = _$1;var $x36 = $UG$SIPD$range_unit;var $x37 = 19.0;var $x35 = $F64$mul$($x36, $x37);var $x39 = 0.25;var $x40 = $UG$SIPD$unit_scaling;var $x38 = $F64$mul$($x39, $x40);var $x41 = 10000n;var $x43 = 3n;var $x42 = $time_to_tick$($x43);var $x33 = $UG$SIPD$Skill$shoot$($x34, $x35, $x38, $x41, $x42);var $s$4 = $insert_skill$($x31, $x32, $x33);var $x44 = $s$4;var $x45 = JSTR_TO_LIST(`Q`);var $x47 = _$1;var $x49 = $UG$SIPD$range_unit;var $x50 = 12.0;var $x48 = $F64$mul$($x49, $x50);var $x51 = 10000n;var $x54 = 0.5;var $x55 = 0.475;var $x53 = $F64$mul$($x54, $x55);var $x56 = $UG$SIPD$unit_scaling;var $x52 = $F64$mul$($x53, $x56);var $x58 = 3n;var $x57 = $time_to_tick$($x58);var $x46 = $UG$SIPD$Skill$magic_missiles$($x47, $x48, $x51, $x52, $x57);var $s$5 = $insert_skill$($x44, $x45, $x46);var $x59 = $s$5;var $x60 = JSTR_TO_LIST(`R`);var $x62 = _$1;var $x64 = 5n;var $x63 = $time_to_tick$($x64);var $x65 = 10.0;var $x67 = $UG$SIPD$range_unit;var $x68 = 16.0;var $x66 = $F64$mul$($x67, $x68);var $x69 = 0.1;var $x71 = 10n;var $x70 = $time_to_tick$($x71);var $x61 = $UG$SIPD$Skill$disintegrate$($x62, $x63, $x65, $x66, $x69, $x70);var $s$6 = $insert_skill$($x59, $x60, $x61);var $li_ming_health$7 = 1270n;var $x72 = $String;var $x73 = /*BigInt*/null;var $s_cooldowns$8 = $OrdTree$empty$($x72, $x73);var $x74 = $s_cooldowns$8;var $x75 = JSTR_TO_LIST(`RightClick`);var $x76 = 0n;var $s_cooldowns$9 = $insert_cooldown$($x74, $x75, $x76);var $x77 = $s_cooldowns$9;var $x78 = JSTR_TO_LIST(`R`);var $x79 = 0n;var $s_cooldowns$10 = $insert_cooldown$($x77, $x78, $x79);var $x80 = $s_cooldowns$10;var $x81 = JSTR_TO_LIST(`E`);var $x82 = 0n;var $s_cooldowns$11 = $insert_cooldown$($x80, $x81, $x82);var $x83 = $s_cooldowns$11;var $x84 = JSTR_TO_LIST(`Z`);var $x85 = 0n;var $s_cooldowns$12 = $insert_cooldown$($x83, $x84, $x85);var $x86 = $s_cooldowns$12;var $x87 = JSTR_TO_LIST(`W`);var $x88 = 0n;var $s_cooldowns$13 = $insert_cooldown$($x86, $x87, $x88);var $x89 = $s_cooldowns$13;var $x90 = JSTR_TO_LIST(`Q`);var $x91 = 0n;var $s_cooldowns$14 = $insert_cooldown$($x89, $x90, $x91);var $x92 = $UG$SIPD$Hero$HeroState;var $x93 = $x1.hero_states;var $x94 = _$1;var $x95 = ({$: "HeroState"});var $x96 = $s_cooldowns$14;$x95.cooldowns = $x96;var $x97 = $li_ming_health$7;$x95.health = $x97;var $new_hero_states$15 = $Map$insert$($x92, $x93, $x94, $x95);var $x0 = ({$: "Pair"});var $x98 = $s$6;$x0.fst = $x98;var $x99 = ({$: "State"});var $x100 = $x1.next_id;$x99.next_id = $x100;var $x101 = $x1.tick;$x99.tick = $x101;var $x102 = $x1.players;$x99.players = $x102;var $x103 = $new_hero_states$15;$x99.hero_states = $x103;var $x104 = $x1.game_map;$x99.game_map = $x104;$x0.snd = $x99;return $x0; }
const $make_skills = _$0 => _$1 => _$2 => $make_skills$(_$0,_$1,_$2)

function $UG$SIPD$Hero$li_ming$(_$0/*:UG/SIPD/State*/,_$1/*:BigInt*/,_$2/*:UG/SIPD/Side*/,_$3/*:V2*/) {var $name$0 = JSTR_TO_LIST(`Li-Ming`);var $collision_radius$1 = 0.625;var $unit_scaling$2 = $UG$SIPD$unit_scaling;var $x1 = _$3;var $x3 = $collision_radius$1;var $x4 = $unit_scaling$2;var $x2 = $F64$mul$($x3, $x4);var $shape$3 = $UG$Shape$circle$($x1, $x2);var $x5 = _$0;var $x6 = ({$: "Body"});var $x7 = _$1;$x6.id = $x7;var $x8 = $shape$3;$x6.hitbox = $x8;var $x10 = $tick;var $x11 = _$1;var $x9 = ($x10)($x11);$x6.tick = $x9;var $x12 = ({$: "Nil"});$x6.effects = $x12;var $x13 = ({$: "TakesEffects"});$x6.collidable = $x13;var $x14 = _$2;$x6.side = $x14;var $state$4 = $UG$SIPD$State$insert_body$($x5, $x6);var $x15 = $state$4;var $x16 = _$1;var $x17 = _$1;var $got$5 = $make_skills$($x15, $x16, $x17);var $x18 = $got$5;var $x0 = ({$: "Pair"});var $x19 = ({$: "Hero"});var $x20 = _$1;$x19.owner_id = $x20;var $x21 = $name$0;$x19.name = $x21;var $x22 = $x18.fst;$x19.skills = $x22;var $x23 = _$1;$x19.body_id = $x23;$x0.fst = $x19;var $x24 = $x18.snd;$x0.snd = $x24;return $x0; }
const $UG$SIPD$Hero$li_ming = _$0 => _$1 => _$2 => _$3 => $UG$SIPD$Hero$li_ming$(_$0,_$1,_$2,_$3)

function $p_hero$(_$0/*:UG/SIPD/State*/,_$1/*:BigInt*/,_$2/*:UG/SIPD/Side*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x4 = ({$: "V2"});var $x5 = 0.0;$x4.x = $x5;var $x6 = 0.0;$x4.y = $x6;var $x0 = $UG$SIPD$Hero$li_ming$($x1, $x2, $x3, $x4);return $x0; }
const $p_hero = _$0 => _$1 => _$2 => $p_hero$(_$0,_$1,_$2)

const $initial_keys$ = (() => {var $x1 = $String;var $x3 = $Bool;var $x4 = $V2;var $x2 = $Pair$($x3, $x4);var $x0 = $OrdTree$empty$($x1, $x2);return $x0; })()
const $initial_keys = $initial_keys$

function $UG$SIPD$Player$init$(_$0/*:BigInt*/,_$1/*:String*/,_$2/*:UG/SIPD/Side*/,_$3/*:UG/SIPD/State*/) {var $x1 = _$3;var $x2 = _$0;var $x3 = _$2;var $got$0 = $p_hero$($x1, $x2, $x3);var $x4 = $got$0;var $x0 = ({$: "Pair"});var $x5 = ({$: "Player"});var $x6 = _$0;$x5.id = $x6;var $x7 = _$1;$x5.name = $x7;var $x8 = $initial_keys;$x5.keys = $x8;var $x9 = ({$: "V2"});var $x10 = 0.0;$x9.x = $x10;var $x11 = 0.0;$x9.y = $x11;$x5.target = $x9;var $x12 = $x4.fst;$x5.hero = $x12;$x0.fst = $x5;var $x13 = $x4.snd;$x0.snd = $x13;return $x0; }
const $UG$SIPD$Player$init = _$0 => _$1 => _$2 => _$3 => $UG$SIPD$Player$init$(_$0,_$1,_$2,_$3)

function $handle_new_player$(_$0/*:BigInt*/,_$1/*:UG/SIPD/Event*/,_$2/*:UG/SIPD/State*/) {var $x1 = _$2;var $x3 = $UG$SIPD$Player;var $x4 = $x1.players;var $x5 = _$0;var $x2 = $Map$get$($x3, $x4, $x5);switch ($x2.$) { case "None": { var $x6 = _$1;var $initial_name$0 = $get_player_name$($x6);var $x7 = _$1;var $initial_side$1 = $get_player_side$($x7);var $x8 = _$0;var $x9 = $initial_name$0;var $x10 = $initial_side$1;var $x11 = ({$: "State"});var $x12 = $x1.next_id;$x11.next_id = $x12;var $x13 = $x1.tick;$x11.tick = $x13;var $x14 = $x1.players;$x11.players = $x14;var $x15 = $x1.hero_states;$x11.hero_states = $x15;var $x16 = $x1.game_map;$x11.game_map = $x16;var $got$2 = $UG$SIPD$Player$init$($x8, $x9, $x10, $x11);var $x17 = $got$2;var $got$3 = $x17.snd;var $x18 = $got$3;var $x19 = $UG$SIPD$Player;var $x20 = $x18.players;var $x21 = _$0;var $x22 = $x17.fst;var $updated_players$4 = $Map$insert$($x19, $x20, $x21, $x22);var $x0 = ({$: "State"});var $x23 = $x18.next_id;$x0.next_id = $x23;var $x24 = $x18.tick;$x0.tick = $x24;var $x25 = $updated_players$4;$x0.players = $x25;var $x26 = $x18.hero_states;$x0.hero_states = $x26;var $x27 = $x18.game_map;$x0.game_map = $x27; break; } case "Some": { var $x28 = $x2.value;var $x0 = ({$: "State"});var $x29 = $x1.next_id;$x0.next_id = $x29;var $x30 = $x1.tick;$x0.tick = $x30;var $x31 = $x1.players;$x0.players = $x31;var $x32 = $x1.hero_states;$x0.hero_states = $x32;var $x33 = $x1.game_map;$x0.game_map = $x33; break; } }return $x0; }
const $handle_new_player = _$0 => _$1 => _$2 => $handle_new_player$(_$0,_$1,_$2)

function $update_player_name$(_$0/*:Maybe<UG/SIPD/Player>*/,_$1/*:String*/,_$2/*:BigInt*/,_$3/*:Map<BigInt, Maybe<UG/SIPD/Player>>*/) {var $x1 = _$0;switch ($x1.$) { case "None": { var $x0 = _$3; break; } case "Some": { var $x2 = $x1.value;var $x3 = $UG$SIPD$Player;var $x4 = _$3;var $x5 = _$2;var $x6 = ({$: "Player"});var $x7 = $x2.id;$x6.id = $x7;var $x8 = _$1;$x6.name = $x8;var $x9 = $x2.keys;$x6.keys = $x9;var $x10 = $x2.target;$x6.target = $x10;var $x11 = $x2.hero;$x6.hero = $x11;var $x0 = $Map$insert$($x3, $x4, $x5, $x6); break; } }return $x0; }
const $update_player_name = _$0 => _$1 => _$2 => _$3 => $update_player_name$(_$0,_$1,_$2,_$3)

function $get_mouse_pos$(_$0/*:Maybe<Pair<Bool><V2>>*/) {var $x1 = _$0;switch ($x1.$) { case "None": { var $x0 = ({$: "V2"});var $x2 = 0.0;$x0.x = $x2;var $x3 = 0.0;$x0.y = $x3; break; } case "Some": { var $x4 = $x1.value;var $x0 = $x4.snd; break; } }return $x0; }
const $get_mouse_pos = _$0 => $get_mouse_pos$(_$0)

function $get_key_value$(_$0/*:String*/,_$1/*:Maybe<UG/SIPD/Player>*/) {var $x1 = _$1;switch ($x1.$) { case "None": { var $x0 = ({$: "None"}); break; } case "Some": { var $x2 = $x1.value;var $x4 = $String;var $x6 = $Bool;var $x7 = $V2;var $x5 = $Pair$($x6, $x7);var $x8 = $String$Ord;var $x9 = $x2.keys;var $x3 = $OrdTree$get$($x4, $x5, $x8, $x9);var $x10 = _$0;var $x0 = ($x3)($x10); break; } }return $x0; }
const $get_key_value = _$0 => _$1 => $get_key_value$(_$0,_$1)

function $update_player_key$(_$0/*:Maybe<UG/SIPD/Player>*/,_$1/*:String*/,_$2/*:Bool*/,_$3/*:BigInt*/,_$4/*:V2*/,_$5/*:Map<BigInt, Maybe<UG/SIPD/Player>>*/) {var $x1 = _$0;switch ($x1.$) { case "None": { var $x0 = _$5; break; } case "Some": { var $x2 = $x1.value;var $x3 = $String;var $x5 = $Bool;var $x6 = $V2;var $x4 = $Pair$($x5, $x6);var $x7 = $String$Ord;var $x8 = $x2.keys;var $x9 = ({$: "Pair"});var $x10 = _$1;$x9.fst = $x10;var $x11 = ({$: "Pair"});var $x12 = _$2;$x11.fst = $x12;var $x13 = _$4;$x11.snd = $x13;$x9.snd = $x11;var $new_keys$0 = $OrdTree$insert$($x3, $x4, $x7, $x8, $x9);var $x14 = $UG$SIPD$Player;var $x15 = _$5;var $x16 = _$3;var $x17 = ({$: "Player"});var $x18 = $x2.id;$x17.id = $x18;var $x19 = $x2.name;$x17.name = $x19;var $x20 = $new_keys$0;$x17.keys = $x20;var $x21 = $x2.target;$x17.target = $x21;var $x22 = $x2.hero;$x17.hero = $x22;var $x0 = $Map$insert$($x14, $x15, $x16, $x17); break; } }return $x0; }
const $update_player_key = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => $update_player_key$(_$0,_$1,_$2,_$3,_$4,_$5)

function $update_player_target$(_$0/*:Maybe<UG/SIPD/Player>*/,_$1/*:Number*/,_$2/*:Number*/,_$3/*:BigInt*/,_$4/*:Map<BigInt, Maybe<UG/SIPD/Player>>*/) {var $x1 = _$0;switch ($x1.$) { case "None": { var $x0 = _$4; break; } case "Some": { var $x2 = $x1.value;var $x3 = $UG$SIPD$Player;var $x4 = _$4;var $x5 = _$3;var $x6 = ({$: "Player"});var $x7 = $x2.id;$x6.id = $x7;var $x8 = $x2.name;$x6.name = $x8;var $x9 = $x2.keys;$x6.keys = $x9;var $x10 = ({$: "V2"});var $x11 = _$1;$x10.x = $x11;var $x12 = _$2;$x10.y = $x12;$x6.target = $x10;var $x13 = $x2.hero;$x6.hero = $x13;var $x0 = $Map$insert$($x3, $x4, $x5, $x6); break; } }return $x0; }
const $update_player_target = _$0 => _$1 => _$2 => _$3 => _$4 => $update_player_target$(_$0,_$1,_$2,_$3,_$4)

function $handle_event$(_$0/*:UG/SIPD/Event*/) {var $x1 = _$0;switch ($x1.$) { case "ActionEvent": { var $x2 = $x1.action;var $x0 = ($__4$0 => {var $x4 = $__4$0;var $x5 = $UG$SIPD$Player;var $x6 = $x4.players;var $x7 = $x2.pid;var $action_player$1 = $Map$get$($x5, $x6, $x7);var $x8 = $action_player$1;var $x9 = $x2.nick;var $x10 = $x2.pid;var $x11 = $x4.players;var $updated_players$2 = $update_player_name$($x8, $x9, $x10, $x11);var $got$3 = $x4.game_map;var $x12 = $got$3;var $x13 = $UG$SIPD$Body;var $x14 = $x12.bodies;var $x15 = $x2.pid;var $action_player_body$4 = $Map$get$($x13, $x14, $x15);var $x16 = $action_player_body$4;switch ($x16.$) { case "None": { var $x3 = ({$: "State"});var $x17 = $x4.next_id;$x3.next_id = $x17;var $x18 = $x4.tick;$x3.tick = $x18;var $x19 = $updated_players$2;$x3.players = $x19;var $x20 = $x4.hero_states;$x3.hero_states = $x20;var $x21 = $x4.game_map;$x3.game_map = $x21; break; } case "Some": { var $got$5 = $x16.value;var $x22 = $got$5;var $x23 = ({$: "State"});var $x24 = $x4.next_id;$x23.next_id = $x24;var $x25 = $x4.tick;$x23.tick = $x25;var $x26 = $updated_players$2;$x23.players = $x26;var $x27 = $x4.hero_states;$x23.hero_states = $x27;var $x28 = $x4.game_map;$x23.game_map = $x28;var $x29 = ({$: "Body"});var $x30 = $x22.id;$x29.id = $x30;var $x31 = $x22.hitbox;$x29.hitbox = $x31;var $x32 = $x22.tick;$x29.tick = $x32;var $x33 = $x22.effects;$x29.effects = $x33;var $x34 = $x22.collidable;$x29.collidable = $x34;var $x35 = $x2.side;$x29.side = $x35;var $x3 = $UG$SIPD$State$update_body$($x23, $x29); break; } }return $x3;}); break; } case "KeyEvent": { var $x0 = ($__4$0 => {var $x37 = $__4$0;var $x38 = $UG$SIPD$Player;var $x39 = $x37.players;var $x40 = $x1.pid;var $action_player$1 = $Map$get$($x38, $x39, $x40);var $x42 = $x1.key;var $x43 = $action_player$1;var $x41 = $get_key_value$($x42, $x43);var $old_value$2 = $get_mouse_pos$($x41);var $x44 = $action_player$1;var $x45 = $x1.key;var $x46 = $x1.pressed;var $x47 = $x1.pid;var $x48 = $old_value$2;var $x49 = $x37.players;var $updated_players$3 = $update_player_key$($x44, $x45, $x46, $x47, $x48, $x49);var $x36 = ({$: "State"});var $x50 = $x37.next_id;$x36.next_id = $x50;var $x51 = $x37.tick;$x36.tick = $x51;var $x52 = $updated_players$3;$x36.players = $x52;var $x53 = $x37.hero_states;$x36.hero_states = $x53;var $x54 = $x37.game_map;$x36.game_map = $x54;return $x36;}); break; } case "KeyMouse": { var $x0 = ($__6$0 => {var $x56 = $__6$0;var $x57 = $UG$SIPD$Player;var $x58 = $x56.players;var $x59 = $x1.pid;var $action_player$1 = $Map$get$($x57, $x58, $x59);var $x60 = $action_player$1;var $x61 = $x1.key;var $x62 = $x1.pressed;var $x63 = $x1.pid;var $x65 = ({$: "V2"});var $x66 = $x1.x;$x65.x = $x66;var $x67 = $x1.y;$x65.y = $x67;var $x64 = $V2$round$($x65);var $x68 = $x56.players;var $updated_players$2 = $update_player_key$($x60, $x61, $x62, $x63, $x64, $x68);var $x55 = ({$: "State"});var $x69 = $x56.next_id;$x55.next_id = $x69;var $x70 = $x56.tick;$x55.tick = $x70;var $x71 = $updated_players$2;$x55.players = $x71;var $x72 = $x56.hero_states;$x55.hero_states = $x72;var $x73 = $x56.game_map;$x55.game_map = $x73;return $x55;}); break; } case "MouseClick": { var $x74 = $x1.click;switch ($x74.$) { case "LeftButton": { var $x0 = ($__4$0 => {var $x76 = $__4$0;var $x77 = $UG$SIPD$Player;var $x78 = $x76.players;var $x79 = $x1.pid;var $action_player$1 = $Map$get$($x77, $x78, $x79);var $x80 = $action_player$1;var $x82 = $x1.x;var $x83 = 0.0;var $x81 = (Math.round($x82 * Math.pow(10, 2)) / Math.pow(10, 2));var $x85 = $x1.y;var $x86 = 0.0;var $x84 = (Math.round($x85 * Math.pow(10, 2)) / Math.pow(10, 2));var $x87 = $x1.pid;var $x88 = $x76.players;var $updated_players$2 = $update_player_target$($x80, $x81, $x84, $x87, $x88);var $x75 = ({$: "State"});var $x89 = $x76.next_id;$x75.next_id = $x89;var $x90 = $x76.tick;$x75.tick = $x90;var $x91 = $updated_players$2;$x75.players = $x91;var $x92 = $x76.hero_states;$x75.hero_states = $x92;var $x93 = $x76.game_map;$x75.game_map = $x93;return $x75;}); break; } case "RightButton": { var $x0 = ($__4$0 => {var $x95 = $__4$0;var $x96 = $UG$SIPD$Player;var $x97 = $x95.players;var $x98 = $x1.pid;var $action_player$1 = $Map$get$($x96, $x97, $x98);var $x99 = $action_player$1;var $x101 = $x1.x;var $x102 = 0.0;var $x100 = (Math.round($x101 * Math.pow(10, 2)) / Math.pow(10, 2));var $x104 = $x1.y;var $x105 = 0.0;var $x103 = (Math.round($x104 * Math.pow(10, 2)) / Math.pow(10, 2));var $x106 = $x1.pid;var $x107 = $x95.players;var $updated_players$2 = $update_player_target$($x99, $x100, $x103, $x106, $x107);var $x94 = ({$: "State"});var $x108 = $x95.next_id;$x94.next_id = $x108;var $x109 = $x95.tick;$x94.tick = $x109;var $x110 = $updated_players$2;$x94.players = $x110;var $x111 = $x95.hero_states;$x94.hero_states = $x111;var $x112 = $x95.game_map;$x94.game_map = $x112;return $x94;}); break; } } break; } case "MouseMove": { var $x0 = ($__4$0 => {var $x114 = $__4$0;var $x113 = ({$: "State"});var $x115 = $x114.next_id;$x113.next_id = $x115;var $x116 = $x114.tick;$x113.tick = $x116;var $x117 = $x114.players;$x113.players = $x117;var $x118 = $x114.hero_states;$x113.hero_states = $x118;var $x119 = $x114.game_map;$x113.game_map = $x119;return $x113;}); break; } }return $x0; }
const $handle_event = _$0 => $handle_event$(_$0)

function $UG$SIPD$Game$when$(_$0/*:UG/SIPD/Event*/,_$1/*:UG/SIPD/State*/) {var $x1 = _$0;var $pid$0 = $UG$SIPD$Event$get_event_pid$($x1);var $x2 = $pid$0;var $x3 = _$0;var $x4 = _$1;var $state$1 = $handle_new_player$($x2, $x3, $x4);var $x6 = _$0;var $x5 = $handle_event$($x6);var $x7 = $state$1;var $state$2 = ($x5)($x7);var $x0 = $state$2;return $x0; }
const $UG$SIPD$Game$when = _$0 => _$1 => $UG$SIPD$Game$when$(_$0,_$1)

function $UG$SIPD$GameMap$b_tick$(_$0/*:UG/SIPD/State*/) {var $x0 = _$0;return $x0; }
const $UG$SIPD$GameMap$b_tick = _$0 => $UG$SIPD$GameMap$b_tick$(_$0)

function $UG$SM$ActionLogs$(_$0/*:Type*/) {var $x2 = _$0;var $x1 = $List$($x2);var $x0 = $BinMap$($x1);return $x0; }
const $UG$SM$ActionLogs = _$0 => $UG$SM$ActionLogs$(_$0)

const $UG$SM$Tick$ = (() => {var $x0 = /*BigInt*/null;return $x0; })()
const $UG$SM$Tick = $UG$SM$Tick$

function $UG$SM$ActionLogs$add_action$(_$0/*:Type*/,_$1/*:UG/SM/ActionLogs<null>*/,_$2/*:UG/SM/Tick*/,_$3/*:null*/) {var $x3 = _$0;var $x2 = $List$($x3);var $x4 = _$1;var $x6 = _$2;var $x5 = $U64$to_bits$($x6);var $x1 = $BinMap$get$($x2, $x4, $x5);switch ($x1.$) { case "None": { var $x8 = _$0;var $x7 = $List$($x8);var $x9 = _$1;var $x11 = _$2;var $x10 = $U64$to_bits$($x11);var $x12 = ({$: "Cons"});var $x13 = _$3;$x12.head = $x13;var $x14 = ({$: "Nil"});$x12.tail = $x14;var $x0 = $BinMap$set$($x7, $x9, $x10, $x12); break; } case "Some": { var $x16 = _$0;var $x15 = $List$($x16);var $x17 = _$1;var $x19 = _$2;var $x18 = $U64$to_bits$($x19);var $x21 = _$0;var $x22 = $x1.value;var $x23 = ({$: "Cons"});var $x24 = _$3;$x23.head = $x24;var $x25 = ({$: "Nil"});$x23.tail = $x25;var $x20 = $List$append$($x21, $x22, $x23);var $x0 = $BinMap$set$($x15, $x17, $x18, $x20); break; } }return $x0; }
const $UG$SM$ActionLogs$add_action = _$0 => _$1 => _$2 => _$3 => $UG$SM$ActionLogs$add_action$(_$0,_$1,_$2,_$3)

function $UG$SM$ActionLogs$get_actions$(_$0/*:Type*/,_$1/*:UG/SM/ActionLogs<null>*/,_$2/*:UG/SM/Tick*/) {var $x1 = _$2;var $key$0 = $U64$to_bits$($x1);var $x4 = _$0;var $x3 = $List$($x4);var $x5 = _$1;var $x6 = $key$0;var $x2 = $BinMap$get$($x3, $x5, $x6);switch ($x2.$) { case "None": { var $x0 = ({$: "Nil"}); break; } case "Some": { var $x0 = $x2.value; break; } }return $x0; }
const $UG$SM$ActionLogs$get_actions = _$0 => _$1 => _$2 => $UG$SM$ActionLogs$get_actions$(_$0,_$1,_$2)

function $UG$SM$Game$init$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Game<null><null>*/) {var $x1 = _$2;var $x0 = $x1.init;return $x0; }
const $UG$SM$Game$init = _$0 => _$1 => _$2 => $UG$SM$Game$init$(_$0,_$1,_$2)

function $UG$SM$Game$tick$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Game<null><null>*/) {var $x1 = _$2;var $x0 = $x1.tick;return $x0; }
const $UG$SM$Game$tick = _$0 => _$1 => _$2 => $UG$SM$Game$tick$(_$0,_$1,_$2)

function $UG$SM$Game$when$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Game<null><null>*/) {var $x1 = _$2;var $x0 = $x1.when;return $x0; }
const $UG$SM$Game$when = _$0 => _$1 => _$2 => $UG$SM$Game$when$(_$0,_$1,_$2)

function $UG$SM$StateLogs$StateNode$(_$0/*:Type*/) {var $x0 = /*{$:'StateNode', tick: UG/SM/Tick, keep: BigInt, life: BigInt, state: _$0, older: Maybe<UG/SM/StateLogs/StateNode<_$0>>}*/null;return $x0; }
const $UG$SM$StateLogs$StateNode = _$0 => $UG$SM$StateLogs$StateNode$(_$0)

function $UG$SM$StateLogs$(_$0/*:Type*/) {var $x2 = _$0;var $x1 = $UG$SM$StateLogs$StateNode$($x2);var $x0 = $Maybe$($x1);return $x0; }
const $UG$SM$StateLogs = _$0 => $UG$SM$StateLogs$(_$0)

function $UG$SM$Mach$(_$0/*:Type*/,_$1/*:Type*/) {var $x0 = /*{$:'Mach', ticks_per_second: BigInt, genesis_tick: UG/SM/Tick, cached_tick: UG/SM/Tick, state_logs: UG/SM/StateLogs<_$0>, action_logs: UG/SM/ActionLogs<_$1>, action_eq: ($_$0:_$1) => ($_$1:_$1) => Bool}*/null;return $x0; }
const $UG$SM$Mach = _$0 => _$1 => $UG$SM$Mach$(_$0,_$1)

function $UG$SM$Mach$action_logs$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/) {var $x1 = _$2;var $x0 = $x1.action_logs;return $x0; }
const $UG$SM$Mach$action_logs = _$0 => _$1 => _$2 => $UG$SM$Mach$action_logs$(_$0,_$1,_$2)

function $UG$SM$Mach$cached_tick$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/) {var $x1 = _$2;var $x0 = $x1.cached_tick;return $x0; }
const $UG$SM$Mach$cached_tick = _$0 => _$1 => _$2 => $UG$SM$Mach$cached_tick$(_$0,_$1,_$2)

function $UG$SM$StateLogs$StateNode$keep$(_$0/*:Type*/,_$1/*:UG/SM/StateLogs/StateNode<null>*/) {var $x1 = _$1;var $x0 = $x1.keep;return $x0; }
const $UG$SM$StateLogs$StateNode$keep = _$0 => _$1 => $UG$SM$StateLogs$StateNode$keep$(_$0,_$1)

function $UG$SM$StateLogs$StateNode$life$(_$0/*:Type*/,_$1/*:UG/SM/StateLogs/StateNode<null>*/) {var $x1 = _$1;var $x0 = $x1.life;return $x0; }
const $UG$SM$StateLogs$StateNode$life = _$0 => _$1 => $UG$SM$StateLogs$StateNode$life$(_$0,_$1)

function $UG$SM$StateLogs$StateNode$older$(_$0/*:Type*/,_$1/*:UG/SM/StateLogs/StateNode<null>*/) {var $x1 = _$1;var $x0 = $x1.older;return $x0; }
const $UG$SM$StateLogs$StateNode$older = _$0 => _$1 => $UG$SM$StateLogs$StateNode$older$(_$0,_$1)

function $UG$SM$StateLogs$StateNode$set_keep$(_$0/*:Type*/,_$1/*:BigInt*/,_$2/*:UG/SM/StateLogs/StateNode<null>*/) {var $x1 = _$2;var $x0 = ({$: "StateNode"});var $x2 = $x1.tick;$x0.tick = $x2;var $x3 = _$1;$x0.keep = $x3;var $x4 = $x1.life;$x0.life = $x4;var $x5 = $x1.state;$x0.state = $x5;var $x6 = $x1.older;$x0.older = $x6;return $x0; }
const $UG$SM$StateLogs$StateNode$set_keep = _$0 => _$1 => _$2 => $UG$SM$StateLogs$StateNode$set_keep$(_$0,_$1,_$2)

function $UG$SM$StateLogs$StateNode$set_life$(_$0/*:Type*/,_$1/*:BigInt*/,_$2/*:UG/SM/StateLogs/StateNode<null>*/) {var $x1 = _$2;var $x0 = ({$: "StateNode"});var $x2 = $x1.tick;$x0.tick = $x2;var $x3 = $x1.keep;$x0.keep = $x3;var $x4 = _$1;$x0.life = $x4;var $x5 = $x1.state;$x0.state = $x5;var $x6 = $x1.older;$x0.older = $x6;return $x0; }
const $UG$SM$StateLogs$StateNode$set_life = _$0 => _$1 => _$2 => $UG$SM$StateLogs$StateNode$set_life$(_$0,_$1,_$2)

function $UG$SM$StateLogs$StateNode$state$(_$0/*:Type*/,_$1/*:UG/SM/StateLogs/StateNode<null>*/) {var $x1 = _$1;var $x0 = $x1.state;return $x0; }
const $UG$SM$StateLogs$StateNode$state = _$0 => _$1 => $UG$SM$StateLogs$StateNode$state$(_$0,_$1)

function $UG$SM$StateLogs$StateNode$tick$(_$0/*:Type*/,_$1/*:UG/SM/StateLogs/StateNode<null>*/) {var $x1 = _$1;var $x0 = $x1.tick;return $x0; }
const $UG$SM$StateLogs$StateNode$tick = _$0 => _$1 => $UG$SM$StateLogs$StateNode$tick$(_$0,_$1)

function $UG$SM$StateLogs$find_rollback_amount$go$(_$0/*:Type*/,_$1/*:UG/SM/Tick*/,_$2/*:UG/SM/StateLogs<null>*/,_$3/*:BigInt*/) {while(1){var $x1 = _$2;switch ($x1.$) { case "None": { var $x0 = _$3; break; } case "Some": { var $x2 = $x1.value;var $x3 = _$1;var $x4 = $x2.tick;var $is_target_greater$0 = $U64$lt$($x3, $x4);var $x5 = $is_target_greater$0;switch ($x5.$) { case "True": { var $x6 = _$0;var $x7 = _$1;var $x8 = $x2.older;var $x10 = 1n;var $x11 = _$3;var $x9 = $U64$add$($x10, $x11);_$0 = $x6;_$1 = $x7;_$2 = $x8;_$3 = $x9;/*TCO*/continue; break; } case "False": { var $x0 = _$3; break; } } break; } }return $x0; }}
const $UG$SM$StateLogs$find_rollback_amount$go = _$0 => _$1 => _$2 => _$3 => $UG$SM$StateLogs$find_rollback_amount$go$(_$0,_$1,_$2,_$3)

function $UG$SM$StateLogs$find_rollback_amount$(_$0/*:Type*/,_$1/*:UG/SM/Tick*/,_$2/*:UG/SM/StateLogs<null>*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x4 = 0n;var $x0 = $UG$SM$StateLogs$find_rollback_amount$go$($x1, $x2, $x3, $x4);return $x0; }
const $UG$SM$StateLogs$find_rollback_amount = _$0 => _$1 => _$2 => $UG$SM$StateLogs$find_rollback_amount$(_$0,_$1,_$2)

function $UG$SM$StateLogs$push$go$life$(_$0/*:Type*/,_$1/*:null*/,_$2/*:UG/SM/StateLogs/StateNode<null>*/,_$3/*:UG/SM/Tick*/,_$4/*:BigInt*/) {var $x1 = _$4;if ($x1 === 0n) { var $x2 = _$0;var $x3 = 0n;var $x4 = _$2;var $updated_node$0 = $UG$SM$StateLogs$StateNode$set_keep$($x2, $x3, $x4);var $x0 = ({$: "Some"});var $x5 = ({$: "StateNode"});var $x6 = _$3;$x5.tick = $x6;var $x7 = 0n;$x5.keep = $x7;var $x9 = _$0;var $x10 = _$2;var $x8 = $UG$SM$StateLogs$StateNode$life$($x9, $x10);$x5.life = $x8;var $x11 = _$1;$x5.state = $x11;var $x12 = ({$: "Some"});var $x13 = $updated_node$0;$x12.value = $x13;$x5.older = $x12;$x0.value = $x5; } else { var $x14 = _$0;var $x15 = 0n;var $x17 = _$0;var $x19 = $x1;var $x20 = 1n;var $x18 = BigInt.asUintN(64, $x19 - $x20);var $x21 = _$2;var $x16 = $UG$SM$StateLogs$StateNode$set_life$($x17, $x18, $x21);var $updated_node$0 = $UG$SM$StateLogs$StateNode$set_keep$($x14, $x15, $x16);var $x0 = ({$: "Some"});var $x22 = ({$: "StateNode"});var $x23 = _$3;$x22.tick = $x23;var $x24 = 0n;$x22.keep = $x24;var $x25 = 0n;$x22.life = $x25;var $x26 = _$1;$x22.state = $x26;var $x27 = ({$: "Some"});var $x28 = $updated_node$0;$x27.value = $x28;$x22.older = $x27;$x0.value = $x22; }return $x0; }
const $UG$SM$StateLogs$push$go$life = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SM$StateLogs$push$go$life$(_$0,_$1,_$2,_$3,_$4)

function $UG$SM$StateLogs$push$go$(_$0/*:Type*/,_$1/*:null*/,_$2/*:UG/SM/StateLogs/StateNode<null>*/,_$3/*:UG/SM/Tick*/,_$4/*:BigInt*/) {var $x1 = _$4;if ($x1 === 0n) { var $x0 = ({$: "Some"});var $x3 = _$0;var $x4 = 1n;var $x5 = _$2;var $x2 = $UG$SM$StateLogs$StateNode$set_keep$($x3, $x4, $x5);$x0.value = $x2; } else { var $x6 = _$0;var $x7 = _$2;var $life$0 = $UG$SM$StateLogs$StateNode$life$($x6, $x7);var $x8 = _$0;var $x9 = _$1;var $x10 = _$2;var $x11 = _$3;var $x12 = $life$0;var $x0 = $UG$SM$StateLogs$push$go$life$($x8, $x9, $x10, $x11, $x12); }return $x0; }
const $UG$SM$StateLogs$push$go = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SM$StateLogs$push$go$(_$0,_$1,_$2,_$3,_$4)

function $UG$SM$StateLogs$push$(_$0/*:Type*/,_$1/*:null*/,_$2/*:UG/SM/StateLogs<null>*/,_$3/*:UG/SM/Tick*/) {var $x1 = _$2;switch ($x1.$) { case "None": { var $x0 = ({$: "Some"});var $x2 = ({$: "StateNode"});var $x3 = _$3;$x2.tick = $x3;var $x4 = 0n;$x2.keep = $x4;var $x5 = 0n;$x2.life = $x5;var $x6 = _$1;$x2.state = $x6;var $x7 = ({$: "None"});$x2.older = $x7;$x0.value = $x2; break; } case "Some": { var $x8 = _$0;var $x9 = $x1.value;var $keep$0 = $UG$SM$StateLogs$StateNode$keep$($x8, $x9);var $x10 = _$0;var $x11 = _$1;var $x12 = $x1.value;var $x13 = _$3;var $x14 = $keep$0;var $x0 = $UG$SM$StateLogs$push$go$($x10, $x11, $x12, $x13, $x14); break; } }return $x0; }
const $UG$SM$StateLogs$push = _$0 => _$1 => _$2 => _$3 => $UG$SM$StateLogs$push$(_$0,_$1,_$2,_$3)

function $UG$SM$StateLogs$rollback$go$(_$0/*:Type*/,_$1/*:BigInt*/,_$2/*:BigInt*/,_$3/*:UG/SM/StateLogs<null>*/,_$4/*:BigInt*/) {while(1){var $x1 = _$2;var $x2 = _$1;var $is_done$0 = $U64$lt$($x1, $x2);var $x5 = $is_done$0;var $x4 = $U64$from_bool$($x5);var $x3 = $U64$to_bool$($x4);switch ($x3.$) { case "True": { var $x0 = ({$: "Pair"});var $x6 = _$3;$x0.fst = $x6;var $x7 = _$4;$x0.snd = $x7; break; } case "False": { var $x8 = _$3;switch ($x8.$) { case "None": { var $x0 = ({$: "Pair"});var $x9 = ({$: "None"});$x0.fst = $x9;var $x10 = _$4;$x0.snd = $x10; break; } case "Some": { var $x11 = _$4;var $x14 = _$0;var $x15 = $x8.value;var $x13 = $UG$SM$StateLogs$StateNode$life$($x14, $x15);var $x16 = 1n;var $x12 = $U64$add$($x13, $x16);var $cut$1 = $U64$add$($x11, $x12);var $x17 = _$0;var $x18 = $x8.value;var $states$2 = $UG$SM$StateLogs$StateNode$older$($x17, $x18);var $x19 = _$0;var $x21 = _$1;var $x22 = 1n;var $x20 = $U64$add$($x21, $x22);var $x23 = _$2;var $x24 = $states$2;var $x25 = $cut$1;_$0 = $x19;_$1 = $x20;_$2 = $x23;_$3 = $x24;_$4 = $x25;/*TCO*/continue; break; } } break; } }return $x0; }}
const $UG$SM$StateLogs$rollback$go = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SM$StateLogs$rollback$go$(_$0,_$1,_$2,_$3,_$4)

function $UG$SM$StateLogs$rollback$(_$0/*:Type*/,_$1/*:BigInt*/,_$2/*:UG/SM/StateLogs<null>*/) {var $x2 = _$1;var $x3 = 0n;var $x1 = $U64$eq$($x2, $x3);switch ($x1.$) { case "True": { var $x0 = _$2; break; } case "False": { var $x4 = _$2;switch ($x4.$) { case "None": { var $x0 = ({$: "None"}); break; } case "Some": { var $x5 = _$0;var $x6 = 0n;var $x7 = _$1;var $x8 = _$2;var $x9 = 0n;var $pair$0 = $UG$SM$StateLogs$rollback$go$($x5, $x6, $x7, $x8, $x9);var $x10 = $pair$0;var $x11 = $x10.fst;switch ($x11.$) { case "None": { var $x0 = ({$: "None"}); break; } case "Some": { var $x12 = _$0;var $x13 = $x11.value;var $tick$1 = $UG$SM$StateLogs$StateNode$tick$($x12, $x13);var $x15 = _$0;var $x16 = $x11.value;var $x14 = $UG$SM$StateLogs$StateNode$life$($x15, $x16);var $x17 = $x10.snd;var $life$2 = $U64$add$($x14, $x17);var $x18 = _$0;var $x19 = $x11.value;var $state$3 = $UG$SM$StateLogs$StateNode$state$($x18, $x19);var $x20 = _$0;var $x21 = $x11.value;var $older$4 = $UG$SM$StateLogs$StateNode$older$($x20, $x21);var $x0 = ({$: "Some"});var $x22 = ({$: "StateNode"});var $x23 = $tick$1;$x22.tick = $x23;var $x24 = 0n;$x22.keep = $x24;var $x25 = $life$2;$x22.life = $x25;var $x26 = $state$3;$x22.state = $x26;var $x27 = $older$4;$x22.older = $x27;$x0.value = $x22; break; } } break; } } break; } }return $x0; }
const $UG$SM$StateLogs$rollback = _$0 => _$1 => _$2 => $UG$SM$StateLogs$rollback$(_$0,_$1,_$2)

const $UG$SM$Time$ = (() => {var $x0 = /*BigInt*/null;return $x0; })()
const $UG$SM$Time = $UG$SM$Time$

function $UG$SM$Time$time_to_tick$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Time*/) {var $x1 = _$2;var $x2 = _$3;var $x3 = $x1.ticks_per_second;var $ticks$0 = $U64$mul$($x2, $x3);var $x4 = $ticks$0;var $x5 = 1000n;var $x0 = $U64$div$($x4, $x5);return $x0; }
const $UG$SM$Time$time_to_tick = _$0 => _$1 => _$2 => _$3 => $UG$SM$Time$time_to_tick$(_$0,_$1,_$2,_$3)

function $UG$SM$TimedAction$(_$0/*:Type*/) {var $x0 = /*{$:'TimedAction', action: _$0, time: UG/SM/Time}*/null;return $x0; }
const $UG$SM$TimedAction = _$0 => $UG$SM$TimedAction$(_$0)

function $UG$SM$TimedAction$time_action$(_$0/*:Type*/,_$1/*:UG/SM/Time*/,_$2/*:null*/) {var $x0 = ({$: "TimedAction"});var $x1 = _$2;$x0.action = $x1;var $x2 = _$1;$x0.time = $x2;return $x0; }
const $UG$SM$TimedAction$time_action = _$0 => _$1 => _$2 => $UG$SM$TimedAction$time_action$(_$0,_$1,_$2)

function $UG$SM$action_in_list$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:null*/,_$4/*:List<null>*/) {while(1){var $x1 = _$2;var $x2 = _$4;switch ($x2.$) { case "Cons": { var $x5 = $x1.action_eq;var $x6 = _$3;var $x4 = ($x5)($x6);var $x7 = $x2.head;var $x3 = ($x4)($x7);switch ($x3.$) { case "True": { var $x0 = ({$: "True"}); break; } case "False": { var $x8 = _$0;var $x9 = _$1;var $x10 = ({$: "Mach"});var $x11 = $x1.ticks_per_second;$x10.ticks_per_second = $x11;var $x12 = $x1.genesis_tick;$x10.genesis_tick = $x12;var $x13 = $x1.cached_tick;$x10.cached_tick = $x13;var $x14 = $x1.state_logs;$x10.state_logs = $x14;var $x15 = $x1.action_logs;$x10.action_logs = $x15;var $x16 = $x1.action_eq;$x10.action_eq = $x16;var $x17 = _$3;var $x18 = $x2.tail;_$0 = $x8;_$1 = $x9;_$2 = $x10;_$3 = $x17;_$4 = $x18;/*TCO*/continue; break; } } break; } case "Nil": { var $x0 = ({$: "False"}); break; } }return $x0; }}
const $UG$SM$action_in_list = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SM$action_in_list$(_$0,_$1,_$2,_$3,_$4)

function $UG$SM$add_action_to_logs$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Tick*/,_$4/*:null*/) {var $x1 = _$2;var $x2 = _$1;var $x3 = $x1.action_logs;var $x4 = _$3;var $x5 = _$4;var $new_logs$0 = $UG$SM$ActionLogs$add_action$($x2, $x3, $x4, $x5);var $x0 = ({$: "Mach"});var $x6 = $x1.ticks_per_second;$x0.ticks_per_second = $x6;var $x7 = $x1.genesis_tick;$x0.genesis_tick = $x7;var $x8 = $x1.cached_tick;$x0.cached_tick = $x8;var $x9 = $x1.state_logs;$x0.state_logs = $x9;var $x10 = $new_logs$0;$x0.action_logs = $x10;var $x11 = $x1.action_eq;$x0.action_eq = $x11;return $x0; }
const $UG$SM$add_action_to_logs = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SM$add_action_to_logs$(_$0,_$1,_$2,_$3,_$4)

function $UG$SM$get_initial_state$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Game<null><null>*/) {var $x1 = _$2;var $x2 = $x1.state_logs;switch ($x2.$) { case "None": { var $x0 = ({$: "Pair"});var $x4 = _$0;var $x5 = _$1;var $x6 = _$3;var $x3 = $UG$SM$Game$init$($x4, $x5, $x6);$x0.fst = $x3;var $x7 = $x1.genesis_tick;$x0.snd = $x7; break; } case "Some": { var $x0 = ({$: "Pair"});var $x9 = _$0;var $x10 = $x2.value;var $x8 = $UG$SM$StateLogs$StateNode$state$($x9, $x10);$x0.fst = $x8;var $x12 = _$0;var $x13 = $x2.value;var $x11 = $UG$SM$StateLogs$StateNode$tick$($x12, $x13);$x0.snd = $x11; break; } }return $x0; }
const $UG$SM$get_initial_state = _$0 => _$1 => _$2 => _$3 => $UG$SM$get_initial_state$(_$0,_$1,_$2,_$3)

function $UG$SM$update_mach$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Tick*/,_$4/*:null*/) {var $x1 = _$2;var $x2 = $x1.cached_tick;var $x3 = _$3;var $new_cached_tick$0 = $U64$max$($x2, $x3);var $x4 = _$0;var $x5 = _$4;var $x6 = $x1.state_logs;var $x7 = _$3;var $new_state_logs$1 = $UG$SM$StateLogs$push$($x4, $x5, $x6, $x7);var $x0 = ({$: "Mach"});var $x8 = $x1.ticks_per_second;$x0.ticks_per_second = $x8;var $x9 = $x1.genesis_tick;$x0.genesis_tick = $x9;var $x10 = $new_cached_tick$0;$x0.cached_tick = $x10;var $x11 = $new_state_logs$1;$x0.state_logs = $x11;var $x12 = $x1.action_logs;$x0.action_logs = $x12;var $x13 = $x1.action_eq;$x0.action_eq = $x13;return $x0; }
const $UG$SM$update_mach = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SM$update_mach$(_$0,_$1,_$2,_$3,_$4)

function $UG$SM$compute$go$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Game<null><null>*/,_$4/*:null*/,_$5/*:UG/SM/Tick*/,_$6/*:UG/SM/Tick*/) {while(1){var $x2 = _$5;var $x3 = _$6;var $x1 = $U64$eq$($x2, $x3);switch ($x1.$) { case "True": { var $x0 = ({$: "Pair"});var $x4 = _$4;$x0.fst = $x4;var $x5 = _$2;$x0.snd = $x5; break; } case "False": { var $x6 = _$5;var $x7 = 1n;var $next_tick$0 = $U64$add$($x6, $x7);var $x8 = _$1;var $x10 = _$0;var $x11 = _$1;var $x12 = _$2;var $x9 = $UG$SM$Mach$action_logs$($x10, $x11, $x12);var $x13 = _$5;var $actions$1 = $UG$SM$ActionLogs$get_actions$($x8, $x9, $x13);var $x14 = _$1;var $x15 = $actions$1;var $x16 = _$0;var $x17 = _$4;var $x19 = _$0;var $x20 = _$1;var $x21 = _$3;var $x18 = $UG$SM$Game$when$($x19, $x20, $x21);var $state_with_actions$2 = $List$foldr$($x14, $x15, $x16, $x17, $x18);var $x23 = _$0;var $x24 = _$1;var $x25 = _$3;var $x22 = $UG$SM$Game$tick$($x23, $x24, $x25);var $x26 = $state_with_actions$2;var $next_state$3 = ($x22)($x26);var $x27 = _$0;var $x28 = _$1;var $x29 = _$2;var $x30 = _$5;var $x31 = _$4;var $updated_mach$4 = $UG$SM$update_mach$($x27, $x28, $x29, $x30, $x31);var $x32 = _$0;var $x33 = _$1;var $x34 = $updated_mach$4;var $x35 = _$3;var $x36 = $next_state$3;var $x37 = $next_tick$0;var $x38 = _$6;_$0 = $x32;_$1 = $x33;_$2 = $x34;_$3 = $x35;_$4 = $x36;_$5 = $x37;_$6 = $x38;/*TCO*/continue; break; } }return $x0; }}
const $UG$SM$compute$go = _$0 => _$1 => _$2 => _$3 => _$4 => _$5 => _$6 => $UG$SM$compute$go$(_$0,_$1,_$2,_$3,_$4,_$5,_$6)

function $UG$SM$compute$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Game<null><null>*/,_$4/*:UG/SM/Time*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x4 = _$4;var $end_t$0 = $UG$SM$Time$time_to_tick$($x1, $x2, $x3, $x4);var $x5 = _$0;var $x6 = _$1;var $x7 = _$2;var $x8 = _$3;var $got$1 = $UG$SM$get_initial_state$($x5, $x6, $x7, $x8);var $x9 = $got$1;var $x10 = $end_t$0;var $x11 = $x9.snd;var $diff$2 = $U64$sub$($x10, $x11);var $x13 = $diff$2;var $x14 = 1000000000000n;var $x12 = $U64$gt$($x13, $x14);switch ($x12.$) { case "True": { var $x0 = ({$: "Pair"});var $x15 = $x9.fst;$x0.fst = $x15;var $x16 = _$2;$x0.snd = $x16; break; } case "False": { var $x17 = _$0;var $x18 = _$1;var $x19 = _$2;var $x20 = _$3;var $x21 = $x9.fst;var $x22 = $x9.snd;var $x23 = $end_t$0;var $x0 = $UG$SM$compute$go$($x17, $x18, $x19, $x20, $x21, $x22, $x23); break; } }return $x0; }
const $UG$SM$compute = _$0 => _$1 => _$2 => _$3 => _$4 => $UG$SM$compute$(_$0,_$1,_$2,_$3,_$4)

function $UG$SM$new_mach$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:BigInt*/,_$3/*:($_$3:null) => ($_$4:null) => Bool*/) {var $x0 = ({$: "Mach"});var $x1 = _$2;$x0.ticks_per_second = $x1;var $x2 = 687399551400673280n;$x0.genesis_tick = $x2;var $x3 = 0n;$x0.cached_tick = $x3;var $x6 = _$0;var $x5 = $UG$SM$StateLogs$StateNode$($x6);var $x4 = $Maybe$none$($x5);$x0.state_logs = $x4;var $x9 = _$1;var $x8 = $List$($x9);var $x7 = $BinMap$new$($x8);$x0.action_logs = $x7;var $x10 = _$3;$x0.action_eq = $x10;return $x0; }
const $UG$SM$new_mach = _$0 => _$1 => _$2 => _$3 => $UG$SM$new_mach$(_$0,_$1,_$2,_$3)

function $UG$SM$update_genesis_tick$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Tick*/) {var $x1 = _$2;var $x2 = _$3;var $x3 = $x1.genesis_tick;var $new_genesis$0 = $U64$min$($x2, $x3);var $x0 = ({$: "Mach"});var $x4 = $x1.ticks_per_second;$x0.ticks_per_second = $x4;var $x5 = $new_genesis$0;$x0.genesis_tick = $x5;var $x6 = $x1.cached_tick;$x0.cached_tick = $x6;var $x7 = $x1.state_logs;$x0.state_logs = $x7;var $x8 = $x1.action_logs;$x0.action_logs = $x8;var $x9 = $x1.action_eq;$x0.action_eq = $x9;return $x0; }
const $UG$SM$update_genesis_tick = _$0 => _$1 => _$2 => _$3 => $UG$SM$update_genesis_tick$(_$0,_$1,_$2,_$3)

function $UG$SM$update_cached_tick$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Tick*/) {var $x1 = _$2;var $x3 = _$3;var $x4 = $x1.cached_tick;var $x2 = $U64$lt$($x3, $x4);switch ($x2.$) { case "True": { var $x0 = ({$: "Mach"});var $x5 = $x1.ticks_per_second;$x0.ticks_per_second = $x5;var $x6 = $x1.genesis_tick;$x0.genesis_tick = $x6;var $x7 = _$3;$x0.cached_tick = $x7;var $x8 = $x1.state_logs;$x0.state_logs = $x8;var $x9 = $x1.action_logs;$x0.action_logs = $x9;var $x10 = $x1.action_eq;$x0.action_eq = $x10; break; } case "False": { var $x0 = ({$: "Mach"});var $x11 = $x1.ticks_per_second;$x0.ticks_per_second = $x11;var $x12 = $x1.genesis_tick;$x0.genesis_tick = $x12;var $x13 = $x1.cached_tick;$x0.cached_tick = $x13;var $x14 = $x1.state_logs;$x0.state_logs = $x14;var $x15 = $x1.action_logs;$x0.action_logs = $x15;var $x16 = $x1.action_eq;$x0.action_eq = $x16; break; } }return $x0; }
const $UG$SM$update_cached_tick = _$0 => _$1 => _$2 => _$3 => $UG$SM$update_cached_tick$(_$0,_$1,_$2,_$3)

function $UG$SM$remove_future_states$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/Tick*/) {var $x1 = _$2;var $x2 = _$0;var $x3 = _$3;var $x4 = $x1.state_logs;var $rollback_amount$0 = $UG$SM$StateLogs$find_rollback_amount$($x2, $x3, $x4);var $x5 = _$0;var $x6 = $rollback_amount$0;var $x7 = $x1.state_logs;var $new_logs$1 = $UG$SM$StateLogs$rollback$($x5, $x6, $x7);var $x0 = ({$: "Mach"});var $x8 = $x1.ticks_per_second;$x0.ticks_per_second = $x8;var $x9 = $x1.genesis_tick;$x0.genesis_tick = $x9;var $x10 = $x1.cached_tick;$x0.cached_tick = $x10;var $x11 = $new_logs$1;$x0.state_logs = $x11;var $x12 = $x1.action_logs;$x0.action_logs = $x12;var $x13 = $x1.action_eq;$x0.action_eq = $x13;return $x0; }
const $UG$SM$remove_future_states = _$0 => _$1 => _$2 => _$3 => $UG$SM$remove_future_states$(_$0,_$1,_$2,_$3)

function $UG$SM$register_action$(_$0/*:Type*/,_$1/*:Type*/,_$2/*:UG/SM/Mach<null><null>*/,_$3/*:UG/SM/TimedAction<null>*/) {var $x1 = _$3;var $x2 = _$0;var $x3 = _$1;var $x4 = _$2;var $x5 = $x1.time;var $tick$0 = $UG$SM$Time$time_to_tick$($x2, $x3, $x4, $x5);var $got$1 = _$2;var $x6 = $got$1;var $x7 = _$1;var $x8 = $x6.action_logs;var $x9 = $tick$0;var $tick_actions$2 = $UG$SM$ActionLogs$get_actions$($x7, $x8, $x9);var $x13 = _$0;var $x14 = _$1;var $x15 = _$2;var $x16 = $x1.action;var $x17 = $tick_actions$2;var $x12 = $UG$SM$action_in_list$($x13, $x14, $x15, $x16, $x17);var $x11 = $Bool$eq$($x12);var $x18 = ({$: "True"});var $x10 = ($x11)($x18);switch ($x10.$) { case "True": { var $x0 = _$2; break; } case "False": { var $x19 = _$0;var $x20 = _$1;var $x21 = _$2;var $x22 = $tick$0;var $mach$3 = $UG$SM$update_genesis_tick$($x19, $x20, $x21, $x22);var $x23 = _$0;var $x24 = _$1;var $x25 = $mach$3;var $x26 = $tick$0;var $mach$4 = $UG$SM$update_cached_tick$($x23, $x24, $x25, $x26);var $x27 = _$0;var $x28 = _$1;var $x29 = $mach$4;var $x30 = $tick$0;var $mach$5 = $UG$SM$remove_future_states$($x27, $x28, $x29, $x30);var $x31 = _$0;var $x32 = _$1;var $x33 = $mach$5;var $x34 = $tick$0;var $x35 = $x1.action;var $x0 = $UG$SM$add_action_to_logs$($x31, $x32, $x33, $x34, $x35); break; } }return $x0; }
const $UG$SM$register_action = _$0 => _$1 => _$2 => _$3 => $UG$SM$register_action$(_$0,_$1,_$2,_$3)

function $UG$Shape$line_circle_intersection$(_$0/*:V2*/,_$1/*:V2*/,_$2/*:V2*/,_$3/*:Number*/) {var $x1 = _$0;var $x2 = _$1;var $x3 = _$2;var $x4 = $x2.x;var $x5 = $x1.x;var $dx$0 = $F64$sub$($x4, $x5);var $x6 = $x2.y;var $x7 = $x1.y;var $dy$1 = $F64$sub$($x6, $x7);var $x11 = $dx$0;var $x12 = $dx$0;var $x10 = $F64$mul$($x11, $x12);var $x14 = $dy$1;var $x15 = $dy$1;var $x13 = $F64$mul$($x14, $x15);var $x8 = $F64$add$($x10, $x13);var $x9 = 0.0;var $a$2 = (Math.round($x8 * Math.pow(10, 2)) / Math.pow(10, 2));var $x18 = 2.0;var $x21 = $dx$0;var $x23 = $x1.x;var $x24 = $x3.x;var $x22 = $F64$sub$($x23, $x24);var $x20 = $F64$mul$($x21, $x22);var $x26 = $dy$1;var $x28 = $x1.y;var $x29 = $x3.y;var $x27 = $F64$sub$($x28, $x29);var $x25 = $F64$mul$($x26, $x27);var $x19 = $F64$add$($x20, $x25);var $x16 = $F64$mul$($x18, $x19);var $x17 = 0.0;var $b$3 = (Math.round($x16 * Math.pow(10, 2)) / Math.pow(10, 2));var $x33 = $x3.x;var $x34 = $x3.x;var $x32 = $F64$mul$($x33, $x34);var $x36 = $x3.y;var $x37 = $x3.y;var $x35 = $F64$mul$($x36, $x37);var $x30 = $F64$add$($x32, $x35);var $x31 = 0.0;var $c1$4 = (Math.round($x30 * Math.pow(10, 2)) / Math.pow(10, 2));var $x41 = $x1.x;var $x42 = $x1.x;var $x40 = $F64$mul$($x41, $x42);var $x44 = $x1.y;var $x45 = $x1.y;var $x43 = $F64$mul$($x44, $x45);var $x38 = $F64$add$($x40, $x43);var $x39 = 0.0;var $c2$5 = (Math.round($x38 * Math.pow(10, 2)) / Math.pow(10, 2));var $x48 = 2.0;var $x51 = $x3.x;var $x52 = $x1.x;var $x50 = $F64$mul$($x51, $x52);var $x54 = $x3.y;var $x55 = $x1.y;var $x53 = $F64$mul$($x54, $x55);var $x49 = $F64$add$($x50, $x53);var $x46 = $F64$mul$($x48, $x49);var $x47 = 0.0;var $c3$6 = (Math.round($x46 * Math.pow(10, 2)) / Math.pow(10, 2));var $x58 = _$3;var $x59 = _$3;var $x56 = $F64$mul$($x58, $x59);var $x57 = 0.0;var $c4$7 = (Math.round($x56 * Math.pow(10, 2)) / Math.pow(10, 2));var $x63 = $c1$4;var $x64 = $c2$5;var $x62 = $F64$add$($x63, $x64);var $x66 = $c3$6;var $x67 = $c4$7;var $x65 = $F64$add$($x66, $x67);var $x60 = $F64$sub$($x62, $x65);var $x61 = 0.0;var $c$8 = (Math.round($x60 * Math.pow(10, 2)) / Math.pow(10, 2));var $x71 = $b$3;var $x72 = $b$3;var $x70 = $F64$mul$($x71, $x72);var $x75 = 4.0;var $x76 = $a$2;var $x74 = $F64$mul$($x75, $x76);var $x77 = $c$8;var $x73 = $F64$mul$($x74, $x77);var $x68 = $F64$sub$($x70, $x73);var $x69 = 0.0;var $disc$9 = (Math.round($x68 * Math.pow(10, 2)) / Math.pow(10, 2));var $x79 = $disc$9;var $x80 = 0.0;var $x78 = $F64$lt$($x79, $x80);switch ($x78.$) { case "True": { var $x0 = ({$: "False"}); break; } case "False": { var $x85 = $b$3;var $x84 = $F64$negate$($x85);var $x87 = $disc$9;var $x86 = $F64$sqrt$($x87);var $x83 = $F64$add$($x84, $x86);var $x89 = 2.0;var $x90 = $a$2;var $x88 = $F64$mul$($x89, $x90);var $x81 = $F64$div$($x83, $x88);var $x82 = 0.0;var $t1$10 = (Math.round($x81 * Math.pow(10, 2)) / Math.pow(10, 2));var $x95 = $b$3;var $x94 = $F64$negate$($x95);var $x97 = $disc$9;var $x96 = $F64$sqrt$($x97);var $x93 = $F64$sub$($x94, $x96);var $x99 = 2.0;var $x100 = $a$2;var $x98 = $F64$mul$($x99, $x100);var $x91 = $F64$div$($x93, $x98);var $x92 = 0.0;var $t2$11 = (Math.round($x91 * Math.pow(10, 2)) / Math.pow(10, 2));var $x102 = $t1$10;var $x103 = 0.0;var $x101 = $F64$gte$($x102, $x103);var $x105 = $t1$10;var $x106 = 1.0;var $x104 = $F64$lte$($x105, $x106);var $valid1$12 = $Bool$and$($x101, $x104);var $x108 = $t2$11;var $x109 = 0.0;var $x107 = $F64$gte$($x108, $x109);var $x111 = $t2$11;var $x112 = 1.0;var $x110 = $F64$lte$($x111, $x112);var $valid2$13 = $Bool$and$($x107, $x110);var $x113 = $valid1$12;var $x114 = $valid2$13;var $x0 = $Bool$or$($x113, $x114); break; } }return $x0; }
const $UG$Shape$line_circle_intersection = _$0 => _$1 => _$2 => _$3 => $UG$Shape$line_circle_intersection$(_$0,_$1,_$2,_$3)

function $UG$Shape$check_edges$(_$0/*:V2*/,_$1/*:Number*/,_$2/*:List<V2>*/,_$3/*:List<V2>*/) {while(1){var $x1 = _$2;switch ($x1.$) { case "Cons": { var $x2 = $x1.tail;switch ($x2.$) { case "Cons": { var $x4 = $x1.head;var $x5 = $x2.head;var $x6 = _$0;var $x7 = _$1;var $x3 = $UG$Shape$line_circle_intersection$($x4, $x5, $x6, $x7);switch ($x3.$) { case "True": { var $x0 = ({$: "True"}); break; } case "False": { var $x8 = _$0;var $x9 = _$1;var $x10 = ({$: "Cons"});var $x11 = $x2.head;$x10.head = $x11;var $x12 = $x2.tail;$x10.tail = $x12;var $x13 = _$3;_$0 = $x8;_$1 = $x9;_$2 = $x10;_$3 = $x13;/*TCO*/continue; break; } } break; } case "Nil": { var $x0 = ({$: "False"}); break; } } break; } case "Nil": { var $x0 = ({$: "False"}); break; } }return $x0; }}
const $UG$Shape$check_edges = _$0 => _$1 => _$2 => _$3 => $UG$Shape$check_edges$(_$0,_$1,_$2,_$3)

const $export_action_eq$ = (() => {var $x0 = $UG$SIPD$Event$eq;return $x0; })()
const $export_action_eq = $export_action_eq$

const $export_compute$ = (() => {var $x0 = $UG$SM$compute;return $x0; })()
const $export_compute = $export_compute$

const $export_game$ = (() => {var $x0 = ({$: "Game"});var $x1 = $UG$SIPD$Game$init;$x0.init = $x1;var $x2 = $UG$SIPD$Game$when;$x0.when = $x2;var $x3 = $UG$SIPD$Game$tick;$x0.tick = $x3;return $x0; })()
const $export_game = $export_game$

const $export_game_init$ = (() => {var $x0 = $UG$SIPD$Game$init;return $x0; })()
const $export_game_init = $export_game_init$

const $export_game_tick$ = (() => {var $x0 = $UG$SIPD$Game$tick;return $x0; })()
const $export_game_tick = $export_game_tick$

const $export_game_when$ = (() => {var $x0 = $UG$SIPD$Game$when;return $x0; })()
const $export_game_when = $export_game_when$

const $export_map_insert$ = (() => {var $x0 = $Map$insert;return $x0; })()
const $export_map_insert = $export_map_insert$

const $export_new_mach$ = (() => {var $x0 = $UG$SM$new_mach;return $x0; })()
const $export_new_mach = $export_new_mach$

const $export_register_action$ = (() => {var $x0 = $UG$SM$register_action;return $x0; })()
const $export_register_action = $export_register_action$

const $export_time_action$ = (() => {var $x0 = $UG$SM$TimedAction$time_action;return $x0; })()
const $export_time_action = $export_time_action$

const $export_time_to_tick$ = (() => {var $x0 = $UG$SM$Time$time_to_tick;return $x0; })()
const $export_time_to_tick = $export_time_to_tick$

const $test$0$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$0 = $test$0$

const $test$1$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$1 = $test$1$

const $test$10$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$10 = $test$10$

const $test$2$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$2 = $test$2$

const $test$3$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$3 = $test$3$

const $test$4$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$4 = $test$4$

const $test$5$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$5 = $test$5$

const $test$6$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$6 = $test$6$

const $test$7$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$7 = $test$7$

const $test$8$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$8 = $test$8$

const $test$9$ = (() => {var $x0 = ({$: "Refl"});return $x0; })()
const $test$9 = $test$9$


export { $BinTree, $Maybe, $BinMap, $BinMap$empty, $Bits, $BinMap$get, $BinMap$new, $BinMap$set, $Bool, $Bool$and, $Bool$eq, $Bool$if, $Bool$not, $Bool$or, $Char, $U64$to_bool, $U64$eql, $Cmp, $U64$compare, $Char$compare, $Ord, $Char$Ord, $Char$eq, $Equal, $F64$negate, $F64$lt, $F64$abs, $F64$add, $F64$div, $F64$eql, $F64$eq, $F64$gt, $F64$gte, $F64$is_zero, $F64$lte, $F64$min, $F64$mul, $F64$sign, $F64$sqrt_go, $F64$sqrt, $F64$sub, $KEYEVENT, $KEYMOUSE, $List, $List$append, $List$foldr, $List$fold, $List$foldl, $List$head, $List$insert_at_sorted, $List$insertion_sort, $List$map, $List$sort, $Pair, $List$zip, $MOUSECLICK, $MOUSEMOVE, $Map$delete, $Map$empty, $U64$eq, $Map$fold$go, $Map$fold, $Map$fold$test_map, $Map$get, $Map$get$test_map, $Map$insert, $Map$insert$test_map, $Map$update, $Map$values$go, $Map$values, $Map$values$test_map, $Maybe$none, $Nat, $Nat$add, $Nat$eq, $Nat$lte, $Nat$gte, $Nat$max, $Ord$compare, $OrdTree$Balance, $OrdTree, $OrdTree$Balance$rotate_left, $OrdTree$Balance$rotate_right, $OrdTree$empty, $OrdTree$fold, $OrdTree$get, $OrdTree$height, $Pair$get_fst, $OrdTree$insert$go, $OrdTree$insert, $OrdTree$keys, $OrdTree$singleton, $OrdTree$size, $SETNICK, $String, $String$compare, $String$Ord, $String$eq, $TPS, $U64$Ord, $U64$add, $U64$div, $U64$from_bool, $U64$gt, $U64$gte, $U64$lt, $U64$lte, $U64$max, $U64$min, $U64$mod, $U64$mul, $U64$neq, $U64$sub, $U64$to_bits, $UG$Collision$Collidable, $V2, $V2$round, $V2$div_scalar, $V2$length, $V2$is_zero, $V2$normalize, $V2$sub, $UG$Shape$segments, $V2$dot, $V2$point_to_segment_distance, $UG$Shape$closest_point_on_polygon$go, $UG$Shape$closest_point_on_polygon, $UG$Shape$abs_vertices$go, $UG$Shape, $UG$Shape$abs_vertices, $V2$new, $closest_point_polygon_polygon, $UG$Collision$calculate_collision_normal, $UG$Shape$get_center, $V2$add, $UG$Shape$move, $V2$sqr_dist, $V2$dist, $V2$x, $V2$y, $is_right_side, $process_edge, $point_in_polygon$go, $UG$Shape$point_in_polygon, $UG$Shape$any_vertex_inside, $UG$Shape$line_line_intersection, $UG$Shape$check_against_all, $UG$Shape$any_edges_intersect, $UG$Shape$collide, $UG$SIPD$Side, $UG$SIPD$Effect, $UG$SIPD$Skill, $UG$SIPD$Hero, $UG$SIPD$Player, $UG$SIPD$Hero$HeroState, $UG$SIPD$GameMap, $UG$SIPD$State, $UG$SIPD$Body, $UG$SIPD$Body$find_collision$go, $UG$SIPD$Body$find_collision, $V2$mul_scalar, $collide_and_slide$handle_collidable, $collide_and_slide$handle_collisions, $collide_and_slide$go, $UG$Collision$collide_and_slide, $UG$SIPD$Action, $UG$SIPD$Side$eq, $UG$SIPD$Action$eq, $UG$SIPD$Body$set_effects, $UG$SIPD$Effect$apply, $UG$SIPD$Body$apply_effects$go, $UG$SIPD$Body$apply_effects, $UG$SIPD$Body$delete_body, $UG$SIPD$Body$get_body, $UG$SIPD$Body$tick, $UG$SIPD$GameMap$delete_body, $UG$SIPD$State$delete_body, $UG$SIPD$GameMap$update_body, $UG$SIPD$State$update_body, $UG$SIPD$Effect$accelerated_move_range, $damage$handle_collidable, $UG$SIPD$Effect$collide_and_damage$go, $UG$SIPD$GameMap$get_body, $UG$SIPD$Effect$collide_and_damage, $dps$handle_collidable, $UG$SIPD$Effect$collide_and_dps$go, $UG$SIPD$Effect$collide_and_dps, $UG$SIPD$Player$get_mouse_pos, $UG$SIPD$State$generate_id, $UG$Shape$start_centered_rectangle, $V2$calculate_angle, $UG$Shape$get_rotation, $calculate_angle_diff, $V2$rotate, $UG$Shape$rotate, $UG$SIPD$GameMap$insert_body, $UG$SIPD$State$insert_body, $UG$SIPD$Effect$tick_disintegrate_line, $disintegrate$create_disintegrate_line, $UG$SIPD$Effect$spawn_body, $UG$SIPD$Effect$with_duration, $UG$SIPD$Hero$HeroState$update_cooldown, $disintegrate$block_player_movement, $UG$SIPD$Effect$disintegrate, $V2$mul, $knockback$handle_collidable, $UG$SIPD$Effect$knockback$go, $UG$SIPD$Effect$knockback, $V2$perpendicular, $magic_missiles$calculate_targets, $UG$Shape$circle, $magic_missiles$tick_projectile, $magic_missiles$create_projectile, $magic_missiles$go, $UG$SIPD$Effect$magic_missiles, $UG$SIPD$Effect$move, $UG$SIPD$Effect$move_range, $grow_projectile, $tick_projectile, $shoot$go, $UG$SIPD$Effect$shoot, $UG$SIPD$Effect$teleport, $tick_wave, $create_wave_body, $UG$SIPD$Effect$wave_of_force, $UG$SIPD$Event$Click, $UG$SIPD$Event, $UG$SIPD$Event$Click$eq, $UG$SIPD$Event$eq, $UG$SIPD$Event$get_event_pid, $UG$SM$Game, $UG$SIPD$Game, $UG$SIPD$GameMap$initial_map, $UG$SIPD$GameMap$init, $UG$SIPD$Game$init, $update_cooldown, $decrement_cooldowns, $update_hero_state, $update_cooldowns, $UG$SIPD$Game$tick, $get_player_name, $get_player_side, $UG$SIPD$unit_scaling, $get_body_effects_state, $UG$SIPD$Hero$HeroState$key_on_cooldown, $UG$SIPD$Skill$apply, $revert_cooldown, $get_skill, $UG$SIPD$Player$is_player_key_pressed, $UG$SIPD$Hero$apply_skill_if_pressed, $UG$SIPD$Hero$apply_pressed_skills, $apply_skill_if_not_on_cooldown, $tick, $insert_skill, $UG$SIPD$Skill$move, $UG$SIPD$Skill$teleport, $UG$SIPD$range_unit, $time_to_tick, $UG$SIPD$Skill$wave_of_force, $UG$SIPD$Skill$shoot, $UG$SIPD$Skill$magic_missiles, $UG$SIPD$Skill$disintegrate, $insert_cooldown, $make_skills, $UG$SIPD$Hero$li_ming, $p_hero, $initial_keys, $UG$SIPD$Player$init, $handle_new_player, $update_player_name, $get_mouse_pos, $get_key_value, $update_player_key, $update_player_target, $handle_event, $UG$SIPD$Game$when, $UG$SIPD$GameMap$b_tick, $UG$SM$ActionLogs, $UG$SM$Tick, $UG$SM$ActionLogs$add_action, $UG$SM$ActionLogs$get_actions, $UG$SM$Game$init, $UG$SM$Game$tick, $UG$SM$Game$when, $UG$SM$StateLogs$StateNode, $UG$SM$StateLogs, $UG$SM$Mach, $UG$SM$Mach$action_logs, $UG$SM$Mach$cached_tick, $UG$SM$StateLogs$StateNode$keep, $UG$SM$StateLogs$StateNode$life, $UG$SM$StateLogs$StateNode$older, $UG$SM$StateLogs$StateNode$set_keep, $UG$SM$StateLogs$StateNode$set_life, $UG$SM$StateLogs$StateNode$state, $UG$SM$StateLogs$StateNode$tick, $UG$SM$StateLogs$find_rollback_amount$go, $UG$SM$StateLogs$find_rollback_amount, $UG$SM$StateLogs$push$go$life, $UG$SM$StateLogs$push$go, $UG$SM$StateLogs$push, $UG$SM$StateLogs$rollback$go, $UG$SM$StateLogs$rollback, $UG$SM$Time, $UG$SM$Time$time_to_tick, $UG$SM$TimedAction, $UG$SM$TimedAction$time_action, $UG$SM$action_in_list, $UG$SM$add_action_to_logs, $UG$SM$get_initial_state, $UG$SM$update_mach, $UG$SM$compute$go, $UG$SM$compute, $UG$SM$new_mach, $UG$SM$update_genesis_tick, $UG$SM$update_cached_tick, $UG$SM$remove_future_states, $UG$SM$register_action, $UG$Shape$line_circle_intersection, $UG$Shape$check_edges, $export_action_eq, $export_compute, $export_game, $export_game_init, $export_game_tick, $export_game_when, $export_map_insert, $export_new_mach, $export_register_action, $export_time_action, $export_time_to_tick, $test$0, $test$1, $test$10, $test$2, $test$3, $test$4, $test$5, $test$6, $test$7, $test$8, $test$9 }
